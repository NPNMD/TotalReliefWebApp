function EM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function SM(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ik={exports:{}},pf={},Ck={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nu=Symbol.for("react.element"),TM=Symbol.for("react.portal"),IM=Symbol.for("react.fragment"),CM=Symbol.for("react.strict_mode"),kM=Symbol.for("react.profiler"),bM=Symbol.for("react.provider"),AM=Symbol.for("react.context"),PM=Symbol.for("react.forward_ref"),RM=Symbol.for("react.suspense"),NM=Symbol.for("react.memo"),xM=Symbol.for("react.lazy"),zE=Symbol.iterator;function MM(t){return t===null||typeof t!="object"?null:(t=zE&&t[zE]||t["@@iterator"],typeof t=="function"?t:null)}var kk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bk=Object.assign,Ak={};function Wa(t,e,n){this.props=t,this.context=e,this.refs=Ak,this.updater=n||kk}Wa.prototype.isReactComponent={};Wa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Pk(){}Pk.prototype=Wa.prototype;function f_(t,e,n){this.props=t,this.context=e,this.refs=Ak,this.updater=n||kk}var p_=f_.prototype=new Pk;p_.constructor=f_;bk(p_,Wa.prototype);p_.isPureReactComponent=!0;var WE=Array.isArray,Rk=Object.prototype.hasOwnProperty,m_={current:null},Nk={key:!0,ref:!0,__self:!0,__source:!0};function xk(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Rk.call(e,r)&&!Nk.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:nu,type:t,key:s,ref:o,props:i,_owner:m_.current}}function OM(t,e){return{$$typeof:nu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function g_(t){return typeof t=="object"&&t!==null&&t.$$typeof===nu}function DM(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var qE=/\/+/g;function $p(t,e){return typeof t=="object"&&t!==null&&t.key!=null?DM(""+t.key):e.toString(36)}function Id(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case nu:case TM:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+$p(o,0):r,WE(i)?(n="",t!=null&&(n=t.replace(qE,"$&/")+"/"),Id(i,e,n,"",function(u){return u})):i!=null&&(g_(i)&&(i=OM(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(qE,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",WE(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+$p(s,a);o+=Id(s,e,n,l,i)}else if(l=MM(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+$p(s,a++),o+=Id(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Fu(t,e,n){if(t==null)return t;var r=[],i=0;return Id(t,r,"","",function(s){return e.call(n,s,i++)}),r}function LM(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var nn={current:null},Cd={transition:null},VM={ReactCurrentDispatcher:nn,ReactCurrentBatchConfig:Cd,ReactCurrentOwner:m_};function Mk(){throw Error("act(...) is not supported in production builds of React.")}_e.Children={map:Fu,forEach:function(t,e,n){Fu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Fu(t,function(){e++}),e},toArray:function(t){return Fu(t,function(e){return e})||[]},only:function(t){if(!g_(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};_e.Component=Wa;_e.Fragment=IM;_e.Profiler=kM;_e.PureComponent=f_;_e.StrictMode=CM;_e.Suspense=RM;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VM;_e.act=Mk;_e.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=bk({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=m_.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Rk.call(e,l)&&!Nk.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:nu,type:t.type,key:i,ref:s,props:r,_owner:o}};_e.createContext=function(t){return t={$$typeof:AM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:bM,_context:t},t.Consumer=t};_e.createElement=xk;_e.createFactory=function(t){var e=xk.bind(null,t);return e.type=t,e};_e.createRef=function(){return{current:null}};_e.forwardRef=function(t){return{$$typeof:PM,render:t}};_e.isValidElement=g_;_e.lazy=function(t){return{$$typeof:xM,_payload:{_status:-1,_result:t},_init:LM}};_e.memo=function(t,e){return{$$typeof:NM,type:t,compare:e===void 0?null:e}};_e.startTransition=function(t){var e=Cd.transition;Cd.transition={};try{t()}finally{Cd.transition=e}};_e.unstable_act=Mk;_e.useCallback=function(t,e){return nn.current.useCallback(t,e)};_e.useContext=function(t){return nn.current.useContext(t)};_e.useDebugValue=function(){};_e.useDeferredValue=function(t){return nn.current.useDeferredValue(t)};_e.useEffect=function(t,e){return nn.current.useEffect(t,e)};_e.useId=function(){return nn.current.useId()};_e.useImperativeHandle=function(t,e,n){return nn.current.useImperativeHandle(t,e,n)};_e.useInsertionEffect=function(t,e){return nn.current.useInsertionEffect(t,e)};_e.useLayoutEffect=function(t,e){return nn.current.useLayoutEffect(t,e)};_e.useMemo=function(t,e){return nn.current.useMemo(t,e)};_e.useReducer=function(t,e,n){return nn.current.useReducer(t,e,n)};_e.useRef=function(t){return nn.current.useRef(t)};_e.useState=function(t){return nn.current.useState(t)};_e.useSyncExternalStore=function(t,e,n){return nn.current.useSyncExternalStore(t,e,n)};_e.useTransition=function(){return nn.current.useTransition()};_e.version="18.3.1";Ck.exports=_e;var q=Ck.exports;const Ok=SM(q),FM=EM({__proto__:null,default:Ok},[q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jM=q,UM=Symbol.for("react.element"),$M=Symbol.for("react.fragment"),BM=Object.prototype.hasOwnProperty,zM=jM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WM={key:!0,ref:!0,__self:!0,__source:!0};function Dk(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)BM.call(e,r)&&!WM.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:UM,type:t,key:s,ref:o,props:i,_owner:zM.current}}pf.Fragment=$M;pf.jsx=Dk;pf.jsxs=Dk;Ik.exports=pf;var D=Ik.exports,ng={},Lk={exports:{}},An={},Vk={exports:{}},Fk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(X,se){var he=X.length;X.push(se);e:for(;0<he;){var Oe=he-1>>>1,Ke=X[Oe];if(0<i(Ke,se))X[Oe]=se,X[he]=Ke,he=Oe;else break e}}function n(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var se=X[0],he=X.pop();if(he!==se){X[0]=he;e:for(var Oe=0,Ke=X.length,h=Ke>>>1;Oe<h;){var _=2*(Oe+1)-1,y=X[_],P=_+1,M=X[P];if(0>i(y,he))P<Ke&&0>i(M,y)?(X[Oe]=M,X[P]=he,Oe=P):(X[Oe]=y,X[_]=he,Oe=_);else if(P<Ke&&0>i(M,he))X[Oe]=M,X[P]=he,Oe=P;else break e}}return se}function i(X,se){var he=X.sortIndex-se.sortIndex;return he!==0?he:X.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,m=3,w=!1,E=!1,v=!1,b=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(X){for(var se=n(u);se!==null;){if(se.callback===null)r(u);else if(se.startTime<=X)r(u),se.sortIndex=se.expirationTime,e(l,se);else break;se=n(u)}}function L(X){if(v=!1,k(X),!E)if(n(l)!==null)E=!0,hi(U);else{var se=n(u);se!==null&&fi(L,se.startTime-X)}}function U(X,se){E=!1,v&&(v=!1,S(C),C=-1),w=!0;var he=m;try{for(k(se),f=n(l);f!==null&&(!(f.expirationTime>se)||X&&!O());){var Oe=f.callback;if(typeof Oe=="function"){f.callback=null,m=f.priorityLevel;var Ke=Oe(f.expirationTime<=se);se=t.unstable_now(),typeof Ke=="function"?f.callback=Ke:f===n(l)&&r(l),k(se)}else r(l);f=n(l)}if(f!==null)var h=!0;else{var _=n(u);_!==null&&fi(L,_.startTime-se),h=!1}return h}finally{f=null,m=he,w=!1}}var z=!1,A=null,C=-1,R=5,x=-1;function O(){return!(t.unstable_now()-x<R)}function V(){if(A!==null){var X=t.unstable_now();x=X;var se=!0;try{se=A(!0,X)}finally{se?N():(z=!1,A=null)}}else z=!1}var N;if(typeof T=="function")N=function(){T(V)};else if(typeof MessageChannel<"u"){var ut=new MessageChannel,xn=ut.port2;ut.port1.onmessage=V,N=function(){xn.postMessage(null)}}else N=function(){b(V,0)};function hi(X){A=X,z||(z=!0,N())}function fi(X,se){C=b(function(){X(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){E||w||(E=!0,hi(U))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(X){switch(m){case 1:case 2:case 3:var se=3;break;default:se=m}var he=m;m=se;try{return X()}finally{m=he}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,se){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var he=m;m=X;try{return se()}finally{m=he}},t.unstable_scheduleCallback=function(X,se,he){var Oe=t.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Oe+he:Oe):he=Oe,X){case 1:var Ke=-1;break;case 2:Ke=250;break;case 5:Ke=1073741823;break;case 4:Ke=1e4;break;default:Ke=5e3}return Ke=he+Ke,X={id:d++,callback:se,priorityLevel:X,startTime:he,expirationTime:Ke,sortIndex:-1},he>Oe?(X.sortIndex=he,e(u,X),n(l)===null&&X===n(u)&&(v?(S(C),C=-1):v=!0,fi(L,he-Oe))):(X.sortIndex=Ke,e(l,X),E||w||(E=!0,hi(U))),X},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(X){var se=m;return function(){var he=m;m=se;try{return X.apply(this,arguments)}finally{m=he}}}})(Fk);Vk.exports=Fk;var qM=Vk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HM=q,bn=qM;function Q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jk=new Set,vc={};function wo(t,e){Ea(t,e),Ea(t+"Capture",e)}function Ea(t,e){for(vc[t]=e,t=0;t<e.length;t++)jk.add(e[t])}var ei=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rg=Object.prototype.hasOwnProperty,GM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,HE={},GE={};function KM(t){return rg.call(GE,t)?!0:rg.call(HE,t)?!1:GM.test(t)?GE[t]=!0:(HE[t]=!0,!1)}function QM(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function JM(t,e,n,r){if(e===null||typeof e>"u"||QM(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function rn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Dt[t]=new rn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Dt[e]=new rn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Dt[t]=new rn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Dt[t]=new rn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Dt[t]=new rn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Dt[t]=new rn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Dt[t]=new rn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Dt[t]=new rn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Dt[t]=new rn(t,5,!1,t.toLowerCase(),null,!1,!1)});var y_=/[\-:]([a-z])/g;function __(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(y_,__);Dt[e]=new rn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(y_,__);Dt[e]=new rn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(y_,__);Dt[e]=new rn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Dt[t]=new rn(t,1,!1,t.toLowerCase(),null,!1,!1)});Dt.xlinkHref=new rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Dt[t]=new rn(t,1,!1,t.toLowerCase(),null,!0,!0)});function v_(t,e,n,r){var i=Dt.hasOwnProperty(e)?Dt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(JM(e,n,i,r)&&(n=null),r||i===null?KM(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var di=HM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ju=Symbol.for("react.element"),Wo=Symbol.for("react.portal"),qo=Symbol.for("react.fragment"),w_=Symbol.for("react.strict_mode"),ig=Symbol.for("react.profiler"),Uk=Symbol.for("react.provider"),$k=Symbol.for("react.context"),E_=Symbol.for("react.forward_ref"),sg=Symbol.for("react.suspense"),og=Symbol.for("react.suspense_list"),S_=Symbol.for("react.memo"),ki=Symbol.for("react.lazy"),Bk=Symbol.for("react.offscreen"),KE=Symbol.iterator;function Tl(t){return t===null||typeof t!="object"?null:(t=KE&&t[KE]||t["@@iterator"],typeof t=="function"?t:null)}var Ze=Object.assign,Bp;function Vl(t){if(Bp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Bp=e&&e[1]||""}return`
`+Bp+t}var zp=!1;function Wp(t,e){if(!t||zp)return"";zp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{zp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Vl(t):""}function YM(t){switch(t.tag){case 5:return Vl(t.type);case 16:return Vl("Lazy");case 13:return Vl("Suspense");case 19:return Vl("SuspenseList");case 0:case 2:case 15:return t=Wp(t.type,!1),t;case 11:return t=Wp(t.type.render,!1),t;case 1:return t=Wp(t.type,!0),t;default:return""}}function ag(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qo:return"Fragment";case Wo:return"Portal";case ig:return"Profiler";case w_:return"StrictMode";case sg:return"Suspense";case og:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case $k:return(t.displayName||"Context")+".Consumer";case Uk:return(t._context.displayName||"Context")+".Provider";case E_:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case S_:return e=t.displayName||null,e!==null?e:ag(t.type)||"Memo";case ki:e=t._payload,t=t._init;try{return ag(t(e))}catch{}}return null}function XM(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ag(e);case 8:return e===w_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ts(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function zk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ZM(t){var e=zk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Uu(t){t._valueTracker||(t._valueTracker=ZM(t))}function Wk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=zk(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Xd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function lg(t,e){var n=e.checked;return Ze({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function QE(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ts(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qk(t,e){e=e.checked,e!=null&&v_(t,"checked",e,!1)}function cg(t,e){qk(t,e);var n=ts(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ug(t,e.type,n):e.hasOwnProperty("defaultValue")&&ug(t,e.type,ts(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function JE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ug(t,e,n){(e!=="number"||Xd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fl=Array.isArray;function sa(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ts(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function dg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Q(91));return Ze({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function YE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Q(92));if(Fl(n)){if(1<n.length)throw Error(Q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ts(n)}}function Hk(t,e){var n=ts(e.value),r=ts(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function XE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Gk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Gk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var $u,Kk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for($u=$u||document.createElement("div"),$u.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$u.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function wc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Yl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eO=["Webkit","ms","Moz","O"];Object.keys(Yl).forEach(function(t){eO.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Yl[e]=Yl[t]})});function Qk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Yl.hasOwnProperty(t)&&Yl[t]?(""+e).trim():e+"px"}function Jk(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Qk(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var tO=Ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fg(t,e){if(e){if(tO[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Q(62))}}function pg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mg=null;function T_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var gg=null,oa=null,aa=null;function ZE(t){if(t=su(t)){if(typeof gg!="function")throw Error(Q(280));var e=t.stateNode;e&&(e=vf(e),gg(t.stateNode,t.type,e))}}function Yk(t){oa?aa?aa.push(t):aa=[t]:oa=t}function Xk(){if(oa){var t=oa,e=aa;if(aa=oa=null,ZE(t),e)for(t=0;t<e.length;t++)ZE(e[t])}}function Zk(t,e){return t(e)}function eb(){}var qp=!1;function tb(t,e,n){if(qp)return t(e,n);qp=!0;try{return Zk(t,e,n)}finally{qp=!1,(oa!==null||aa!==null)&&(eb(),Xk())}}function Ec(t,e){var n=t.stateNode;if(n===null)return null;var r=vf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Q(231,e,typeof n));return n}var yg=!1;if(ei)try{var Il={};Object.defineProperty(Il,"passive",{get:function(){yg=!0}}),window.addEventListener("test",Il,Il),window.removeEventListener("test",Il,Il)}catch{yg=!1}function nO(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Xl=!1,Zd=null,eh=!1,_g=null,rO={onError:function(t){Xl=!0,Zd=t}};function iO(t,e,n,r,i,s,o,a,l){Xl=!1,Zd=null,nO.apply(rO,arguments)}function sO(t,e,n,r,i,s,o,a,l){if(iO.apply(this,arguments),Xl){if(Xl){var u=Zd;Xl=!1,Zd=null}else throw Error(Q(198));eh||(eh=!0,_g=u)}}function Eo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function nb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function e0(t){if(Eo(t)!==t)throw Error(Q(188))}function oO(t){var e=t.alternate;if(!e){if(e=Eo(t),e===null)throw Error(Q(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return e0(i),t;if(s===r)return e0(i),e;s=s.sibling}throw Error(Q(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?t:e}function rb(t){return t=oO(t),t!==null?ib(t):null}function ib(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ib(t);if(e!==null)return e;t=t.sibling}return null}var sb=bn.unstable_scheduleCallback,t0=bn.unstable_cancelCallback,aO=bn.unstable_shouldYield,lO=bn.unstable_requestPaint,at=bn.unstable_now,cO=bn.unstable_getCurrentPriorityLevel,I_=bn.unstable_ImmediatePriority,ob=bn.unstable_UserBlockingPriority,th=bn.unstable_NormalPriority,uO=bn.unstable_LowPriority,ab=bn.unstable_IdlePriority,mf=null,Ir=null;function dO(t){if(Ir&&typeof Ir.onCommitFiberRoot=="function")try{Ir.onCommitFiberRoot(mf,t,void 0,(t.current.flags&128)===128)}catch{}}var ir=Math.clz32?Math.clz32:pO,hO=Math.log,fO=Math.LN2;function pO(t){return t>>>=0,t===0?32:31-(hO(t)/fO|0)|0}var Bu=64,zu=4194304;function jl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function nh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=jl(a):(s&=o,s!==0&&(r=jl(s)))}else o=n&~i,o!==0?r=jl(o):s!==0&&(r=jl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ir(e),i=1<<n,r|=t[n],e&=~i;return r}function mO(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gO(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-ir(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=mO(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function vg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function lb(){var t=Bu;return Bu<<=1,!(Bu&4194240)&&(Bu=64),t}function Hp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ru(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ir(e),t[e]=n}function yO(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ir(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function C_(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ir(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ne=0;function cb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ub,k_,db,hb,fb,wg=!1,Wu=[],ji=null,Ui=null,$i=null,Sc=new Map,Tc=new Map,Pi=[],_O="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function n0(t,e){switch(t){case"focusin":case"focusout":ji=null;break;case"dragenter":case"dragleave":Ui=null;break;case"mouseover":case"mouseout":$i=null;break;case"pointerover":case"pointerout":Sc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tc.delete(e.pointerId)}}function Cl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=su(e),e!==null&&k_(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function vO(t,e,n,r,i){switch(e){case"focusin":return ji=Cl(ji,t,e,n,r,i),!0;case"dragenter":return Ui=Cl(Ui,t,e,n,r,i),!0;case"mouseover":return $i=Cl($i,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Sc.set(s,Cl(Sc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Tc.set(s,Cl(Tc.get(s)||null,t,e,n,r,i)),!0}return!1}function pb(t){var e=Us(t.target);if(e!==null){var n=Eo(e);if(n!==null){if(e=n.tag,e===13){if(e=nb(n),e!==null){t.blockedOn=e,fb(t.priority,function(){db(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Eg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);mg=r,n.target.dispatchEvent(r),mg=null}else return e=su(n),e!==null&&k_(e),t.blockedOn=n,!1;e.shift()}return!0}function r0(t,e,n){kd(t)&&n.delete(e)}function wO(){wg=!1,ji!==null&&kd(ji)&&(ji=null),Ui!==null&&kd(Ui)&&(Ui=null),$i!==null&&kd($i)&&($i=null),Sc.forEach(r0),Tc.forEach(r0)}function kl(t,e){t.blockedOn===e&&(t.blockedOn=null,wg||(wg=!0,bn.unstable_scheduleCallback(bn.unstable_NormalPriority,wO)))}function Ic(t){function e(i){return kl(i,t)}if(0<Wu.length){kl(Wu[0],t);for(var n=1;n<Wu.length;n++){var r=Wu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ji!==null&&kl(ji,t),Ui!==null&&kl(Ui,t),$i!==null&&kl($i,t),Sc.forEach(e),Tc.forEach(e),n=0;n<Pi.length;n++)r=Pi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Pi.length&&(n=Pi[0],n.blockedOn===null);)pb(n),n.blockedOn===null&&Pi.shift()}var la=di.ReactCurrentBatchConfig,rh=!0;function EO(t,e,n,r){var i=Ne,s=la.transition;la.transition=null;try{Ne=1,b_(t,e,n,r)}finally{Ne=i,la.transition=s}}function SO(t,e,n,r){var i=Ne,s=la.transition;la.transition=null;try{Ne=4,b_(t,e,n,r)}finally{Ne=i,la.transition=s}}function b_(t,e,n,r){if(rh){var i=Eg(t,e,n,r);if(i===null)nm(t,e,r,ih,n),n0(t,r);else if(vO(i,t,e,n,r))r.stopPropagation();else if(n0(t,r),e&4&&-1<_O.indexOf(t)){for(;i!==null;){var s=su(i);if(s!==null&&ub(s),s=Eg(t,e,n,r),s===null&&nm(t,e,r,ih,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else nm(t,e,r,null,n)}}var ih=null;function Eg(t,e,n,r){if(ih=null,t=T_(r),t=Us(t),t!==null)if(e=Eo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=nb(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ih=t,null}function mb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cO()){case I_:return 1;case ob:return 4;case th:case uO:return 16;case ab:return 536870912;default:return 16}default:return 16}}var Di=null,A_=null,bd=null;function gb(){if(bd)return bd;var t,e=A_,n=e.length,r,i="value"in Di?Di.value:Di.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return bd=i.slice(t,1<r?1-r:void 0)}function Ad(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function qu(){return!0}function i0(){return!1}function Pn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?qu:i0,this.isPropagationStopped=i0,this}return Ze(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=qu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=qu)},persist:function(){},isPersistent:qu}),e}var qa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},P_=Pn(qa),iu=Ze({},qa,{view:0,detail:0}),TO=Pn(iu),Gp,Kp,bl,gf=Ze({},iu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:R_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==bl&&(bl&&t.type==="mousemove"?(Gp=t.screenX-bl.screenX,Kp=t.screenY-bl.screenY):Kp=Gp=0,bl=t),Gp)},movementY:function(t){return"movementY"in t?t.movementY:Kp}}),s0=Pn(gf),IO=Ze({},gf,{dataTransfer:0}),CO=Pn(IO),kO=Ze({},iu,{relatedTarget:0}),Qp=Pn(kO),bO=Ze({},qa,{animationName:0,elapsedTime:0,pseudoElement:0}),AO=Pn(bO),PO=Ze({},qa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),RO=Pn(PO),NO=Ze({},qa,{data:0}),o0=Pn(NO),xO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},MO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function DO(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=OO[t])?!!e[t]:!1}function R_(){return DO}var LO=Ze({},iu,{key:function(t){if(t.key){var e=xO[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ad(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?MO[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:R_,charCode:function(t){return t.type==="keypress"?Ad(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ad(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),VO=Pn(LO),FO=Ze({},gf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),a0=Pn(FO),jO=Ze({},iu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:R_}),UO=Pn(jO),$O=Ze({},qa,{propertyName:0,elapsedTime:0,pseudoElement:0}),BO=Pn($O),zO=Ze({},gf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),WO=Pn(zO),qO=[9,13,27,32],N_=ei&&"CompositionEvent"in window,Zl=null;ei&&"documentMode"in document&&(Zl=document.documentMode);var HO=ei&&"TextEvent"in window&&!Zl,yb=ei&&(!N_||Zl&&8<Zl&&11>=Zl),l0=" ",c0=!1;function _b(t,e){switch(t){case"keyup":return qO.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ho=!1;function GO(t,e){switch(t){case"compositionend":return vb(e);case"keypress":return e.which!==32?null:(c0=!0,l0);case"textInput":return t=e.data,t===l0&&c0?null:t;default:return null}}function KO(t,e){if(Ho)return t==="compositionend"||!N_&&_b(t,e)?(t=gb(),bd=A_=Di=null,Ho=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return yb&&e.locale!=="ko"?null:e.data;default:return null}}var QO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function u0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!QO[t.type]:e==="textarea"}function wb(t,e,n,r){Yk(r),e=sh(e,"onChange"),0<e.length&&(n=new P_("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ec=null,Cc=null;function JO(t){Nb(t,0)}function yf(t){var e=Qo(t);if(Wk(e))return t}function YO(t,e){if(t==="change")return e}var Eb=!1;if(ei){var Jp;if(ei){var Yp="oninput"in document;if(!Yp){var d0=document.createElement("div");d0.setAttribute("oninput","return;"),Yp=typeof d0.oninput=="function"}Jp=Yp}else Jp=!1;Eb=Jp&&(!document.documentMode||9<document.documentMode)}function h0(){ec&&(ec.detachEvent("onpropertychange",Sb),Cc=ec=null)}function Sb(t){if(t.propertyName==="value"&&yf(Cc)){var e=[];wb(e,Cc,t,T_(t)),tb(JO,e)}}function XO(t,e,n){t==="focusin"?(h0(),ec=e,Cc=n,ec.attachEvent("onpropertychange",Sb)):t==="focusout"&&h0()}function ZO(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return yf(Cc)}function eD(t,e){if(t==="click")return yf(e)}function tD(t,e){if(t==="input"||t==="change")return yf(e)}function nD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lr=typeof Object.is=="function"?Object.is:nD;function kc(t,e){if(lr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!rg.call(e,i)||!lr(t[i],e[i]))return!1}return!0}function f0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function p0(t,e){var n=f0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=f0(n)}}function Tb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Tb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ib(){for(var t=window,e=Xd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Xd(t.document)}return e}function x_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function rD(t){var e=Ib(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Tb(n.ownerDocument.documentElement,n)){if(r!==null&&x_(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=p0(n,s);var o=p0(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var iD=ei&&"documentMode"in document&&11>=document.documentMode,Go=null,Sg=null,tc=null,Tg=!1;function m0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Tg||Go==null||Go!==Xd(r)||(r=Go,"selectionStart"in r&&x_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),tc&&kc(tc,r)||(tc=r,r=sh(Sg,"onSelect"),0<r.length&&(e=new P_("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Go)))}function Hu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ko={animationend:Hu("Animation","AnimationEnd"),animationiteration:Hu("Animation","AnimationIteration"),animationstart:Hu("Animation","AnimationStart"),transitionend:Hu("Transition","TransitionEnd")},Xp={},Cb={};ei&&(Cb=document.createElement("div").style,"AnimationEvent"in window||(delete Ko.animationend.animation,delete Ko.animationiteration.animation,delete Ko.animationstart.animation),"TransitionEvent"in window||delete Ko.transitionend.transition);function _f(t){if(Xp[t])return Xp[t];if(!Ko[t])return t;var e=Ko[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Cb)return Xp[t]=e[n];return t}var kb=_f("animationend"),bb=_f("animationiteration"),Ab=_f("animationstart"),Pb=_f("transitionend"),Rb=new Map,g0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fs(t,e){Rb.set(t,e),wo(e,[t])}for(var Zp=0;Zp<g0.length;Zp++){var em=g0[Zp],sD=em.toLowerCase(),oD=em[0].toUpperCase()+em.slice(1);fs(sD,"on"+oD)}fs(kb,"onAnimationEnd");fs(bb,"onAnimationIteration");fs(Ab,"onAnimationStart");fs("dblclick","onDoubleClick");fs("focusin","onFocus");fs("focusout","onBlur");fs(Pb,"onTransitionEnd");Ea("onMouseEnter",["mouseout","mouseover"]);Ea("onMouseLeave",["mouseout","mouseover"]);Ea("onPointerEnter",["pointerout","pointerover"]);Ea("onPointerLeave",["pointerout","pointerover"]);wo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wo("onBeforeInput",["compositionend","keypress","textInput","paste"]);wo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aD=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ul));function y0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,sO(r,e,void 0,t),t.currentTarget=null}function Nb(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;y0(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;y0(i,a,u),s=l}}}if(eh)throw t=_g,eh=!1,_g=null,t}function We(t,e){var n=e[Ag];n===void 0&&(n=e[Ag]=new Set);var r=t+"__bubble";n.has(r)||(xb(e,t,2,!1),n.add(r))}function tm(t,e,n){var r=0;e&&(r|=4),xb(n,t,r,e)}var Gu="_reactListening"+Math.random().toString(36).slice(2);function bc(t){if(!t[Gu]){t[Gu]=!0,jk.forEach(function(n){n!=="selectionchange"&&(aD.has(n)||tm(n,!1,t),tm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Gu]||(e[Gu]=!0,tm("selectionchange",!1,e))}}function xb(t,e,n,r){switch(mb(e)){case 1:var i=EO;break;case 4:i=SO;break;default:i=b_}n=i.bind(null,e,n,t),i=void 0,!yg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function nm(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Us(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}tb(function(){var u=s,d=T_(n),f=[];e:{var m=Rb.get(t);if(m!==void 0){var w=P_,E=t;switch(t){case"keypress":if(Ad(n)===0)break e;case"keydown":case"keyup":w=VO;break;case"focusin":E="focus",w=Qp;break;case"focusout":E="blur",w=Qp;break;case"beforeblur":case"afterblur":w=Qp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=s0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=CO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=UO;break;case kb:case bb:case Ab:w=AO;break;case Pb:w=BO;break;case"scroll":w=TO;break;case"wheel":w=WO;break;case"copy":case"cut":case"paste":w=RO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=a0}var v=(e&4)!==0,b=!v&&t==="scroll",S=v?m!==null?m+"Capture":null:m;v=[];for(var T=u,k;T!==null;){k=T;var L=k.stateNode;if(k.tag===5&&L!==null&&(k=L,S!==null&&(L=Ec(T,S),L!=null&&v.push(Ac(T,L,k)))),b)break;T=T.return}0<v.length&&(m=new w(m,E,null,n,d),f.push({event:m,listeners:v}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",m&&n!==mg&&(E=n.relatedTarget||n.fromElement)&&(Us(E)||E[ti]))break e;if((w||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,w?(E=n.relatedTarget||n.toElement,w=u,E=E?Us(E):null,E!==null&&(b=Eo(E),E!==b||E.tag!==5&&E.tag!==6)&&(E=null)):(w=null,E=u),w!==E)){if(v=s0,L="onMouseLeave",S="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(v=a0,L="onPointerLeave",S="onPointerEnter",T="pointer"),b=w==null?m:Qo(w),k=E==null?m:Qo(E),m=new v(L,T+"leave",w,n,d),m.target=b,m.relatedTarget=k,L=null,Us(d)===u&&(v=new v(S,T+"enter",E,n,d),v.target=k,v.relatedTarget=b,L=v),b=L,w&&E)t:{for(v=w,S=E,T=0,k=v;k;k=Vo(k))T++;for(k=0,L=S;L;L=Vo(L))k++;for(;0<T-k;)v=Vo(v),T--;for(;0<k-T;)S=Vo(S),k--;for(;T--;){if(v===S||S!==null&&v===S.alternate)break t;v=Vo(v),S=Vo(S)}v=null}else v=null;w!==null&&_0(f,m,w,v,!1),E!==null&&b!==null&&_0(f,b,E,v,!0)}}e:{if(m=u?Qo(u):window,w=m.nodeName&&m.nodeName.toLowerCase(),w==="select"||w==="input"&&m.type==="file")var U=YO;else if(u0(m))if(Eb)U=tD;else{U=ZO;var z=XO}else(w=m.nodeName)&&w.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(U=eD);if(U&&(U=U(t,u))){wb(f,U,n,d);break e}z&&z(t,m,u),t==="focusout"&&(z=m._wrapperState)&&z.controlled&&m.type==="number"&&ug(m,"number",m.value)}switch(z=u?Qo(u):window,t){case"focusin":(u0(z)||z.contentEditable==="true")&&(Go=z,Sg=u,tc=null);break;case"focusout":tc=Sg=Go=null;break;case"mousedown":Tg=!0;break;case"contextmenu":case"mouseup":case"dragend":Tg=!1,m0(f,n,d);break;case"selectionchange":if(iD)break;case"keydown":case"keyup":m0(f,n,d)}var A;if(N_)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Ho?_b(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(yb&&n.locale!=="ko"&&(Ho||C!=="onCompositionStart"?C==="onCompositionEnd"&&Ho&&(A=gb()):(Di=d,A_="value"in Di?Di.value:Di.textContent,Ho=!0)),z=sh(u,C),0<z.length&&(C=new o0(C,t,null,n,d),f.push({event:C,listeners:z}),A?C.data=A:(A=vb(n),A!==null&&(C.data=A)))),(A=HO?GO(t,n):KO(t,n))&&(u=sh(u,"onBeforeInput"),0<u.length&&(d=new o0("onBeforeInput","beforeinput",null,n,d),f.push({event:d,listeners:u}),d.data=A))}Nb(f,e)})}function Ac(t,e,n){return{instance:t,listener:e,currentTarget:n}}function sh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ec(t,n),s!=null&&r.unshift(Ac(t,s,i)),s=Ec(t,e),s!=null&&r.push(Ac(t,s,i))),t=t.return}return r}function Vo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function _0(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Ec(n,s),l!=null&&o.unshift(Ac(n,l,a))):i||(l=Ec(n,s),l!=null&&o.push(Ac(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var lD=/\r\n?/g,cD=/\u0000|\uFFFD/g;function v0(t){return(typeof t=="string"?t:""+t).replace(lD,`
`).replace(cD,"")}function Ku(t,e,n){if(e=v0(e),v0(t)!==e&&n)throw Error(Q(425))}function oh(){}var Ig=null,Cg=null;function kg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bg=typeof setTimeout=="function"?setTimeout:void 0,uD=typeof clearTimeout=="function"?clearTimeout:void 0,w0=typeof Promise=="function"?Promise:void 0,dD=typeof queueMicrotask=="function"?queueMicrotask:typeof w0<"u"?function(t){return w0.resolve(null).then(t).catch(hD)}:bg;function hD(t){setTimeout(function(){throw t})}function rm(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ic(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ic(e)}function Bi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function E0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ha=Math.random().toString(36).slice(2),Sr="__reactFiber$"+Ha,Pc="__reactProps$"+Ha,ti="__reactContainer$"+Ha,Ag="__reactEvents$"+Ha,fD="__reactListeners$"+Ha,pD="__reactHandles$"+Ha;function Us(t){var e=t[Sr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ti]||n[Sr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=E0(t);t!==null;){if(n=t[Sr])return n;t=E0(t)}return e}t=n,n=t.parentNode}return null}function su(t){return t=t[Sr]||t[ti],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Qo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Q(33))}function vf(t){return t[Pc]||null}var Pg=[],Jo=-1;function ps(t){return{current:t}}function Ge(t){0>Jo||(t.current=Pg[Jo],Pg[Jo]=null,Jo--)}function Be(t,e){Jo++,Pg[Jo]=t.current,t.current=e}var ns={},qt=ps(ns),un=ps(!1),to=ns;function Sa(t,e){var n=t.type.contextTypes;if(!n)return ns;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function dn(t){return t=t.childContextTypes,t!=null}function ah(){Ge(un),Ge(qt)}function S0(t,e,n){if(qt.current!==ns)throw Error(Q(168));Be(qt,e),Be(un,n)}function Mb(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Q(108,XM(t)||"Unknown",i));return Ze({},n,r)}function lh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ns,to=qt.current,Be(qt,t),Be(un,un.current),!0}function T0(t,e,n){var r=t.stateNode;if(!r)throw Error(Q(169));n?(t=Mb(t,e,to),r.__reactInternalMemoizedMergedChildContext=t,Ge(un),Ge(qt),Be(qt,t)):Ge(un),Be(un,n)}var $r=null,wf=!1,im=!1;function Ob(t){$r===null?$r=[t]:$r.push(t)}function mD(t){wf=!0,Ob(t)}function ms(){if(!im&&$r!==null){im=!0;var t=0,e=Ne;try{var n=$r;for(Ne=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}$r=null,wf=!1}catch(i){throw $r!==null&&($r=$r.slice(t+1)),sb(I_,ms),i}finally{Ne=e,im=!1}}return null}var Yo=[],Xo=0,ch=null,uh=0,Mn=[],On=0,no=null,zr=1,Wr="";function Ds(t,e){Yo[Xo++]=uh,Yo[Xo++]=ch,ch=t,uh=e}function Db(t,e,n){Mn[On++]=zr,Mn[On++]=Wr,Mn[On++]=no,no=t;var r=zr;t=Wr;var i=32-ir(r)-1;r&=~(1<<i),n+=1;var s=32-ir(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,zr=1<<32-ir(e)+i|n<<i|r,Wr=s+t}else zr=1<<s|n<<i|r,Wr=t}function M_(t){t.return!==null&&(Ds(t,1),Db(t,1,0))}function O_(t){for(;t===ch;)ch=Yo[--Xo],Yo[Xo]=null,uh=Yo[--Xo],Yo[Xo]=null;for(;t===no;)no=Mn[--On],Mn[On]=null,Wr=Mn[--On],Mn[On]=null,zr=Mn[--On],Mn[On]=null}var Cn=null,Sn=null,Je=!1,er=null;function Lb(t,e){var n=Vn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function I0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Cn=t,Sn=Bi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Cn=t,Sn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=no!==null?{id:zr,overflow:Wr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Cn=t,Sn=null,!0):!1;default:return!1}}function Rg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ng(t){if(Je){var e=Sn;if(e){var n=e;if(!I0(t,e)){if(Rg(t))throw Error(Q(418));e=Bi(n.nextSibling);var r=Cn;e&&I0(t,e)?Lb(r,n):(t.flags=t.flags&-4097|2,Je=!1,Cn=t)}}else{if(Rg(t))throw Error(Q(418));t.flags=t.flags&-4097|2,Je=!1,Cn=t}}}function C0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Cn=t}function Qu(t){if(t!==Cn)return!1;if(!Je)return C0(t),Je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!kg(t.type,t.memoizedProps)),e&&(e=Sn)){if(Rg(t))throw Vb(),Error(Q(418));for(;e;)Lb(t,e),e=Bi(e.nextSibling)}if(C0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Sn=Bi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Sn=null}}else Sn=Cn?Bi(t.stateNode.nextSibling):null;return!0}function Vb(){for(var t=Sn;t;)t=Bi(t.nextSibling)}function Ta(){Sn=Cn=null,Je=!1}function D_(t){er===null?er=[t]:er.push(t)}var gD=di.ReactCurrentBatchConfig;function Al(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,t))}return t}function Ju(t,e){throw t=Object.prototype.toString.call(e),Error(Q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function k0(t){var e=t._init;return e(t._payload)}function Fb(t){function e(S,T){if(t){var k=S.deletions;k===null?(S.deletions=[T],S.flags|=16):k.push(T)}}function n(S,T){if(!t)return null;for(;T!==null;)e(S,T),T=T.sibling;return null}function r(S,T){for(S=new Map;T!==null;)T.key!==null?S.set(T.key,T):S.set(T.index,T),T=T.sibling;return S}function i(S,T){return S=Hi(S,T),S.index=0,S.sibling=null,S}function s(S,T,k){return S.index=k,t?(k=S.alternate,k!==null?(k=k.index,k<T?(S.flags|=2,T):k):(S.flags|=2,T)):(S.flags|=1048576,T)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function a(S,T,k,L){return T===null||T.tag!==6?(T=dm(k,S.mode,L),T.return=S,T):(T=i(T,k),T.return=S,T)}function l(S,T,k,L){var U=k.type;return U===qo?d(S,T,k.props.children,L,k.key):T!==null&&(T.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===ki&&k0(U)===T.type)?(L=i(T,k.props),L.ref=Al(S,T,k),L.return=S,L):(L=Dd(k.type,k.key,k.props,null,S.mode,L),L.ref=Al(S,T,k),L.return=S,L)}function u(S,T,k,L){return T===null||T.tag!==4||T.stateNode.containerInfo!==k.containerInfo||T.stateNode.implementation!==k.implementation?(T=hm(k,S.mode,L),T.return=S,T):(T=i(T,k.children||[]),T.return=S,T)}function d(S,T,k,L,U){return T===null||T.tag!==7?(T=Js(k,S.mode,L,U),T.return=S,T):(T=i(T,k),T.return=S,T)}function f(S,T,k){if(typeof T=="string"&&T!==""||typeof T=="number")return T=dm(""+T,S.mode,k),T.return=S,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case ju:return k=Dd(T.type,T.key,T.props,null,S.mode,k),k.ref=Al(S,null,T),k.return=S,k;case Wo:return T=hm(T,S.mode,k),T.return=S,T;case ki:var L=T._init;return f(S,L(T._payload),k)}if(Fl(T)||Tl(T))return T=Js(T,S.mode,k,null),T.return=S,T;Ju(S,T)}return null}function m(S,T,k,L){var U=T!==null?T.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return U!==null?null:a(S,T,""+k,L);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case ju:return k.key===U?l(S,T,k,L):null;case Wo:return k.key===U?u(S,T,k,L):null;case ki:return U=k._init,m(S,T,U(k._payload),L)}if(Fl(k)||Tl(k))return U!==null?null:d(S,T,k,L,null);Ju(S,k)}return null}function w(S,T,k,L,U){if(typeof L=="string"&&L!==""||typeof L=="number")return S=S.get(k)||null,a(T,S,""+L,U);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case ju:return S=S.get(L.key===null?k:L.key)||null,l(T,S,L,U);case Wo:return S=S.get(L.key===null?k:L.key)||null,u(T,S,L,U);case ki:var z=L._init;return w(S,T,k,z(L._payload),U)}if(Fl(L)||Tl(L))return S=S.get(k)||null,d(T,S,L,U,null);Ju(T,L)}return null}function E(S,T,k,L){for(var U=null,z=null,A=T,C=T=0,R=null;A!==null&&C<k.length;C++){A.index>C?(R=A,A=null):R=A.sibling;var x=m(S,A,k[C],L);if(x===null){A===null&&(A=R);break}t&&A&&x.alternate===null&&e(S,A),T=s(x,T,C),z===null?U=x:z.sibling=x,z=x,A=R}if(C===k.length)return n(S,A),Je&&Ds(S,C),U;if(A===null){for(;C<k.length;C++)A=f(S,k[C],L),A!==null&&(T=s(A,T,C),z===null?U=A:z.sibling=A,z=A);return Je&&Ds(S,C),U}for(A=r(S,A);C<k.length;C++)R=w(A,S,C,k[C],L),R!==null&&(t&&R.alternate!==null&&A.delete(R.key===null?C:R.key),T=s(R,T,C),z===null?U=R:z.sibling=R,z=R);return t&&A.forEach(function(O){return e(S,O)}),Je&&Ds(S,C),U}function v(S,T,k,L){var U=Tl(k);if(typeof U!="function")throw Error(Q(150));if(k=U.call(k),k==null)throw Error(Q(151));for(var z=U=null,A=T,C=T=0,R=null,x=k.next();A!==null&&!x.done;C++,x=k.next()){A.index>C?(R=A,A=null):R=A.sibling;var O=m(S,A,x.value,L);if(O===null){A===null&&(A=R);break}t&&A&&O.alternate===null&&e(S,A),T=s(O,T,C),z===null?U=O:z.sibling=O,z=O,A=R}if(x.done)return n(S,A),Je&&Ds(S,C),U;if(A===null){for(;!x.done;C++,x=k.next())x=f(S,x.value,L),x!==null&&(T=s(x,T,C),z===null?U=x:z.sibling=x,z=x);return Je&&Ds(S,C),U}for(A=r(S,A);!x.done;C++,x=k.next())x=w(A,S,C,x.value,L),x!==null&&(t&&x.alternate!==null&&A.delete(x.key===null?C:x.key),T=s(x,T,C),z===null?U=x:z.sibling=x,z=x);return t&&A.forEach(function(V){return e(S,V)}),Je&&Ds(S,C),U}function b(S,T,k,L){if(typeof k=="object"&&k!==null&&k.type===qo&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case ju:e:{for(var U=k.key,z=T;z!==null;){if(z.key===U){if(U=k.type,U===qo){if(z.tag===7){n(S,z.sibling),T=i(z,k.props.children),T.return=S,S=T;break e}}else if(z.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===ki&&k0(U)===z.type){n(S,z.sibling),T=i(z,k.props),T.ref=Al(S,z,k),T.return=S,S=T;break e}n(S,z);break}else e(S,z);z=z.sibling}k.type===qo?(T=Js(k.props.children,S.mode,L,k.key),T.return=S,S=T):(L=Dd(k.type,k.key,k.props,null,S.mode,L),L.ref=Al(S,T,k),L.return=S,S=L)}return o(S);case Wo:e:{for(z=k.key;T!==null;){if(T.key===z)if(T.tag===4&&T.stateNode.containerInfo===k.containerInfo&&T.stateNode.implementation===k.implementation){n(S,T.sibling),T=i(T,k.children||[]),T.return=S,S=T;break e}else{n(S,T);break}else e(S,T);T=T.sibling}T=hm(k,S.mode,L),T.return=S,S=T}return o(S);case ki:return z=k._init,b(S,T,z(k._payload),L)}if(Fl(k))return E(S,T,k,L);if(Tl(k))return v(S,T,k,L);Ju(S,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,T!==null&&T.tag===6?(n(S,T.sibling),T=i(T,k),T.return=S,S=T):(n(S,T),T=dm(k,S.mode,L),T.return=S,S=T),o(S)):n(S,T)}return b}var Ia=Fb(!0),jb=Fb(!1),dh=ps(null),hh=null,Zo=null,L_=null;function V_(){L_=Zo=hh=null}function F_(t){var e=dh.current;Ge(dh),t._currentValue=e}function xg(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ca(t,e){hh=t,L_=Zo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ln=!0),t.firstContext=null)}function qn(t){var e=t._currentValue;if(L_!==t)if(t={context:t,memoizedValue:e,next:null},Zo===null){if(hh===null)throw Error(Q(308));Zo=t,hh.dependencies={lanes:0,firstContext:t}}else Zo=Zo.next=t;return e}var $s=null;function j_(t){$s===null?$s=[t]:$s.push(t)}function Ub(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,j_(e)):(n.next=i.next,i.next=n),e.interleaved=n,ni(t,r)}function ni(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var bi=!1;function U_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $b(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Jr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ni(t,n)}return i=r.interleaved,i===null?(e.next=e,j_(r)):(e.next=i.next,i.next=e),r.interleaved=e,ni(t,n)}function Pd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,C_(t,n)}}function b0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function fh(t,e,n,r){var i=t.updateQueue;bi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,d=u=l=null,a=s;do{var m=a.lane,w=a.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:w,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,v=a;switch(m=e,w=n,v.tag){case 1:if(E=v.payload,typeof E=="function"){f=E.call(w,f,m);break e}f=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=v.payload,m=typeof E=="function"?E.call(w,f,m):E,m==null)break e;f=Ze({},f,m);break e;case 2:bi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else w={eventTime:w,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=w,l=f):d=d.next=w,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(d===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);io|=o,t.lanes=o,t.memoizedState=f}}function A0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Q(191,i));i.call(r)}}}var ou={},Cr=ps(ou),Rc=ps(ou),Nc=ps(ou);function Bs(t){if(t===ou)throw Error(Q(174));return t}function $_(t,e){switch(Be(Nc,e),Be(Rc,t),Be(Cr,ou),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=hg(e,t)}Ge(Cr),Be(Cr,e)}function Ca(){Ge(Cr),Ge(Rc),Ge(Nc)}function Bb(t){Bs(Nc.current);var e=Bs(Cr.current),n=hg(e,t.type);e!==n&&(Be(Rc,t),Be(Cr,n))}function B_(t){Rc.current===t&&(Ge(Cr),Ge(Rc))}var Ye=ps(0);function ph(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var sm=[];function z_(){for(var t=0;t<sm.length;t++)sm[t]._workInProgressVersionPrimary=null;sm.length=0}var Rd=di.ReactCurrentDispatcher,om=di.ReactCurrentBatchConfig,ro=0,Xe=null,_t=null,It=null,mh=!1,nc=!1,xc=0,yD=0;function Vt(){throw Error(Q(321))}function W_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!lr(t[n],e[n]))return!1;return!0}function q_(t,e,n,r,i,s){if(ro=s,Xe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Rd.current=t===null||t.memoizedState===null?ED:SD,t=n(r,i),nc){s=0;do{if(nc=!1,xc=0,25<=s)throw Error(Q(301));s+=1,It=_t=null,e.updateQueue=null,Rd.current=TD,t=n(r,i)}while(nc)}if(Rd.current=gh,e=_t!==null&&_t.next!==null,ro=0,It=_t=Xe=null,mh=!1,e)throw Error(Q(300));return t}function H_(){var t=xc!==0;return xc=0,t}function yr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?Xe.memoizedState=It=t:It=It.next=t,It}function Hn(){if(_t===null){var t=Xe.alternate;t=t!==null?t.memoizedState:null}else t=_t.next;var e=It===null?Xe.memoizedState:It.next;if(e!==null)It=e,_t=t;else{if(t===null)throw Error(Q(310));_t=t,t={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},It===null?Xe.memoizedState=It=t:It=It.next=t}return It}function Mc(t,e){return typeof e=="function"?e(t):e}function am(t){var e=Hn(),n=e.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=t;var r=_t,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((ro&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,Xe.lanes|=d,io|=d}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,lr(r,e.memoizedState)||(ln=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Xe.lanes|=s,io|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function lm(t){var e=Hn(),n=e.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);lr(s,e.memoizedState)||(ln=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function zb(){}function Wb(t,e){var n=Xe,r=Hn(),i=e(),s=!lr(r.memoizedState,i);if(s&&(r.memoizedState=i,ln=!0),r=r.queue,G_(Gb.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||It!==null&&It.memoizedState.tag&1){if(n.flags|=2048,Oc(9,Hb.bind(null,n,r,i,e),void 0,null),bt===null)throw Error(Q(349));ro&30||qb(n,e,i)}return i}function qb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Xe.updateQueue,e===null?(e={lastEffect:null,stores:null},Xe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Hb(t,e,n,r){e.value=n,e.getSnapshot=r,Kb(e)&&Qb(t)}function Gb(t,e,n){return n(function(){Kb(e)&&Qb(t)})}function Kb(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!lr(t,n)}catch{return!0}}function Qb(t){var e=ni(t,1);e!==null&&sr(e,t,1,-1)}function P0(t){var e=yr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mc,lastRenderedState:t},e.queue=t,t=t.dispatch=wD.bind(null,Xe,t),[e.memoizedState,t]}function Oc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Xe.updateQueue,e===null?(e={lastEffect:null,stores:null},Xe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Jb(){return Hn().memoizedState}function Nd(t,e,n,r){var i=yr();Xe.flags|=t,i.memoizedState=Oc(1|e,n,void 0,r===void 0?null:r)}function Ef(t,e,n,r){var i=Hn();r=r===void 0?null:r;var s=void 0;if(_t!==null){var o=_t.memoizedState;if(s=o.destroy,r!==null&&W_(r,o.deps)){i.memoizedState=Oc(e,n,s,r);return}}Xe.flags|=t,i.memoizedState=Oc(1|e,n,s,r)}function R0(t,e){return Nd(8390656,8,t,e)}function G_(t,e){return Ef(2048,8,t,e)}function Yb(t,e){return Ef(4,2,t,e)}function Xb(t,e){return Ef(4,4,t,e)}function Zb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function e1(t,e,n){return n=n!=null?n.concat([t]):null,Ef(4,4,Zb.bind(null,e,t),n)}function K_(){}function t1(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&W_(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function n1(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&W_(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function r1(t,e,n){return ro&21?(lr(n,e)||(n=lb(),Xe.lanes|=n,io|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ln=!0),t.memoizedState=n)}function _D(t,e){var n=Ne;Ne=n!==0&&4>n?n:4,t(!0);var r=om.transition;om.transition={};try{t(!1),e()}finally{Ne=n,om.transition=r}}function i1(){return Hn().memoizedState}function vD(t,e,n){var r=qi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},s1(t))o1(e,n);else if(n=Ub(t,e,n,r),n!==null){var i=en();sr(n,t,r,i),a1(n,e,r)}}function wD(t,e,n){var r=qi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(s1(t))o1(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,lr(a,o)){var l=e.interleaved;l===null?(i.next=i,j_(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=Ub(t,e,i,r),n!==null&&(i=en(),sr(n,t,r,i),a1(n,e,r))}}function s1(t){var e=t.alternate;return t===Xe||e!==null&&e===Xe}function o1(t,e){nc=mh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function a1(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,C_(t,n)}}var gh={readContext:qn,useCallback:Vt,useContext:Vt,useEffect:Vt,useImperativeHandle:Vt,useInsertionEffect:Vt,useLayoutEffect:Vt,useMemo:Vt,useReducer:Vt,useRef:Vt,useState:Vt,useDebugValue:Vt,useDeferredValue:Vt,useTransition:Vt,useMutableSource:Vt,useSyncExternalStore:Vt,useId:Vt,unstable_isNewReconciler:!1},ED={readContext:qn,useCallback:function(t,e){return yr().memoizedState=[t,e===void 0?null:e],t},useContext:qn,useEffect:R0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Nd(4194308,4,Zb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Nd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Nd(4,2,t,e)},useMemo:function(t,e){var n=yr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=yr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=vD.bind(null,Xe,t),[r.memoizedState,t]},useRef:function(t){var e=yr();return t={current:t},e.memoizedState=t},useState:P0,useDebugValue:K_,useDeferredValue:function(t){return yr().memoizedState=t},useTransition:function(){var t=P0(!1),e=t[0];return t=_D.bind(null,t[1]),yr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Xe,i=yr();if(Je){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=e(),bt===null)throw Error(Q(349));ro&30||qb(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,R0(Gb.bind(null,r,s,t),[t]),r.flags|=2048,Oc(9,Hb.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=yr(),e=bt.identifierPrefix;if(Je){var n=Wr,r=zr;n=(r&~(1<<32-ir(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=xc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=yD++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},SD={readContext:qn,useCallback:t1,useContext:qn,useEffect:G_,useImperativeHandle:e1,useInsertionEffect:Yb,useLayoutEffect:Xb,useMemo:n1,useReducer:am,useRef:Jb,useState:function(){return am(Mc)},useDebugValue:K_,useDeferredValue:function(t){var e=Hn();return r1(e,_t.memoizedState,t)},useTransition:function(){var t=am(Mc)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:zb,useSyncExternalStore:Wb,useId:i1,unstable_isNewReconciler:!1},TD={readContext:qn,useCallback:t1,useContext:qn,useEffect:G_,useImperativeHandle:e1,useInsertionEffect:Yb,useLayoutEffect:Xb,useMemo:n1,useReducer:lm,useRef:Jb,useState:function(){return lm(Mc)},useDebugValue:K_,useDeferredValue:function(t){var e=Hn();return _t===null?e.memoizedState=t:r1(e,_t.memoizedState,t)},useTransition:function(){var t=lm(Mc)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:zb,useSyncExternalStore:Wb,useId:i1,unstable_isNewReconciler:!1};function Xn(t,e){if(t&&t.defaultProps){e=Ze({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Mg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ze({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Sf={isMounted:function(t){return(t=t._reactInternals)?Eo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=en(),i=qi(t),s=Jr(r,i);s.payload=e,n!=null&&(s.callback=n),e=zi(t,s,i),e!==null&&(sr(e,t,i,r),Pd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=en(),i=qi(t),s=Jr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=zi(t,s,i),e!==null&&(sr(e,t,i,r),Pd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=en(),r=qi(t),i=Jr(n,r);i.tag=2,e!=null&&(i.callback=e),e=zi(t,i,r),e!==null&&(sr(e,t,r,n),Pd(e,t,r))}};function N0(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!kc(n,r)||!kc(i,s):!0}function l1(t,e,n){var r=!1,i=ns,s=e.contextType;return typeof s=="object"&&s!==null?s=qn(s):(i=dn(e)?to:qt.current,r=e.contextTypes,s=(r=r!=null)?Sa(t,i):ns),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Sf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function x0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Sf.enqueueReplaceState(e,e.state,null)}function Og(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},U_(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=qn(s):(s=dn(e)?to:qt.current,i.context=Sa(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Mg(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Sf.enqueueReplaceState(i,i.state,null),fh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ka(t,e){try{var n="",r=e;do n+=YM(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function cm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Dg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ID=typeof WeakMap=="function"?WeakMap:Map;function c1(t,e,n){n=Jr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){_h||(_h=!0,qg=r),Dg(t,e)},n}function u1(t,e,n){n=Jr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Dg(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Dg(t,e),typeof r!="function"&&(Wi===null?Wi=new Set([this]):Wi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function M0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ID;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=FD.bind(null,t,e,n),e.then(t,t))}function O0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function D0(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Jr(-1,1),e.tag=2,zi(n,e,1))),n.lanes|=1),t)}var CD=di.ReactCurrentOwner,ln=!1;function Jt(t,e,n,r){e.child=t===null?jb(e,null,n,r):Ia(e,t.child,n,r)}function L0(t,e,n,r,i){n=n.render;var s=e.ref;return ca(e,i),r=q_(t,e,n,r,s,i),n=H_(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ri(t,e,i)):(Je&&n&&M_(e),e.flags|=1,Jt(t,e,r,i),e.child)}function V0(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!nv(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,d1(t,e,s,r,i)):(t=Dd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:kc,n(o,r)&&t.ref===e.ref)return ri(t,e,i)}return e.flags|=1,t=Hi(s,r),t.ref=e.ref,t.return=e,e.child=t}function d1(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(kc(s,r)&&t.ref===e.ref)if(ln=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(ln=!0);else return e.lanes=t.lanes,ri(t,e,i)}return Lg(t,e,n,r,i)}function h1(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(ta,wn),wn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Be(ta,wn),wn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Be(ta,wn),wn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Be(ta,wn),wn|=r;return Jt(t,e,i,n),e.child}function f1(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Lg(t,e,n,r,i){var s=dn(n)?to:qt.current;return s=Sa(e,s),ca(e,i),n=q_(t,e,n,r,s,i),r=H_(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ri(t,e,i)):(Je&&r&&M_(e),e.flags|=1,Jt(t,e,n,i),e.child)}function F0(t,e,n,r,i){if(dn(n)){var s=!0;lh(e)}else s=!1;if(ca(e,i),e.stateNode===null)xd(t,e),l1(e,n,r),Og(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=qn(u):(u=dn(n)?to:qt.current,u=Sa(e,u));var d=n.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&x0(e,o,r,u),bi=!1;var m=e.memoizedState;o.state=m,fh(e,r,o,i),l=e.memoizedState,a!==r||m!==l||un.current||bi?(typeof d=="function"&&(Mg(e,n,d,r),l=e.memoizedState),(a=bi||N0(e,n,a,r,m,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,$b(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Xn(e.type,a),o.props=u,f=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=qn(l):(l=dn(n)?to:qt.current,l=Sa(e,l));var w=n.getDerivedStateFromProps;(d=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==l)&&x0(e,o,r,l),bi=!1,m=e.memoizedState,o.state=m,fh(e,r,o,i);var E=e.memoizedState;a!==f||m!==E||un.current||bi?(typeof w=="function"&&(Mg(e,n,w,r),E=e.memoizedState),(u=bi||N0(e,n,u,r,m,E,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Vg(t,e,n,r,s,i)}function Vg(t,e,n,r,i,s){f1(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&T0(e,n,!1),ri(t,e,s);r=e.stateNode,CD.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ia(e,t.child,null,s),e.child=Ia(e,null,a,s)):Jt(t,e,a,s),e.memoizedState=r.state,i&&T0(e,n,!0),e.child}function p1(t){var e=t.stateNode;e.pendingContext?S0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&S0(t,e.context,!1),$_(t,e.containerInfo)}function j0(t,e,n,r,i){return Ta(),D_(i),e.flags|=256,Jt(t,e,n,r),e.child}var Fg={dehydrated:null,treeContext:null,retryLane:0};function jg(t){return{baseLanes:t,cachePool:null,transitions:null}}function m1(t,e,n){var r=e.pendingProps,i=Ye.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Be(Ye,i&1),t===null)return Ng(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Cf(o,r,0,null),t=Js(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=jg(n),e.memoizedState=Fg,t):Q_(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return kD(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Hi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Hi(a,s):(s=Js(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?jg(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Fg,r}return s=t.child,t=s.sibling,r=Hi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Q_(t,e){return e=Cf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Yu(t,e,n,r){return r!==null&&D_(r),Ia(e,t.child,null,n),t=Q_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function kD(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=cm(Error(Q(422))),Yu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Cf({mode:"visible",children:r.children},i,0,null),s=Js(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ia(e,t.child,null,o),e.child.memoizedState=jg(o),e.memoizedState=Fg,s);if(!(e.mode&1))return Yu(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Q(419)),r=cm(s,r,void 0),Yu(t,e,o,r)}if(a=(o&t.childLanes)!==0,ln||a){if(r=bt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ni(t,i),sr(r,t,i,-1))}return tv(),r=cm(Error(Q(421))),Yu(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=jD.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Sn=Bi(i.nextSibling),Cn=e,Je=!0,er=null,t!==null&&(Mn[On++]=zr,Mn[On++]=Wr,Mn[On++]=no,zr=t.id,Wr=t.overflow,no=e),e=Q_(e,r.children),e.flags|=4096,e)}function U0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),xg(t.return,e,n)}function um(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function g1(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Jt(t,e,r.children,n),r=Ye.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&U0(t,n,e);else if(t.tag===19)U0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Be(Ye,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&ph(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),um(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ph(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}um(e,!0,n,null,s);break;case"together":um(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function xd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ri(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),io|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Q(153));if(e.child!==null){for(t=e.child,n=Hi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Hi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function bD(t,e,n){switch(e.tag){case 3:p1(e),Ta();break;case 5:Bb(e);break;case 1:dn(e.type)&&lh(e);break;case 4:$_(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Be(dh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Be(Ye,Ye.current&1),e.flags|=128,null):n&e.child.childLanes?m1(t,e,n):(Be(Ye,Ye.current&1),t=ri(t,e,n),t!==null?t.sibling:null);Be(Ye,Ye.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return g1(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Be(Ye,Ye.current),r)break;return null;case 22:case 23:return e.lanes=0,h1(t,e,n)}return ri(t,e,n)}var y1,Ug,_1,v1;y1=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ug=function(){};_1=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Bs(Cr.current);var s=null;switch(n){case"input":i=lg(t,i),r=lg(t,r),s=[];break;case"select":i=Ze({},i,{value:void 0}),r=Ze({},r,{value:void 0}),s=[];break;case"textarea":i=dg(t,i),r=dg(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=oh)}fg(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(vc.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(vc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&We("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};v1=function(t,e,n,r){n!==r&&(e.flags|=4)};function Pl(t,e){if(!Je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ft(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function AD(t,e,n){var r=e.pendingProps;switch(O_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(e),null;case 1:return dn(e.type)&&ah(),Ft(e),null;case 3:return r=e.stateNode,Ca(),Ge(un),Ge(qt),z_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Qu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,er!==null&&(Kg(er),er=null))),Ug(t,e),Ft(e),null;case 5:B_(e);var i=Bs(Nc.current);if(n=e.type,t!==null&&e.stateNode!=null)_1(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Q(166));return Ft(e),null}if(t=Bs(Cr.current),Qu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Sr]=e,r[Pc]=s,t=(e.mode&1)!==0,n){case"dialog":We("cancel",r),We("close",r);break;case"iframe":case"object":case"embed":We("load",r);break;case"video":case"audio":for(i=0;i<Ul.length;i++)We(Ul[i],r);break;case"source":We("error",r);break;case"img":case"image":case"link":We("error",r),We("load",r);break;case"details":We("toggle",r);break;case"input":QE(r,s),We("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},We("invalid",r);break;case"textarea":YE(r,s),We("invalid",r)}fg(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ku(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ku(r.textContent,a,t),i=["children",""+a]):vc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&We("scroll",r)}switch(n){case"input":Uu(r),JE(r,s,!0);break;case"textarea":Uu(r),XE(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=oh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Gk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Sr]=e,t[Pc]=r,y1(t,e,!1,!1),e.stateNode=t;e:{switch(o=pg(n,r),n){case"dialog":We("cancel",t),We("close",t),i=r;break;case"iframe":case"object":case"embed":We("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ul.length;i++)We(Ul[i],t);i=r;break;case"source":We("error",t),i=r;break;case"img":case"image":case"link":We("error",t),We("load",t),i=r;break;case"details":We("toggle",t),i=r;break;case"input":QE(t,r),i=lg(t,r),We("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ze({},r,{value:void 0}),We("invalid",t);break;case"textarea":YE(t,r),i=dg(t,r),We("invalid",t);break;default:i=r}fg(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Jk(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Kk(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&wc(t,l):typeof l=="number"&&wc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(vc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&We("scroll",t):l!=null&&v_(t,s,l,o))}switch(n){case"input":Uu(t),JE(t,r,!1);break;case"textarea":Uu(t),XE(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ts(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?sa(t,!!r.multiple,s,!1):r.defaultValue!=null&&sa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=oh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ft(e),null;case 6:if(t&&e.stateNode!=null)v1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Q(166));if(n=Bs(Nc.current),Bs(Cr.current),Qu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Sr]=e,(s=r.nodeValue!==n)&&(t=Cn,t!==null))switch(t.tag){case 3:Ku(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ku(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Sr]=e,e.stateNode=r}return Ft(e),null;case 13:if(Ge(Ye),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Je&&Sn!==null&&e.mode&1&&!(e.flags&128))Vb(),Ta(),e.flags|=98560,s=!1;else if(s=Qu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Q(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Q(317));s[Sr]=e}else Ta(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ft(e),s=!1}else er!==null&&(Kg(er),er=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ye.current&1?vt===0&&(vt=3):tv())),e.updateQueue!==null&&(e.flags|=4),Ft(e),null);case 4:return Ca(),Ug(t,e),t===null&&bc(e.stateNode.containerInfo),Ft(e),null;case 10:return F_(e.type._context),Ft(e),null;case 17:return dn(e.type)&&ah(),Ft(e),null;case 19:if(Ge(Ye),s=e.memoizedState,s===null)return Ft(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Pl(s,!1);else{if(vt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ph(t),o!==null){for(e.flags|=128,Pl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Be(Ye,Ye.current&1|2),e.child}t=t.sibling}s.tail!==null&&at()>ba&&(e.flags|=128,r=!0,Pl(s,!1),e.lanes=4194304)}else{if(!r)if(t=ph(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Pl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Je)return Ft(e),null}else 2*at()-s.renderingStartTime>ba&&n!==1073741824&&(e.flags|=128,r=!0,Pl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=at(),e.sibling=null,n=Ye.current,Be(Ye,r?n&1|2:n&1),e):(Ft(e),null);case 22:case 23:return ev(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?wn&1073741824&&(Ft(e),e.subtreeFlags&6&&(e.flags|=8192)):Ft(e),null;case 24:return null;case 25:return null}throw Error(Q(156,e.tag))}function PD(t,e){switch(O_(e),e.tag){case 1:return dn(e.type)&&ah(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ca(),Ge(un),Ge(qt),z_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return B_(e),null;case 13:if(Ge(Ye),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Q(340));Ta()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ge(Ye),null;case 4:return Ca(),null;case 10:return F_(e.type._context),null;case 22:case 23:return ev(),null;case 24:return null;default:return null}}var Xu=!1,$t=!1,RD=typeof WeakSet=="function"?WeakSet:Set,ne=null;function ea(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){nt(t,e,r)}else n.current=null}function $g(t,e,n){try{n()}catch(r){nt(t,e,r)}}var $0=!1;function ND(t,e){if(Ig=rh,t=Ib(),x_(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,f=t,m=null;t:for(;;){for(var w;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(w=f.firstChild)!==null;)m=f,f=w;for(;;){if(f===t)break t;if(m===n&&++u===i&&(a=o),m===s&&++d===r&&(l=o),(w=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=w}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Cg={focusedElem:t,selectionRange:n},rh=!1,ne=e;ne!==null;)if(e=ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ne=t;else for(;ne!==null;){e=ne;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var v=E.memoizedProps,b=E.memoizedState,S=e.stateNode,T=S.getSnapshotBeforeUpdate(e.elementType===e.type?v:Xn(e.type,v),b);S.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(L){nt(e,e.return,L)}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}return E=$0,$0=!1,E}function rc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&$g(e,n,s)}i=i.next}while(i!==r)}}function Tf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Bg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function w1(t){var e=t.alternate;e!==null&&(t.alternate=null,w1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Sr],delete e[Pc],delete e[Ag],delete e[fD],delete e[pD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function E1(t){return t.tag===5||t.tag===3||t.tag===4}function B0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||E1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=oh));else if(r!==4&&(t=t.child,t!==null))for(zg(t,e,n),t=t.sibling;t!==null;)zg(t,e,n),t=t.sibling}function Wg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Wg(t,e,n),t=t.sibling;t!==null;)Wg(t,e,n),t=t.sibling}var Pt=null,Zn=!1;function Ei(t,e,n){for(n=n.child;n!==null;)S1(t,e,n),n=n.sibling}function S1(t,e,n){if(Ir&&typeof Ir.onCommitFiberUnmount=="function")try{Ir.onCommitFiberUnmount(mf,n)}catch{}switch(n.tag){case 5:$t||ea(n,e);case 6:var r=Pt,i=Zn;Pt=null,Ei(t,e,n),Pt=r,Zn=i,Pt!==null&&(Zn?(t=Pt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Pt.removeChild(n.stateNode));break;case 18:Pt!==null&&(Zn?(t=Pt,n=n.stateNode,t.nodeType===8?rm(t.parentNode,n):t.nodeType===1&&rm(t,n),Ic(t)):rm(Pt,n.stateNode));break;case 4:r=Pt,i=Zn,Pt=n.stateNode.containerInfo,Zn=!0,Ei(t,e,n),Pt=r,Zn=i;break;case 0:case 11:case 14:case 15:if(!$t&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&$g(n,e,o),i=i.next}while(i!==r)}Ei(t,e,n);break;case 1:if(!$t&&(ea(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){nt(n,e,a)}Ei(t,e,n);break;case 21:Ei(t,e,n);break;case 22:n.mode&1?($t=(r=$t)||n.memoizedState!==null,Ei(t,e,n),$t=r):Ei(t,e,n);break;default:Ei(t,e,n)}}function z0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new RD),e.forEach(function(r){var i=UD.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Qn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Pt=a.stateNode,Zn=!1;break e;case 3:Pt=a.stateNode.containerInfo,Zn=!0;break e;case 4:Pt=a.stateNode.containerInfo,Zn=!0;break e}a=a.return}if(Pt===null)throw Error(Q(160));S1(s,o,i),Pt=null,Zn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){nt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)T1(e,t),e=e.sibling}function T1(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qn(e,t),gr(t),r&4){try{rc(3,t,t.return),Tf(3,t)}catch(v){nt(t,t.return,v)}try{rc(5,t,t.return)}catch(v){nt(t,t.return,v)}}break;case 1:Qn(e,t),gr(t),r&512&&n!==null&&ea(n,n.return);break;case 5:if(Qn(e,t),gr(t),r&512&&n!==null&&ea(n,n.return),t.flags&32){var i=t.stateNode;try{wc(i,"")}catch(v){nt(t,t.return,v)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&qk(i,s),pg(a,o);var u=pg(a,s);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?Jk(i,f):d==="dangerouslySetInnerHTML"?Kk(i,f):d==="children"?wc(i,f):v_(i,d,f,u)}switch(a){case"input":cg(i,s);break;case"textarea":Hk(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var w=s.value;w!=null?sa(i,!!s.multiple,w,!1):m!==!!s.multiple&&(s.defaultValue!=null?sa(i,!!s.multiple,s.defaultValue,!0):sa(i,!!s.multiple,s.multiple?[]:"",!1))}i[Pc]=s}catch(v){nt(t,t.return,v)}}break;case 6:if(Qn(e,t),gr(t),r&4){if(t.stateNode===null)throw Error(Q(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){nt(t,t.return,v)}}break;case 3:if(Qn(e,t),gr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ic(e.containerInfo)}catch(v){nt(t,t.return,v)}break;case 4:Qn(e,t),gr(t);break;case 13:Qn(e,t),gr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(X_=at())),r&4&&z0(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?($t=(u=$t)||d,Qn(e,t),$t=u):Qn(e,t),gr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(ne=t,d=t.child;d!==null;){for(f=ne=d;ne!==null;){switch(m=ne,w=m.child,m.tag){case 0:case 11:case 14:case 15:rc(4,m,m.return);break;case 1:ea(m,m.return);var E=m.stateNode;if(typeof E.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(v){nt(r,n,v)}}break;case 5:ea(m,m.return);break;case 22:if(m.memoizedState!==null){q0(f);continue}}w!==null?(w.return=m,ne=w):q0(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Qk("display",o))}catch(v){nt(t,t.return,v)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){nt(t,t.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Qn(e,t),gr(t),r&4&&z0(t);break;case 21:break;default:Qn(e,t),gr(t)}}function gr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(E1(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(wc(i,""),r.flags&=-33);var s=B0(t);Wg(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=B0(t);zg(t,a,o);break;default:throw Error(Q(161))}}catch(l){nt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function xD(t,e,n){ne=t,I1(t)}function I1(t,e,n){for(var r=(t.mode&1)!==0;ne!==null;){var i=ne,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Xu;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||$t;a=Xu;var u=$t;if(Xu=o,($t=l)&&!u)for(ne=i;ne!==null;)o=ne,l=o.child,o.tag===22&&o.memoizedState!==null?H0(i):l!==null?(l.return=o,ne=l):H0(i);for(;s!==null;)ne=s,I1(s),s=s.sibling;ne=i,Xu=a,$t=u}W0(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ne=s):W0(t)}}function W0(t){for(;ne!==null;){var e=ne;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$t||Tf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$t)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Xn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&A0(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}A0(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Ic(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}$t||e.flags&512&&Bg(e)}catch(m){nt(e,e.return,m)}}if(e===t){ne=null;break}if(n=e.sibling,n!==null){n.return=e.return,ne=n;break}ne=e.return}}function q0(t){for(;ne!==null;){var e=ne;if(e===t){ne=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ne=n;break}ne=e.return}}function H0(t){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Tf(4,e)}catch(l){nt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){nt(e,i,l)}}var s=e.return;try{Bg(e)}catch(l){nt(e,s,l)}break;case 5:var o=e.return;try{Bg(e)}catch(l){nt(e,o,l)}}}catch(l){nt(e,e.return,l)}if(e===t){ne=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ne=a;break}ne=e.return}}var MD=Math.ceil,yh=di.ReactCurrentDispatcher,J_=di.ReactCurrentOwner,$n=di.ReactCurrentBatchConfig,be=0,bt=null,ft=null,Ot=0,wn=0,ta=ps(0),vt=0,Dc=null,io=0,If=0,Y_=0,ic=null,on=null,X_=0,ba=1/0,Fr=null,_h=!1,qg=null,Wi=null,Zu=!1,Li=null,vh=0,sc=0,Hg=null,Md=-1,Od=0;function en(){return be&6?at():Md!==-1?Md:Md=at()}function qi(t){return t.mode&1?be&2&&Ot!==0?Ot&-Ot:gD.transition!==null?(Od===0&&(Od=lb()),Od):(t=Ne,t!==0||(t=window.event,t=t===void 0?16:mb(t.type)),t):1}function sr(t,e,n,r){if(50<sc)throw sc=0,Hg=null,Error(Q(185));ru(t,n,r),(!(be&2)||t!==bt)&&(t===bt&&(!(be&2)&&(If|=n),vt===4&&Ri(t,Ot)),hn(t,r),n===1&&be===0&&!(e.mode&1)&&(ba=at()+500,wf&&ms()))}function hn(t,e){var n=t.callbackNode;gO(t,e);var r=nh(t,t===bt?Ot:0);if(r===0)n!==null&&t0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&t0(n),e===1)t.tag===0?mD(G0.bind(null,t)):Ob(G0.bind(null,t)),dD(function(){!(be&6)&&ms()}),n=null;else{switch(cb(r)){case 1:n=I_;break;case 4:n=ob;break;case 16:n=th;break;case 536870912:n=ab;break;default:n=th}n=x1(n,C1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function C1(t,e){if(Md=-1,Od=0,be&6)throw Error(Q(327));var n=t.callbackNode;if(ua()&&t.callbackNode!==n)return null;var r=nh(t,t===bt?Ot:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=wh(t,r);else{e=r;var i=be;be|=2;var s=b1();(bt!==t||Ot!==e)&&(Fr=null,ba=at()+500,Qs(t,e));do try{LD();break}catch(a){k1(t,a)}while(!0);V_(),yh.current=s,be=i,ft!==null?e=0:(bt=null,Ot=0,e=vt)}if(e!==0){if(e===2&&(i=vg(t),i!==0&&(r=i,e=Gg(t,i))),e===1)throw n=Dc,Qs(t,0),Ri(t,r),hn(t,at()),n;if(e===6)Ri(t,r);else{if(i=t.current.alternate,!(r&30)&&!OD(i)&&(e=wh(t,r),e===2&&(s=vg(t),s!==0&&(r=s,e=Gg(t,s))),e===1))throw n=Dc,Qs(t,0),Ri(t,r),hn(t,at()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Q(345));case 2:Ls(t,on,Fr);break;case 3:if(Ri(t,r),(r&130023424)===r&&(e=X_+500-at(),10<e)){if(nh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){en(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=bg(Ls.bind(null,t,on,Fr),e);break}Ls(t,on,Fr);break;case 4:if(Ri(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-ir(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=at()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*MD(r/1960))-r,10<r){t.timeoutHandle=bg(Ls.bind(null,t,on,Fr),r);break}Ls(t,on,Fr);break;case 5:Ls(t,on,Fr);break;default:throw Error(Q(329))}}}return hn(t,at()),t.callbackNode===n?C1.bind(null,t):null}function Gg(t,e){var n=ic;return t.current.memoizedState.isDehydrated&&(Qs(t,e).flags|=256),t=wh(t,e),t!==2&&(e=on,on=n,e!==null&&Kg(e)),t}function Kg(t){on===null?on=t:on.push.apply(on,t)}function OD(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!lr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ri(t,e){for(e&=~Y_,e&=~If,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ir(e),r=1<<n;t[n]=-1,e&=~r}}function G0(t){if(be&6)throw Error(Q(327));ua();var e=nh(t,0);if(!(e&1))return hn(t,at()),null;var n=wh(t,e);if(t.tag!==0&&n===2){var r=vg(t);r!==0&&(e=r,n=Gg(t,r))}if(n===1)throw n=Dc,Qs(t,0),Ri(t,e),hn(t,at()),n;if(n===6)throw Error(Q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ls(t,on,Fr),hn(t,at()),null}function Z_(t,e){var n=be;be|=1;try{return t(e)}finally{be=n,be===0&&(ba=at()+500,wf&&ms())}}function so(t){Li!==null&&Li.tag===0&&!(be&6)&&ua();var e=be;be|=1;var n=$n.transition,r=Ne;try{if($n.transition=null,Ne=1,t)return t()}finally{Ne=r,$n.transition=n,be=e,!(be&6)&&ms()}}function ev(){wn=ta.current,Ge(ta)}function Qs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,uD(n)),ft!==null)for(n=ft.return;n!==null;){var r=n;switch(O_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ah();break;case 3:Ca(),Ge(un),Ge(qt),z_();break;case 5:B_(r);break;case 4:Ca();break;case 13:Ge(Ye);break;case 19:Ge(Ye);break;case 10:F_(r.type._context);break;case 22:case 23:ev()}n=n.return}if(bt=t,ft=t=Hi(t.current,null),Ot=wn=e,vt=0,Dc=null,Y_=If=io=0,on=ic=null,$s!==null){for(e=0;e<$s.length;e++)if(n=$s[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}$s=null}return t}function k1(t,e){do{var n=ft;try{if(V_(),Rd.current=gh,mh){for(var r=Xe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}mh=!1}if(ro=0,It=_t=Xe=null,nc=!1,xc=0,J_.current=null,n===null||n.return===null){vt=1,Dc=e,ft=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Ot,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var w=O0(o);if(w!==null){w.flags&=-257,D0(w,o,a,s,e),w.mode&1&&M0(s,u,e),e=w,l=u;var E=e.updateQueue;if(E===null){var v=new Set;v.add(l),e.updateQueue=v}else E.add(l);break e}else{if(!(e&1)){M0(s,u,e),tv();break e}l=Error(Q(426))}}else if(Je&&a.mode&1){var b=O0(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),D0(b,o,a,s,e),D_(ka(l,a));break e}}s=l=ka(l,a),vt!==4&&(vt=2),ic===null?ic=[s]:ic.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var S=c1(s,l,e);b0(s,S);break e;case 1:a=l;var T=s.type,k=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Wi===null||!Wi.has(k)))){s.flags|=65536,e&=-e,s.lanes|=e;var L=u1(s,a,e);b0(s,L);break e}}s=s.return}while(s!==null)}P1(n)}catch(U){e=U,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(!0)}function b1(){var t=yh.current;return yh.current=gh,t===null?gh:t}function tv(){(vt===0||vt===3||vt===2)&&(vt=4),bt===null||!(io&268435455)&&!(If&268435455)||Ri(bt,Ot)}function wh(t,e){var n=be;be|=2;var r=b1();(bt!==t||Ot!==e)&&(Fr=null,Qs(t,e));do try{DD();break}catch(i){k1(t,i)}while(!0);if(V_(),be=n,yh.current=r,ft!==null)throw Error(Q(261));return bt=null,Ot=0,vt}function DD(){for(;ft!==null;)A1(ft)}function LD(){for(;ft!==null&&!aO();)A1(ft)}function A1(t){var e=N1(t.alternate,t,wn);t.memoizedProps=t.pendingProps,e===null?P1(t):ft=e,J_.current=null}function P1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=PD(n,e),n!==null){n.flags&=32767,ft=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vt=6,ft=null;return}}else if(n=AD(n,e,wn),n!==null){ft=n;return}if(e=e.sibling,e!==null){ft=e;return}ft=e=t}while(e!==null);vt===0&&(vt=5)}function Ls(t,e,n){var r=Ne,i=$n.transition;try{$n.transition=null,Ne=1,VD(t,e,n,r)}finally{$n.transition=i,Ne=r}return null}function VD(t,e,n,r){do ua();while(Li!==null);if(be&6)throw Error(Q(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Q(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(yO(t,s),t===bt&&(ft=bt=null,Ot=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zu||(Zu=!0,x1(th,function(){return ua(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=$n.transition,$n.transition=null;var o=Ne;Ne=1;var a=be;be|=4,J_.current=null,ND(t,n),T1(n,t),rD(Cg),rh=!!Ig,Cg=Ig=null,t.current=n,xD(n),lO(),be=a,Ne=o,$n.transition=s}else t.current=n;if(Zu&&(Zu=!1,Li=t,vh=i),s=t.pendingLanes,s===0&&(Wi=null),dO(n.stateNode),hn(t,at()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(_h)throw _h=!1,t=qg,qg=null,t;return vh&1&&t.tag!==0&&ua(),s=t.pendingLanes,s&1?t===Hg?sc++:(sc=0,Hg=t):sc=0,ms(),null}function ua(){if(Li!==null){var t=cb(vh),e=$n.transition,n=Ne;try{if($n.transition=null,Ne=16>t?16:t,Li===null)var r=!1;else{if(t=Li,Li=null,vh=0,be&6)throw Error(Q(331));var i=be;for(be|=4,ne=t.current;ne!==null;){var s=ne,o=s.child;if(ne.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ne=u;ne!==null;){var d=ne;switch(d.tag){case 0:case 11:case 15:rc(8,d,s)}var f=d.child;if(f!==null)f.return=d,ne=f;else for(;ne!==null;){d=ne;var m=d.sibling,w=d.return;if(w1(d),d===u){ne=null;break}if(m!==null){m.return=w,ne=m;break}ne=w}}}var E=s.alternate;if(E!==null){var v=E.child;if(v!==null){E.child=null;do{var b=v.sibling;v.sibling=null,v=b}while(v!==null)}}ne=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ne=o;else e:for(;ne!==null;){if(s=ne,s.flags&2048)switch(s.tag){case 0:case 11:case 15:rc(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,ne=S;break e}ne=s.return}}var T=t.current;for(ne=T;ne!==null;){o=ne;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,ne=k;else e:for(o=T;ne!==null;){if(a=ne,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Tf(9,a)}}catch(U){nt(a,a.return,U)}if(a===o){ne=null;break e}var L=a.sibling;if(L!==null){L.return=a.return,ne=L;break e}ne=a.return}}if(be=i,ms(),Ir&&typeof Ir.onPostCommitFiberRoot=="function")try{Ir.onPostCommitFiberRoot(mf,t)}catch{}r=!0}return r}finally{Ne=n,$n.transition=e}}return!1}function K0(t,e,n){e=ka(n,e),e=c1(t,e,1),t=zi(t,e,1),e=en(),t!==null&&(ru(t,1,e),hn(t,e))}function nt(t,e,n){if(t.tag===3)K0(t,t,n);else for(;e!==null;){if(e.tag===3){K0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Wi===null||!Wi.has(r))){t=ka(n,t),t=u1(e,t,1),e=zi(e,t,1),t=en(),e!==null&&(ru(e,1,t),hn(e,t));break}}e=e.return}}function FD(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=en(),t.pingedLanes|=t.suspendedLanes&n,bt===t&&(Ot&n)===n&&(vt===4||vt===3&&(Ot&130023424)===Ot&&500>at()-X_?Qs(t,0):Y_|=n),hn(t,e)}function R1(t,e){e===0&&(t.mode&1?(e=zu,zu<<=1,!(zu&130023424)&&(zu=4194304)):e=1);var n=en();t=ni(t,e),t!==null&&(ru(t,e,n),hn(t,n))}function jD(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),R1(t,n)}function UD(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(e),R1(t,n)}var N1;N1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||un.current)ln=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ln=!1,bD(t,e,n);ln=!!(t.flags&131072)}else ln=!1,Je&&e.flags&1048576&&Db(e,uh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;xd(t,e),t=e.pendingProps;var i=Sa(e,qt.current);ca(e,n),i=q_(null,e,r,t,i,n);var s=H_();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,dn(r)?(s=!0,lh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,U_(e),i.updater=Sf,e.stateNode=i,i._reactInternals=e,Og(e,r,t,n),e=Vg(null,e,r,!0,s,n)):(e.tag=0,Je&&s&&M_(e),Jt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(xd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=BD(r),t=Xn(r,t),i){case 0:e=Lg(null,e,r,t,n);break e;case 1:e=F0(null,e,r,t,n);break e;case 11:e=L0(null,e,r,t,n);break e;case 14:e=V0(null,e,r,Xn(r.type,t),n);break e}throw Error(Q(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),Lg(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),F0(t,e,r,i,n);case 3:e:{if(p1(e),t===null)throw Error(Q(387));r=e.pendingProps,s=e.memoizedState,i=s.element,$b(t,e),fh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ka(Error(Q(423)),e),e=j0(t,e,r,n,i);break e}else if(r!==i){i=ka(Error(Q(424)),e),e=j0(t,e,r,n,i);break e}else for(Sn=Bi(e.stateNode.containerInfo.firstChild),Cn=e,Je=!0,er=null,n=jb(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ta(),r===i){e=ri(t,e,n);break e}Jt(t,e,r,n)}e=e.child}return e;case 5:return Bb(e),t===null&&Ng(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,kg(r,i)?o=null:s!==null&&kg(r,s)&&(e.flags|=32),f1(t,e),Jt(t,e,o,n),e.child;case 6:return t===null&&Ng(e),null;case 13:return m1(t,e,n);case 4:return $_(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ia(e,null,r,n):Jt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),L0(t,e,r,i,n);case 7:return Jt(t,e,e.pendingProps,n),e.child;case 8:return Jt(t,e,e.pendingProps.children,n),e.child;case 12:return Jt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Be(dh,r._currentValue),r._currentValue=o,s!==null)if(lr(s.value,o)){if(s.children===i.children&&!un.current){e=ri(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Jr(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),xg(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Q(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),xg(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Jt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ca(e,n),i=qn(i),r=r(i),e.flags|=1,Jt(t,e,r,n),e.child;case 14:return r=e.type,i=Xn(r,e.pendingProps),i=Xn(r.type,i),V0(t,e,r,i,n);case 15:return d1(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),xd(t,e),e.tag=1,dn(r)?(t=!0,lh(e)):t=!1,ca(e,n),l1(e,r,i),Og(e,r,i,n),Vg(null,e,r,!0,t,n);case 19:return g1(t,e,n);case 22:return h1(t,e,n)}throw Error(Q(156,e.tag))};function x1(t,e){return sb(t,e)}function $D(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(t,e,n,r){return new $D(t,e,n,r)}function nv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function BD(t){if(typeof t=="function")return nv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===E_)return 11;if(t===S_)return 14}return 2}function Hi(t,e){var n=t.alternate;return n===null?(n=Vn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Dd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")nv(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case qo:return Js(n.children,i,s,e);case w_:o=8,i|=8;break;case ig:return t=Vn(12,n,e,i|2),t.elementType=ig,t.lanes=s,t;case sg:return t=Vn(13,n,e,i),t.elementType=sg,t.lanes=s,t;case og:return t=Vn(19,n,e,i),t.elementType=og,t.lanes=s,t;case Bk:return Cf(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Uk:o=10;break e;case $k:o=9;break e;case E_:o=11;break e;case S_:o=14;break e;case ki:o=16,r=null;break e}throw Error(Q(130,t==null?t:typeof t,""))}return e=Vn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Js(t,e,n,r){return t=Vn(7,t,r,e),t.lanes=n,t}function Cf(t,e,n,r){return t=Vn(22,t,r,e),t.elementType=Bk,t.lanes=n,t.stateNode={isHidden:!1},t}function dm(t,e,n){return t=Vn(6,t,null,e),t.lanes=n,t}function hm(t,e,n){return e=Vn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function zD(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hp(0),this.expirationTimes=Hp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function rv(t,e,n,r,i,s,o,a,l){return t=new zD(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Vn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},U_(s),t}function WD(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function M1(t){if(!t)return ns;t=t._reactInternals;e:{if(Eo(t)!==t||t.tag!==1)throw Error(Q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(dn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Q(171))}if(t.tag===1){var n=t.type;if(dn(n))return Mb(t,n,e)}return e}function O1(t,e,n,r,i,s,o,a,l){return t=rv(n,r,!0,t,i,s,o,a,l),t.context=M1(null),n=t.current,r=en(),i=qi(n),s=Jr(r,i),s.callback=e??null,zi(n,s,i),t.current.lanes=i,ru(t,i,r),hn(t,r),t}function kf(t,e,n,r){var i=e.current,s=en(),o=qi(i);return n=M1(n),e.context===null?e.context=n:e.pendingContext=n,e=Jr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=zi(i,e,o),t!==null&&(sr(t,i,o,s),Pd(t,i,o)),o}function Eh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Q0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function iv(t,e){Q0(t,e),(t=t.alternate)&&Q0(t,e)}function qD(){return null}var D1=typeof reportError=="function"?reportError:function(t){console.error(t)};function sv(t){this._internalRoot=t}bf.prototype.render=sv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Q(409));kf(t,e,null,null)};bf.prototype.unmount=sv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;so(function(){kf(null,t,null,null)}),e[ti]=null}};function bf(t){this._internalRoot=t}bf.prototype.unstable_scheduleHydration=function(t){if(t){var e=hb();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Pi.length&&e!==0&&e<Pi[n].priority;n++);Pi.splice(n,0,t),n===0&&pb(t)}};function ov(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Af(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function J0(){}function HD(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Eh(o);s.call(u)}}var o=O1(e,r,t,0,null,!1,!1,"",J0);return t._reactRootContainer=o,t[ti]=o.current,bc(t.nodeType===8?t.parentNode:t),so(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Eh(l);a.call(u)}}var l=rv(t,0,!1,null,null,!1,!1,"",J0);return t._reactRootContainer=l,t[ti]=l.current,bc(t.nodeType===8?t.parentNode:t),so(function(){kf(e,l,n,r)}),l}function Pf(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Eh(o);a.call(l)}}kf(e,o,t,i)}else o=HD(n,e,t,i,r);return Eh(o)}ub=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=jl(e.pendingLanes);n!==0&&(C_(e,n|1),hn(e,at()),!(be&6)&&(ba=at()+500,ms()))}break;case 13:so(function(){var r=ni(t,1);if(r!==null){var i=en();sr(r,t,1,i)}}),iv(t,1)}};k_=function(t){if(t.tag===13){var e=ni(t,134217728);if(e!==null){var n=en();sr(e,t,134217728,n)}iv(t,134217728)}};db=function(t){if(t.tag===13){var e=qi(t),n=ni(t,e);if(n!==null){var r=en();sr(n,t,e,r)}iv(t,e)}};hb=function(){return Ne};fb=function(t,e){var n=Ne;try{return Ne=t,e()}finally{Ne=n}};gg=function(t,e,n){switch(e){case"input":if(cg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=vf(r);if(!i)throw Error(Q(90));Wk(r),cg(r,i)}}}break;case"textarea":Hk(t,n);break;case"select":e=n.value,e!=null&&sa(t,!!n.multiple,e,!1)}};Zk=Z_;eb=so;var GD={usingClientEntryPoint:!1,Events:[su,Qo,vf,Yk,Xk,Z_]},Rl={findFiberByHostInstance:Us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KD={bundleType:Rl.bundleType,version:Rl.version,rendererPackageName:Rl.rendererPackageName,rendererConfig:Rl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:di.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=rb(t),t===null?null:t.stateNode},findFiberByHostInstance:Rl.findFiberByHostInstance||qD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ed=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ed.isDisabled&&ed.supportsFiber)try{mf=ed.inject(KD),Ir=ed}catch{}}An.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GD;An.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ov(e))throw Error(Q(200));return WD(t,e,null,n)};An.createRoot=function(t,e){if(!ov(t))throw Error(Q(299));var n=!1,r="",i=D1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=rv(t,1,!1,null,null,n,!1,r,i),t[ti]=e.current,bc(t.nodeType===8?t.parentNode:t),new sv(e)};An.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Q(188)):(t=Object.keys(t).join(","),Error(Q(268,t)));return t=rb(e),t=t===null?null:t.stateNode,t};An.flushSync=function(t){return so(t)};An.hydrate=function(t,e,n){if(!Af(e))throw Error(Q(200));return Pf(null,t,e,!0,n)};An.hydrateRoot=function(t,e,n){if(!ov(t))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=D1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=O1(e,null,t,1,n??null,i,!1,s,o),t[ti]=e.current,bc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new bf(e)};An.render=function(t,e,n){if(!Af(e))throw Error(Q(200));return Pf(null,t,e,!1,n)};An.unmountComponentAtNode=function(t){if(!Af(t))throw Error(Q(40));return t._reactRootContainer?(so(function(){Pf(null,null,t,!1,function(){t._reactRootContainer=null,t[ti]=null})}),!0):!1};An.unstable_batchedUpdates=Z_;An.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Af(n))throw Error(Q(200));if(t==null||t._reactInternals===void 0)throw Error(Q(38));return Pf(t,e,n,!1,r)};An.version="18.3.1-next-f1338f8080-20240426";function L1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(L1)}catch(t){console.error(t)}}L1(),Lk.exports=An;var QD=Lk.exports,Y0=QD;ng.createRoot=Y0.createRoot,ng.hydrateRoot=Y0.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lc(){return Lc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Lc.apply(this,arguments)}var Vi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Vi||(Vi={}));const X0="popstate";function JD(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return Qg("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Sh(i)}return XD(e,n,null,t)}function ct(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function av(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function YD(){return Math.random().toString(36).substr(2,8)}function Z0(t,e){return{usr:t.state,key:t.key,idx:e}}function Qg(t,e,n,r){return n===void 0&&(n=null),Lc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ga(e):e,{state:n,key:e&&e.key||r||YD()})}function Sh(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ga(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function XD(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=Vi.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(Lc({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){a=Vi.Pop;let b=d(),S=b==null?null:b-u;u=b,l&&l({action:a,location:v.location,delta:S})}function m(b,S){a=Vi.Push;let T=Qg(v.location,b,S);u=d()+1;let k=Z0(T,u),L=v.createHref(T);try{o.pushState(k,"",L)}catch(U){if(U instanceof DOMException&&U.name==="DataCloneError")throw U;i.location.assign(L)}s&&l&&l({action:a,location:v.location,delta:1})}function w(b,S){a=Vi.Replace;let T=Qg(v.location,b,S);u=d();let k=Z0(T,u),L=v.createHref(T);o.replaceState(k,"",L),s&&l&&l({action:a,location:v.location,delta:0})}function E(b){let S=i.location.origin!=="null"?i.location.origin:i.location.href,T=typeof b=="string"?b:Sh(b);return T=T.replace(/ $/,"%20"),ct(S,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,S)}let v={get action(){return a},get location(){return t(i,o)},listen(b){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(X0,f),l=b,()=>{i.removeEventListener(X0,f),l=null}},createHref(b){return e(i,b)},createURL:E,encodeLocation(b){let S=E(b);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:w,go(b){return o.go(b)}};return v}var eS;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(eS||(eS={}));function ZD(t,e,n){return n===void 0&&(n="/"),eL(t,e,n)}function eL(t,e,n,r){let i=typeof e=="string"?Ga(e):e,s=lv(i.pathname||"/",n);if(s==null)return null;let o=V1(t);tL(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=fL(s);a=uL(o[l],u)}return a}function V1(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(ct(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Gi([r,l.relativePath]),d=n.concat(l);s.children&&s.children.length>0&&(ct(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),V1(s.children,e,d,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:lL(u,s.index),routesMeta:d})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of F1(s.path))i(s,o,l)}),e}function F1(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=F1(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function tL(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:cL(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const nL=/^:[\w-]+$/,rL=3,iL=2,sL=1,oL=10,aL=-2,tS=t=>t==="*";function lL(t,e){let n=t.split("/"),r=n.length;return n.some(tS)&&(r+=aL),e&&(r+=iL),n.filter(i=>!tS(i)).reduce((i,s)=>i+(nL.test(s)?rL:s===""?sL:oL),r)}function cL(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function uL(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,d=s==="/"?e:e.slice(s.length)||"/",f=dL({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),m=l.route;if(!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:Gi([s,f.pathname]),pathnameBase:_L(Gi([s,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(s=Gi([s,f.pathnameBase]))}return o}function dL(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=hL(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((u,d,f)=>{let{paramName:m,isOptional:w}=d;if(m==="*"){let v=a[f]||"";o=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const E=a[f];return w&&!E?u[m]=void 0:u[m]=(E||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function hL(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),av(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function fL(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return av(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function lv(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const pL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mL=t=>pL.test(t);function gL(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Ga(t):t,s;if(n)if(mL(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),av(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?s=nS(n.substring(1),"/"):s=nS(n,e)}else s=e;return{pathname:s,search:vL(r),hash:wL(i)}}function nS(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function fm(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function yL(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function cv(t,e){let n=yL(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function uv(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Ga(t):(i=Lc({},t),ct(!i.pathname||!i.pathname.includes("?"),fm("?","pathname","search",i)),ct(!i.pathname||!i.pathname.includes("#"),fm("#","pathname","hash",i)),ct(!i.search||!i.search.includes("#"),fm("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;i.pathname=m.join("/")}a=f>=0?e[f]:"/"}let l=gL(i,a),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const Gi=t=>t.join("/").replace(/\/\/+/g,"/"),_L=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),vL=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,wL=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function EL(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const j1=["post","put","patch","delete"];new Set(j1);const SL=["get",...j1];new Set(SL);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vc(){return Vc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Vc.apply(this,arguments)}const dv=q.createContext(null),TL=q.createContext(null),gs=q.createContext(null),Rf=q.createContext(null),ys=q.createContext({outlet:null,matches:[],isDataRoute:!1}),U1=q.createContext(null);function IL(t,e){let{relative:n}=e===void 0?{}:e;Ka()||ct(!1);let{basename:r,navigator:i}=q.useContext(gs),{hash:s,pathname:o,search:a}=B1(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:Gi([r,o])),i.createHref({pathname:l,search:a,hash:s})}function Ka(){return q.useContext(Rf)!=null}function Qa(){return Ka()||ct(!1),q.useContext(Rf).location}function $1(t){q.useContext(gs).static||q.useLayoutEffect(t)}function Nf(){let{isDataRoute:t}=q.useContext(ys);return t?VL():CL()}function CL(){Ka()||ct(!1);let t=q.useContext(dv),{basename:e,future:n,navigator:r}=q.useContext(gs),{matches:i}=q.useContext(ys),{pathname:s}=Qa(),o=JSON.stringify(cv(i,n.v7_relativeSplatPath)),a=q.useRef(!1);return $1(()=>{a.current=!0}),q.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let f=uv(u,JSON.parse(o),s,d.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Gi([e,f.pathname])),(d.replace?r.replace:r.push)(f,d.state,d)},[e,r,o,s,t])}function B1(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=q.useContext(gs),{matches:i}=q.useContext(ys),{pathname:s}=Qa(),o=JSON.stringify(cv(i,r.v7_relativeSplatPath));return q.useMemo(()=>uv(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function kL(t,e){return bL(t,e)}function bL(t,e,n,r){Ka()||ct(!1);let{navigator:i}=q.useContext(gs),{matches:s}=q.useContext(ys),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Qa(),d;if(e){var f;let b=typeof e=="string"?Ga(e):e;l==="/"||(f=b.pathname)!=null&&f.startsWith(l)||ct(!1),d=b}else d=u;let m=d.pathname||"/",w=m;if(l!=="/"){let b=l.replace(/^\//,"").split("/");w="/"+m.replace(/^\//,"").split("/").slice(b.length).join("/")}let E=ZD(t,{pathname:w}),v=xL(E&&E.map(b=>Object.assign({},b,{params:Object.assign({},a,b.params),pathname:Gi([l,i.encodeLocation?i.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?l:Gi([l,i.encodeLocation?i.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),s,n,r);return e&&v?q.createElement(Rf.Provider,{value:{location:Vc({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Vi.Pop}},v):v}function AL(){let t=LL(),e=EL(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},e),n?q.createElement("pre",{style:i},n):null,null)}const PL=q.createElement(AL,null);class RL extends q.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?q.createElement(ys.Provider,{value:this.props.routeContext},q.createElement(U1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function NL(t){let{routeContext:e,match:n,children:r}=t,i=q.useContext(dv);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),q.createElement(ys.Provider,{value:e},r)}function xL(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let d=o.findIndex(f=>f.route.id&&(a==null?void 0:a[f.route.id])!==void 0);d>=0||ct(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:m,errors:w}=n,E=f.route.loader&&m[f.route.id]===void 0&&(!w||w[f.route.id]===void 0);if(f.route.lazy||E){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,m)=>{let w,E=!1,v=null,b=null;n&&(w=a&&f.route.id?a[f.route.id]:void 0,v=f.route.errorElement||PL,l&&(u<0&&m===0?(FL("route-fallback"),E=!0,b=null):u===m&&(E=!0,b=f.route.hydrateFallbackElement||null)));let S=e.concat(o.slice(0,m+1)),T=()=>{let k;return w?k=v:E?k=b:f.route.Component?k=q.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=d,q.createElement(NL,{match:f,routeContext:{outlet:d,matches:S,isDataRoute:n!=null},children:k})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?q.createElement(RL,{location:n.location,revalidation:n.revalidation,component:v,error:w,children:T(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):T()},null)}var z1=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(z1||{}),W1=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(W1||{});function ML(t){let e=q.useContext(dv);return e||ct(!1),e}function OL(t){let e=q.useContext(TL);return e||ct(!1),e}function DL(t){let e=q.useContext(ys);return e||ct(!1),e}function q1(t){let e=DL(),n=e.matches[e.matches.length-1];return n.route.id||ct(!1),n.route.id}function LL(){var t;let e=q.useContext(U1),n=OL(),r=q1();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function VL(){let{router:t}=ML(z1.UseNavigateStable),e=q1(W1.UseNavigateStable),n=q.useRef(!1);return $1(()=>{n.current=!0}),q.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Vc({fromRouteId:e},s)))},[t,e])}const rS={};function FL(t,e,n){rS[t]||(rS[t]=!0)}function jL(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Th(t){let{to:e,replace:n,state:r,relative:i}=t;Ka()||ct(!1);let{future:s,static:o}=q.useContext(gs),{matches:a}=q.useContext(ys),{pathname:l}=Qa(),u=Nf(),d=uv(e,cv(a,s.v7_relativeSplatPath),l,i==="path"),f=JSON.stringify(d);return q.useEffect(()=>u(JSON.parse(f),{replace:n,state:r,relative:i}),[u,f,i,n,r]),null}function $l(t){ct(!1)}function UL(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Vi.Pop,navigator:s,static:o=!1,future:a}=t;Ka()&&ct(!1);let l=e.replace(/^\/*/,"/"),u=q.useMemo(()=>({basename:l,navigator:s,static:o,future:Vc({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=Ga(r));let{pathname:d="/",search:f="",hash:m="",state:w=null,key:E="default"}=r,v=q.useMemo(()=>{let b=lv(d,l);return b==null?null:{location:{pathname:b,search:f,hash:m,state:w,key:E},navigationType:i}},[l,d,f,m,w,E,i]);return v==null?null:q.createElement(gs.Provider,{value:u},q.createElement(Rf.Provider,{children:n,value:v}))}function $L(t){let{children:e,location:n}=t;return kL(Jg(e),n)}new Promise(()=>{});function Jg(t,e){e===void 0&&(e=[]);let n=[];return q.Children.forEach(t,(r,i)=>{if(!q.isValidElement(r))return;let s=[...e,i];if(r.type===q.Fragment){n.push.apply(n,Jg(r.props.children,s));return}r.type!==$l&&ct(!1),!r.props.index||!r.props.children||ct(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Jg(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yg(){return Yg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Yg.apply(this,arguments)}function BL(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function zL(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function WL(t,e){return t.button===0&&(!e||e==="_self")&&!zL(t)}const qL=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],HL="6";try{window.__reactRouterVersion=HL}catch{}const GL="startTransition",iS=FM[GL];function KL(t){let{basename:e,children:n,future:r,window:i}=t,s=q.useRef();s.current==null&&(s.current=JD({window:i,v5Compat:!0}));let o=s.current,[a,l]=q.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=q.useCallback(f=>{u&&iS?iS(()=>l(f)):l(f)},[l,u]);return q.useLayoutEffect(()=>o.listen(d),[o,d]),q.useEffect(()=>jL(r),[r]),q.createElement(UL,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const QL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",JL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,YL=q.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:d,viewTransition:f}=e,m=BL(e,qL),{basename:w}=q.useContext(gs),E,v=!1;if(typeof u=="string"&&JL.test(u)&&(E=u,QL))try{let k=new URL(window.location.href),L=u.startsWith("//")?new URL(k.protocol+u):new URL(u),U=lv(L.pathname,w);L.origin===k.origin&&U!=null?u=U+L.search+L.hash:v=!0}catch{}let b=IL(u,{relative:i}),S=XL(u,{replace:o,state:a,target:l,preventScrollReset:d,relative:i,viewTransition:f});function T(k){r&&r(k),k.defaultPrevented||S(k)}return q.createElement("a",Yg({},m,{href:E||b,onClick:v||s?r:T,ref:n,target:l}))});var sS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(sS||(sS={}));var oS;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(oS||(oS={}));function XL(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=Nf(),u=Qa(),d=B1(t,{relative:o});return q.useCallback(f=>{if(WL(f,n)){f.preventDefault();let m=r!==void 0?r:Sh(u)===Sh(d);l(t,{replace:m,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,d,r,i,n,t,s,o,a])}const ZL=()=>{};var aS={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y=function(t,e){if(!t)throw Ja(e)},Ja=function(t){return new Error("Firebase Database ("+H1.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},e2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},hv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,d=s>>2,f=(s&3)<<4|a>>4;let m=(a&15)<<2|u>>6,w=u&63;l||(w=64,o||(m=64)),r.push(n[d],n[f],n[m],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(G1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):e2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||f==null)throw new t2;const m=s<<2|a>>4;if(r.push(m),u!==64){const w=a<<4&240|u>>2;if(r.push(w),f!==64){const E=u<<6&192|f;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class t2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const K1=function(t){const e=G1(t);return hv.encodeByteArray(e,!0)},Ih=function(t){return K1(t).replace(/\./g,"")},Ch=function(t){try{return hv.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n2(t){return Q1(void 0,t)}function Q1(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!r2(n)||(t[n]=Q1(t[n],e[n]));return t}function r2(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2=()=>i2().__FIREBASE_DEFAULTS__,o2=()=>{if(typeof process>"u"||typeof aS>"u")return;const t=aS.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},a2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ch(t[1]);return e&&JSON.parse(e)},xf=()=>{try{return ZL()||s2()||o2()||a2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},J1=t=>{var e,n;return(n=(e=xf())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Y1=t=>{const e=J1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},X1=()=>{var t;return(t=xf())==null?void 0:t.config},Z1=t=>{var e;return(e=xf())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _s(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function fv(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eA(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Ih(JSON.stringify(n)),Ih(JSON.stringify(o)),""].join(".")}const oc={};function l2(){const t={prod:[],emulator:[]};for(const e of Object.keys(oc))oc[e]?t.emulator.push(e):t.prod.push(e);return t}function c2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let lS=!1;function pv(t,e){if(typeof window>"u"||typeof document>"u"||!_s(window.location.host)||oc[t]===e||oc[t]||lS)return;oc[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=l2().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,w){m.setAttribute("width","24"),m.setAttribute("id",w),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function u(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{lS=!0,o()},m}function d(m,w){m.setAttribute("id",w),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=c2(r),w=n("text"),E=document.getElementById(w)||document.createElement("span"),v=n("learnmore"),b=document.getElementById(v)||document.createElement("a"),S=n("preprendIcon"),T=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const k=m.element;a(k),d(b,v);const L=u();l(T,S),k.append(T,E,b,L),document.body.appendChild(k)}s?(E.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function mv(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ht())}function u2(){var e;const t=(e=xf())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function d2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function tA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function nA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function h2(){const t=Ht();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function f2(){return H1.NODE_ADMIN===!0}function p2(){return!u2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rA(){try{return typeof indexedDB=="object"}catch{return!1}}function iA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}function m2(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2="FirebaseError";class fr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=g2,Object.setPrototypeOf(this,fr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,So.prototype.create)}}class So{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?y2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new fr(i,a,r)}}function y2(t,e){return t.replace(_2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const _2=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(t){return JSON.parse(t)}function Nt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA=function(t){let e={},n={},r={},i="";try{const s=t.split(".");e=Fc(Ch(s[0])||""),n=Fc(Ch(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}},v2=function(t){const e=sA(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},w2=function(t){const e=sA(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Aa(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function kh(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function bh(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function ii(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(cS(s)&&cS(o)){if(!ii(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function cS(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ya(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Bl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function zl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)r[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)r[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const m=r[f-3]^r[f-8]^r[f-14]^r[f-16];r[f]=(m<<1|m>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],u,d;for(let f=0;f<80;f++){f<40?f<20?(u=a^s&(o^a),d=1518500249):(u=s^o^a,d=1859775393):f<60?(u=s&o|a&(s|o),d=2400959708):(u=s^o^a,d=3395469782);const m=(i<<5|i>>>27)+u+l+d+r[f]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=m}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function S2(t,e){const n=new T2(t,e);return n.subscribe.bind(n)}class T2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");I2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=pm),i.error===void 0&&(i.error=pm),i.complete===void 0&&(i.complete=pm);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function I2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function pm(){}function Pa(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,Y(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Mf=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2=1e3,b2=2,A2=4*60*60*1e3,P2=.5;function uS(t,e=k2,n=b2){const r=e*Math.pow(n,t),i=Math.round(P2*r*(Math.random()-.5)*2);return Math.min(A2,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(t){return t&&t._delegate?t._delegate:t}class Gn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Br;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(x2(e))try{this.getOrInitializeService({instanceIdentifier:Vs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Vs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vs){return this.instances.has(e)}getOptions(e=Vs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:N2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Vs){return this.component?this.component.multipleInstances?e:Vs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function N2(t){return t===Vs?void 0:t}function x2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new R2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ge;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ge||(ge={}));const O2={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},D2=ge.INFO,L2={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},V2=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=L2[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class au{constructor(e){this.name=e,this._logLevel=D2,this._logHandler=V2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?O2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}}const F2=(t,e)=>e.some(n=>t instanceof n);let dS,hS;function j2(){return dS||(dS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function U2(){return hS||(hS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oA=new WeakMap,Xg=new WeakMap,aA=new WeakMap,mm=new WeakMap,gv=new WeakMap;function $2(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ki(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&oA.set(n,t)}).catch(()=>{}),gv.set(e,t),e}function B2(t){if(Xg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Xg.set(t,e)}let Zg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Xg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||aA.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ki(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function z2(t){Zg=t(Zg)}function W2(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(gm(this),e,...n);return aA.set(r,e.sort?e.sort():[e]),Ki(r)}:U2().includes(t)?function(...e){return t.apply(gm(this),e),Ki(oA.get(this))}:function(...e){return Ki(t.apply(gm(this),e))}}function q2(t){return typeof t=="function"?W2(t):(t instanceof IDBTransaction&&B2(t),F2(t,j2())?new Proxy(t,Zg):t)}function Ki(t){if(t instanceof IDBRequest)return $2(t);if(mm.has(t))return mm.get(t);const e=q2(t);return e!==t&&(mm.set(t,e),gv.set(e,t)),e}const gm=t=>gv.get(t);function lA(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Ki(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ki(o.result),l.oldVersion,l.newVersion,Ki(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const H2=["get","getKey","getAll","getAllKeys","count"],G2=["put","add","delete","clear"],ym=new Map;function fS(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ym.get(e))return ym.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=G2.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||H2.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return ym.set(e,s),s}z2(t=>({...t,get:(e,n,r)=>fS(e,n)||t.get(e,n,r),has:(e,n)=>!!fS(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Q2(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Q2(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ey="@firebase/app",pS="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=new au("@firebase/app"),J2="@firebase/app-compat",Y2="@firebase/analytics-compat",X2="@firebase/analytics",Z2="@firebase/app-check-compat",eV="@firebase/app-check",tV="@firebase/auth",nV="@firebase/auth-compat",rV="@firebase/database",iV="@firebase/data-connect",sV="@firebase/database-compat",oV="@firebase/functions",aV="@firebase/functions-compat",lV="@firebase/installations",cV="@firebase/installations-compat",uV="@firebase/messaging",dV="@firebase/messaging-compat",hV="@firebase/performance",fV="@firebase/performance-compat",pV="@firebase/remote-config",mV="@firebase/remote-config-compat",gV="@firebase/storage",yV="@firebase/storage-compat",_V="@firebase/firestore",vV="@firebase/ai",wV="@firebase/firestore-compat",EV="firebase",SV="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="[DEFAULT]",TV={[ey]:"fire-core",[J2]:"fire-core-compat",[X2]:"fire-analytics",[Y2]:"fire-analytics-compat",[eV]:"fire-app-check",[Z2]:"fire-app-check-compat",[tV]:"fire-auth",[nV]:"fire-auth-compat",[rV]:"fire-rtdb",[iV]:"fire-data-connect",[sV]:"fire-rtdb-compat",[oV]:"fire-fn",[aV]:"fire-fn-compat",[lV]:"fire-iid",[cV]:"fire-iid-compat",[uV]:"fire-fcm",[dV]:"fire-fcm-compat",[hV]:"fire-perf",[fV]:"fire-perf-compat",[pV]:"fire-rc",[mV]:"fire-rc-compat",[gV]:"fire-gcs",[yV]:"fire-gcs-compat",[_V]:"fire-fst",[wV]:"fire-fst-compat",[vV]:"fire-vertex","fire-js":"fire-js",[EV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=new Map,IV=new Map,ny=new Map;function mS(t,e){try{t.container.addComponent(e)}catch(n){si.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function cr(t){const e=t.name;if(ny.has(e))return si.debug(`There were multiple attempts to register component ${e}.`),!1;ny.set(e,t);for(const n of Ah.values())mS(n,t);for(const n of IV.values())mS(n,t);return!0}function vs(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function En(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qi=new So("app","Firebase",CV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Gn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=SV;function yv(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:ty,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Qi.create("bad-app-name",{appName:String(i)});if(n||(n=X1()),!n)throw Qi.create("no-options");const s=Ah.get(i);if(s){if(ii(n,s.options)&&ii(r,s.config))return s;throw Qi.create("duplicate-app",{appName:i})}const o=new M2(i);for(const l of ny.values())o.addComponent(l);const a=new kV(n,r,o);return Ah.set(i,a),a}function Of(t=ty){const e=Ah.get(t);if(!e&&t===ty&&X1())return yv();if(!e)throw Qi.create("no-app",{appName:t});return e}function fn(t,e,n){let r=TV[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),si.warn(o.join(" "));return}cr(new Gn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bV="firebase-heartbeat-database",AV=1,jc="firebase-heartbeat-store";let _m=null;function cA(){return _m||(_m=lA(bV,AV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Qi.create("idb-open",{originalErrorMessage:t.message})})),_m}async function PV(t){try{const n=(await cA()).transaction(jc),r=await n.objectStore(jc).get(uA(t));return await n.done,r}catch(e){if(e instanceof fr)si.warn(e.message);else{const n=Qi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});si.warn(n.message)}}}async function gS(t,e){try{const r=(await cA()).transaction(jc,"readwrite");await r.objectStore(jc).put(e,uA(t)),await r.done}catch(n){if(n instanceof fr)si.warn(n.message);else{const r=Qi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});si.warn(r.message)}}}function uA(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RV=1024,NV=30;class xV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new OV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=yS();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>NV){const o=DV(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){si.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=yS(),{heartbeatsToSend:r,unsentEntries:i}=MV(this._heartbeatsCache.heartbeats),s=Ih(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return si.warn(n),""}}}function yS(){return new Date().toISOString().substring(0,10)}function MV(t,e=RV){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),_S(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),_S(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class OV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rA()?iA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await PV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function _S(t){return Ih(JSON.stringify({version:2,heartbeats:t})).length}function DV(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LV(t){cr(new Gn("platform-logger",e=>new K2(e),"PRIVATE")),cr(new Gn("heartbeat",e=>new xV(e),"PRIVATE")),fn(ey,pS,t),fn(ey,pS,"esm2020"),fn("fire-js","")}LV("");function dA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const VV=dA,hA=new So("auth","Firebase",dA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph=new au("@firebase/auth");function FV(t,...e){Ph.logLevel<=ge.WARN&&Ph.warn(`Auth (${To}): ${t}`,...e)}function Ld(t,...e){Ph.logLevel<=ge.ERROR&&Ph.error(`Auth (${To}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(t,...e){throw _v(t,...e)}function kr(t,...e){return _v(t,...e)}function fA(t,e,n){const r={...VV(),[e]:n};return new So("auth","Firebase",r).create(e,{appName:t.name})}function Yr(t){return fA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _v(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return hA.create(t,...e)}function oe(t,e,...n){if(!t)throw _v(e,...n)}function qr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ld(e),new Error(e)}function oi(t,e){t||qr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ry(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function jV(){return vS()==="http:"||vS()==="https:"}function vS(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(jV()||tA()||"connection"in navigator)?navigator.onLine:!0}function $V(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,n){this.shortDelay=e,this.longDelay=n,oi(n>e,"Short delay should be less than long delay!"),this.isMobile=mv()||nA()}get(){return UV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vv(t,e){oi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],WV=new lu(3e4,6e4);function ws(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Es(t,e,n,r,i={}){return mA(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Ya({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return d2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&_s(t.emulatorConfig.host)&&(u.credentials="include"),pA.fetch()(await gA(t,t.config.apiHost,n,a),u)})}async function mA(t,e,n){t._canInitEmulator=!1;const r={...BV,...e};try{const i=new HV(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw td(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw td(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw td(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw td(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw fA(t,d,u);ur(t,d)}}catch(i){if(i instanceof fr)throw i;ur(t,"network-request-failed",{message:String(i)})}}async function cu(t,e,n,r,i={}){const s=await Es(t,e,n,r,i);return"mfaPendingCredential"in s&&ur(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function gA(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?vv(t.config,i):`${t.config.apiScheme}://${i}`;return zV.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function qV(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class HV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(kr(this.auth,"network-request-failed")),WV.get())})}}function td(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=kr(t,e,r);return i.customData._tokenResponse=n,i}function wS(t){return t!==void 0&&t.enterprise!==void 0}class GV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return qV(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function KV(t,e){return Es(t,"GET","/v2/recaptchaConfig",ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QV(t,e){return Es(t,"POST","/v1/accounts:delete",e)}async function Rh(t,e){return Es(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ac(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JV(t,e=!1){const n=Me(t),r=await n.getIdToken(e),i=wv(r);oe(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:ac(vm(i.auth_time)),issuedAtTime:ac(vm(i.iat)),expirationTime:ac(vm(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function vm(t){return Number(t)*1e3}function wv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ld("JWT malformed, contained fewer than 3 sections"),null;try{const i=Ch(n);return i?JSON.parse(i):(Ld("Failed to decode base64 JWT payload"),null)}catch(i){return Ld("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function ES(t){const e=wv(t);return oe(e,"internal-error"),oe(typeof e.exp<"u","internal-error"),oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof fr&&YV(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function YV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ac(this.lastLoginAt),this.creationTime=ac(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nh(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Uc(t,Rh(e,{idToken:n}));oe(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(f=i.providerUserInfo)!=null&&f.length?yA(i.providerUserInfo):[],o=eF(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new iy(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function ZV(t){const e=Me(t);await Nh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function eF(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function yA(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tF(t,e){const n=await mA(t,{},async()=>{const r=Ya({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await gA(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&_s(t.emulatorConfig.host)&&(l.credentials="include"),pA.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function nF(t,e){return Es(t,"POST","/v2/accounts:revokeToken",ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){oe(e.idToken,"internal-error"),oe(typeof e.idToken<"u","internal-error"),oe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ES(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){oe(e.length!==0,"internal-error");const n=ES(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await tF(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new da;return r&&(oe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(oe(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(oe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new da,this.toJSON())}_performRefresh(){return qr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Si(t,e){oe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class nr{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new XV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new iy(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Uc(this,this.stsTokenManager.getToken(this.auth,e));return oe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return JV(this,e)}reload(){return ZV(this)}_assign(e){this!==e&&(oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new nr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Nh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(En(this.auth.app))return Promise.reject(Yr(this.auth));const e=await this.getIdToken();return await Uc(this,QV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,d=n.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:w,providerData:E,stsTokenManager:v}=n;oe(f&&v,e,"internal-error");const b=da.fromJSON(this.name,v);oe(typeof f=="string",e,"internal-error"),Si(r,e.name),Si(i,e.name),oe(typeof m=="boolean",e,"internal-error"),oe(typeof w=="boolean",e,"internal-error"),Si(s,e.name),Si(o,e.name),Si(a,e.name),Si(l,e.name),Si(u,e.name),Si(d,e.name);const S=new nr({uid:f,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:w,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:b,createdAt:u,lastLoginAt:d});return E&&Array.isArray(E)&&(S.providerData=E.map(T=>({...T}))),l&&(S._redirectEventId=l),S}static async _fromIdTokenResponse(e,n,r=!1){const i=new da;i.updateFromServerResponse(n);const s=new nr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Nh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];oe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?yA(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new da;a.updateFromIdToken(r);const l=new nr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new iy(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SS=new Map;function Hr(t){oi(t instanceof Function,"Expected a class definition");let e=SS.get(t);return e?(oi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,SS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}_A.type="NONE";const TS=_A;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(t,e,n){return`firebase:${t}:${e}:${n}`}class ha{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Vd(this.userKey,i.apiKey,s),this.fullPersistenceKey=Vd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Rh(this.auth,{idToken:e}).catch(()=>{});return n?nr._fromGetAccountInfoResponse(this.auth,n,e):null}return nr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ha(Hr(TS),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Hr(TS);const o=Vd(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const d=await u._get(o);if(d){let f;if(typeof d=="string"){const m=await Rh(e,{idToken:d}).catch(()=>{});if(!m)break;f=await nr._fromGetAccountInfoResponse(e,m,d)}else f=nr._fromJSON(e,d);u!==s&&(a=f),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new ha(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new ha(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(SA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IA(e))return"Blackberry";if(CA(e))return"Webos";if(wA(e))return"Safari";if((e.includes("chrome/")||EA(e))&&!e.includes("edge/"))return"Chrome";if(TA(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function vA(t=Ht()){return/firefox\//i.test(t)}function wA(t=Ht()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function EA(t=Ht()){return/crios\//i.test(t)}function SA(t=Ht()){return/iemobile/i.test(t)}function TA(t=Ht()){return/android/i.test(t)}function IA(t=Ht()){return/blackberry/i.test(t)}function CA(t=Ht()){return/webos/i.test(t)}function Ev(t=Ht()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function rF(t=Ht()){var e;return Ev(t)&&!!((e=window.navigator)!=null&&e.standalone)}function iF(){return h2()&&document.documentMode===10}function kA(t=Ht()){return Ev(t)||TA(t)||CA(t)||IA(t)||/windows phone/i.test(t)||SA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(t,e=[]){let n;switch(t){case"Browser":n=IS(Ht());break;case"Worker":n=`${IS(Ht())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${To}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oF(t,e={}){return Es(t,"GET","/v2/passwordPolicy",ws(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aF=6;class lF{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??aF,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cF{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new CS(this),this.idTokenSubscription=new CS(this),this.beforeStateQueue=new sF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await ha.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Rh(this,{idToken:e}),r=await nr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(En(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Nh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$V()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(En(this.app))return Promise.reject(Yr(this));const n=e?Me(e):null;return n&&oe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return En(this.app)?Promise.reject(Yr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return En(this.app)?Promise.reject(Yr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Hr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await oF(this),n=new lF(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new So("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await nF(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hr(e)||this._popupRedirectResolver;oe(n,this,"argument-error"),this.redirectPersistenceManager=await ha.create(this,[Hr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(oe(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(En(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&FV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Io(t){return Me(t)}class CS{constructor(e){this.auth=e,this.observer=null,this.addObserver=S2(n=>this.observer=n)}get next(){return oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Df={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uF(t){Df=t}function AA(t){return Df.loadJS(t)}function dF(){return Df.recaptchaEnterpriseScript}function hF(){return Df.gapiScript}function fF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class pF{constructor(){this.enterprise=new mF}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class mF{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const gF="recaptcha-enterprise",PA="NO_RECAPTCHA";class yF{constructor(e){this.type=gF,this.auth=Io(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{KV(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new GV(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;wS(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(PA)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new pF().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&wS(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=dF();l.length!==0&&(l+=a),AA(l).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function kS(t,e,n,r=!1,i=!1){const s=new yF(t);let o;if(i)o=PA;else try{o=await s.verify(n)}catch{o=await s.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function sy(t,e,n,r,i){var s;if((s=t._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await kS(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await kS(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _F(t,e){const n=vs(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(ii(s,e??{}))return i;ur(i,"already-initialized")}return n.initialize({options:e})}function vF(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Hr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function wF(t,e,n){const r=Io(t);oe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=RA(e),{host:o,port:a}=EF(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){oe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),oe(ii(u,r.config.emulator)&&ii(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,_s(o)?(fv(`${s}//${o}${l}`),pv("Auth",!0)):SF()}function RA(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function EF(t){const e=RA(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:bS(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:bS(o)}}}function bS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function SF(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return qr("not implemented")}_getIdTokenResponse(e){return qr("not implemented")}_linkToIdToken(e,n){return qr("not implemented")}_getReauthenticationResolver(e){return qr("not implemented")}}async function TF(t,e){return Es(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IF(t,e){return cu(t,"POST","/v1/accounts:signInWithPassword",ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CF(t,e){return cu(t,"POST","/v1/accounts:signInWithEmailLink",ws(t,e))}async function kF(t,e){return cu(t,"POST","/v1/accounts:signInWithEmailLink",ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c extends Sv{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new $c(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new $c(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sy(e,n,"signInWithPassword",IF);case"emailLink":return CF(e,{email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sy(e,r,"signUpPassword",TF);case"emailLink":return kF(e,{idToken:n,email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fa(t,e){return cu(t,"POST","/v1/accounts:signInWithIdp",ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bF="http://localhost";class oo extends Sv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new oo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ur("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new oo(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return fa(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,fa(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,fa(e,n)}buildRequest(){const e={requestUri:bF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ya(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AF(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function PF(t){const e=Bl(zl(t)).link,n=e?Bl(zl(e)).deep_link_id:null,r=Bl(zl(t)).deep_link_id;return(r?Bl(zl(r)).link:null)||r||n||e||t}class Tv{constructor(e){const n=Bl(zl(e)),r=n.apiKey??null,i=n.oobCode??null,s=AF(n.mode??null);oe(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=PF(e);try{return new Tv(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(){this.providerId=Xa.PROVIDER_ID}static credential(e,n){return $c._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Tv.parseLink(n);return oe(r,"argument-error"),$c._fromEmailAndCode(e,r.code,r.tenantId)}}Xa.PROVIDER_ID="password";Xa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Xa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu extends NA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends uu{constructor(){super("facebook.com")}static credential(e){return oo._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ni.credential(e.oauthAccessToken)}catch{return null}}}Ni.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ni.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends uu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return oo._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return xi.credential(n,r)}catch{return null}}}xi.GOOGLE_SIGN_IN_METHOD="google.com";xi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi extends uu{constructor(){super("github.com")}static credential(e){return oo._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mi.credential(e.oauthAccessToken)}catch{return null}}}Mi.GITHUB_SIGN_IN_METHOD="github.com";Mi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi extends uu{constructor(){super("twitter.com")}static credential(e,n){return oo._fromParams({providerId:Oi.PROVIDER_ID,signInMethod:Oi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Oi.credentialFromTaggedObject(e)}static credentialFromError(e){return Oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Oi.credential(n,r)}catch{return null}}}Oi.TWITTER_SIGN_IN_METHOD="twitter.com";Oi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RF(t,e){return cu(t,"POST","/v1/accounts:signUp",ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await nr._fromIdTokenResponse(e,r,i),o=AS(r);return new ao({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=AS(r);return new ao({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function AS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh extends fr{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,xh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new xh(e,n,r,i)}}function xA(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?xh._fromErrorAndOperation(t,s,e,r):s})}async function NF(t,e,n=!1){const r=await Uc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ao._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xF(t,e,n=!1){const{auth:r}=t;if(En(r.app))return Promise.reject(Yr(r));const i="reauthenticate";try{const s=await Uc(t,xA(r,i,e,t),n);oe(s.idToken,r,"internal-error");const o=wv(s.idToken);oe(o,r,"internal-error");const{sub:a}=o;return oe(t.uid===a,r,"user-mismatch"),ao._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ur(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MA(t,e,n=!1){if(En(t.app))return Promise.reject(Yr(t));const r="signIn",i=await xA(t,r,e),s=await ao._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function MF(t,e){return MA(Io(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OA(t){const e=Io(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function DA(t,e,n){if(En(t.app))return Promise.reject(Yr(t));const r=Io(t),o=await sy(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",RF).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&OA(t),l}),a=await ao._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function OF(t,e,n){return En(t.app)?Promise.reject(Yr(t)):MF(Me(t),Xa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&OA(t),r})}function DF(t,e,n,r){return Me(t).onIdTokenChanged(e,n,r)}function LF(t,e,n){return Me(t).beforeAuthStateChanged(e,n)}function VF(t,e,n,r){return Me(t).onAuthStateChanged(e,n,r)}function FF(t){return Me(t).signOut()}const Mh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Mh,"1"),this.storage.removeItem(Mh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF=1e3,UF=10;class VA extends LA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);iF()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,UF):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},jF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}VA.type="LOCAL";const $F=VA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA extends LA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}FA.type="SESSION";const jA=FA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Lf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await BF(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Lf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=Iv("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(){return window}function WF(t){br().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(){return typeof br().WorkerGlobalScope<"u"&&typeof br().importScripts=="function"}async function qF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function HF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function GF(){return UA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A="firebaseLocalStorageDb",KF=1,Oh="firebaseLocalStorage",BA="fbase_key";class du{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Vf(t,e){return t.transaction([Oh],e?"readwrite":"readonly").objectStore(Oh)}function QF(){const t=indexedDB.deleteDatabase($A);return new du(t).toPromise()}function oy(){const t=indexedDB.open($A,KF);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Oh,{keyPath:BA})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Oh)?e(r):(r.close(),await QF(),e(await oy()))})})}async function PS(t,e,n){const r=Vf(t,!0).put({[BA]:e,value:n});return new du(r).toPromise()}async function JF(t,e){const n=Vf(t,!1).get(e),r=await new du(n).toPromise();return r===void 0?null:r.value}function RS(t,e){const n=Vf(t,!0).delete(e);return new du(n).toPromise()}const YF=800,XF=3;class zA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await oy(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>XF)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return UA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Lf._getInstance(GF()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await qF(),!this.activeServiceWorker)return;this.sender=new zF(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||HF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await oy();return await PS(e,Mh,"1"),await RS(e,Mh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>PS(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>JF(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>RS(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Vf(i,!1).getAll();return new du(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}zA.type="LOCAL";const ZF=zA;new lu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ej(t,e){return e?Hr(e):(oe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv extends Sv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fa(e,this._buildIdpRequest())}_linkToIdToken(e,n){return fa(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return fa(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function tj(t){return MA(t.auth,new Cv(t),t.bypassAuthState)}function nj(t){const{auth:e,user:n}=t;return oe(n,e,"internal-error"),xF(n,new Cv(t),t.bypassAuthState)}async function rj(t){const{auth:e,user:n}=t;return oe(n,e,"internal-error"),NF(n,new Cv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tj;case"linkViaPopup":case"linkViaRedirect":return rj;case"reauthViaPopup":case"reauthViaRedirect":return nj;default:ur(this.auth,"internal-error")}}resolve(e){oi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){oi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij=new lu(2e3,1e4);class na extends WA{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,na.currentPopupAction&&na.currentPopupAction.cancel(),na.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return oe(e,this.auth,"internal-error"),e}async onExecution(){oi(this.filter.length===1,"Popup operations only handle one event");const e=Iv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(kr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(kr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,na.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ij.get())};e()}}na.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sj="pendingRedirect",Fd=new Map;class oj extends WA{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Fd.get(this.auth._key());if(!e){try{const r=await aj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Fd.set(this.auth._key(),e)}return this.bypassAuthState||Fd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aj(t,e){const n=uj(e),r=cj(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function lj(t,e){Fd.set(t._key(),e)}function cj(t){return Hr(t._redirectPersistence)}function uj(t){return Vd(sj,t.config.apiKey,t.name)}async function dj(t,e,n=!1){if(En(t.app))return Promise.reject(Yr(t));const r=Io(t),i=ej(r,e),o=await new oj(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj=10*60*1e3;class fj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pj(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!qA(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(kr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=hj&&this.cachedEventUids.clear(),this.cachedEventUids.has(NS(e))}saveEventToCache(e){this.cachedEventUids.add(NS(e)),this.lastProcessedEventTime=Date.now()}}function NS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function qA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function pj(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mj(t,e={}){return Es(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yj=/^https?/;async function _j(t){if(t.config.emulator)return;const{authorizedDomains:e}=await mj(t);for(const n of e)try{if(vj(n))return}catch{}ur(t,"unauthorized-domain")}function vj(t){const e=ry(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!yj.test(n))return!1;if(gj.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj=new lu(3e4,6e4);function xS(){const t=br().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Ej(t){return new Promise((e,n)=>{var i,s,o;function r(){xS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{xS(),n(kr(t,"network-request-failed"))},timeout:wj.get()})}if((s=(i=br().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=br().gapi)!=null&&o.load)r();else{const a=fF("iframefcb");return br()[a]=()=>{gapi.load?r():n(kr(t,"network-request-failed"))},AA(`${hF()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw jd=null,e})}let jd=null;function Sj(t){return jd=jd||Ej(t),jd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tj=new lu(5e3,15e3),Ij="__/auth/iframe",Cj="emulator/auth/iframe",kj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Aj(t){const e=t.config;oe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?vv(e,Cj):`https://${t.config.authDomain}/${Ij}`,r={apiKey:e.apiKey,appName:t.name,v:To},i=bj.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Ya(r).slice(1)}`}async function Pj(t){const e=await Sj(t),n=br().gapi;return oe(n,t,"internal-error"),e.open({where:document.body,url:Aj(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:kj,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=kr(t,"network-request-failed"),a=br().setTimeout(()=>{s(o)},Tj.get());function l(){br().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Nj=500,xj=600,Mj="_blank",Oj="http://localhost";class MS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Dj(t,e,n,r=Nj,i=xj){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...Rj,width:r.toString(),height:i.toString(),top:s,left:o},u=Ht().toLowerCase();n&&(a=EA(u)?Mj:n),vA(u)&&(e=e||Oj,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[w,E])=>`${m}${w}=${E},`,"");if(rF(u)&&a!=="_self")return Lj(e||"",a),new MS(null);const f=window.open(e||"",a,d);oe(f,t,"popup-blocked");try{f.focus()}catch{}return new MS(f)}function Lj(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj="__/auth/handler",Fj="emulator/auth/handler",jj=encodeURIComponent("fac");async function OS(t,e,n,r,i,s){oe(t.config.authDomain,t,"auth-domain-config-required"),oe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:To,eventId:i};if(e instanceof NA){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",kh(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof uu){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),u=l?`#${jj}=${encodeURIComponent(l)}`:"";return`${Uj(t)}?${Ya(a).slice(1)}${u}`}function Uj({config:t}){return t.emulator?vv(t,Fj):`https://${t.authDomain}/${Vj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wm="webStorageSupport";class $j{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jA,this._completeRedirectFn=dj,this._overrideRedirectResult=lj}async _openPopup(e,n,r,i){var o;oi((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await OS(e,n,r,ry(),i);return Dj(e,s,Iv())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await OS(e,n,r,ry(),i);return WF(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(oi(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Pj(e),r=new fj(e);return n.register("authEvent",i=>(oe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(wm,{type:wm},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[wm];s!==void 0&&n(!!s),ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=_j(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return kA()||wA()||Ev()}}const Bj=$j;var DS="@firebase/auth",LS="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wj(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function qj(t){cr(new Gn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;oe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bA(t)},u=new cF(r,i,s,l);return vF(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),cr(new Gn("auth-internal",e=>{const n=Io(e.getProvider("auth").getImmediate());return(r=>new zj(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),fn(DS,LS,Wj(t)),fn(DS,LS,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hj=5*60,Gj=Z1("authIdTokenMaxAge")||Hj;let VS=null;const Kj=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Gj)return;const i=n==null?void 0:n.token;VS!==i&&(VS=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function HA(t=Of()){const e=vs(t,"auth");if(e.isInitialized())return e.getImmediate();const n=_F(t,{popupRedirectResolver:Bj,persistence:[ZF,$F,jA]}),r=Z1("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=Kj(s.toString());LF(n,o,()=>o(n.currentUser)),DF(n,a=>o(a))}}const i=J1("auth");return i&&wF(n,`http://${i}`),n}function Qj(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}uF({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=kr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",Qj().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});qj("Browser");var FS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ji,GA;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,C){function R(){}R.prototype=C.prototype,A.F=C.prototype,A.prototype=new R,A.prototype.constructor=A,A.D=function(x,O,V){for(var N=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)N[ut-2]=arguments[ut];return C.prototype[O].apply(x,N)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,C,R){R||(R=0);const x=Array(16);if(typeof C=="string")for(var O=0;O<16;++O)x[O]=C.charCodeAt(R++)|C.charCodeAt(R++)<<8|C.charCodeAt(R++)<<16|C.charCodeAt(R++)<<24;else for(O=0;O<16;++O)x[O]=C[R++]|C[R++]<<8|C[R++]<<16|C[R++]<<24;C=A.g[0],R=A.g[1],O=A.g[2];let V=A.g[3],N;N=C+(V^R&(O^V))+x[0]+3614090360&4294967295,C=R+(N<<7&4294967295|N>>>25),N=V+(O^C&(R^O))+x[1]+3905402710&4294967295,V=C+(N<<12&4294967295|N>>>20),N=O+(R^V&(C^R))+x[2]+606105819&4294967295,O=V+(N<<17&4294967295|N>>>15),N=R+(C^O&(V^C))+x[3]+3250441966&4294967295,R=O+(N<<22&4294967295|N>>>10),N=C+(V^R&(O^V))+x[4]+4118548399&4294967295,C=R+(N<<7&4294967295|N>>>25),N=V+(O^C&(R^O))+x[5]+1200080426&4294967295,V=C+(N<<12&4294967295|N>>>20),N=O+(R^V&(C^R))+x[6]+2821735955&4294967295,O=V+(N<<17&4294967295|N>>>15),N=R+(C^O&(V^C))+x[7]+4249261313&4294967295,R=O+(N<<22&4294967295|N>>>10),N=C+(V^R&(O^V))+x[8]+1770035416&4294967295,C=R+(N<<7&4294967295|N>>>25),N=V+(O^C&(R^O))+x[9]+2336552879&4294967295,V=C+(N<<12&4294967295|N>>>20),N=O+(R^V&(C^R))+x[10]+4294925233&4294967295,O=V+(N<<17&4294967295|N>>>15),N=R+(C^O&(V^C))+x[11]+2304563134&4294967295,R=O+(N<<22&4294967295|N>>>10),N=C+(V^R&(O^V))+x[12]+1804603682&4294967295,C=R+(N<<7&4294967295|N>>>25),N=V+(O^C&(R^O))+x[13]+4254626195&4294967295,V=C+(N<<12&4294967295|N>>>20),N=O+(R^V&(C^R))+x[14]+2792965006&4294967295,O=V+(N<<17&4294967295|N>>>15),N=R+(C^O&(V^C))+x[15]+1236535329&4294967295,R=O+(N<<22&4294967295|N>>>10),N=C+(O^V&(R^O))+x[1]+4129170786&4294967295,C=R+(N<<5&4294967295|N>>>27),N=V+(R^O&(C^R))+x[6]+3225465664&4294967295,V=C+(N<<9&4294967295|N>>>23),N=O+(C^R&(V^C))+x[11]+643717713&4294967295,O=V+(N<<14&4294967295|N>>>18),N=R+(V^C&(O^V))+x[0]+3921069994&4294967295,R=O+(N<<20&4294967295|N>>>12),N=C+(O^V&(R^O))+x[5]+3593408605&4294967295,C=R+(N<<5&4294967295|N>>>27),N=V+(R^O&(C^R))+x[10]+38016083&4294967295,V=C+(N<<9&4294967295|N>>>23),N=O+(C^R&(V^C))+x[15]+3634488961&4294967295,O=V+(N<<14&4294967295|N>>>18),N=R+(V^C&(O^V))+x[4]+3889429448&4294967295,R=O+(N<<20&4294967295|N>>>12),N=C+(O^V&(R^O))+x[9]+568446438&4294967295,C=R+(N<<5&4294967295|N>>>27),N=V+(R^O&(C^R))+x[14]+3275163606&4294967295,V=C+(N<<9&4294967295|N>>>23),N=O+(C^R&(V^C))+x[3]+4107603335&4294967295,O=V+(N<<14&4294967295|N>>>18),N=R+(V^C&(O^V))+x[8]+1163531501&4294967295,R=O+(N<<20&4294967295|N>>>12),N=C+(O^V&(R^O))+x[13]+2850285829&4294967295,C=R+(N<<5&4294967295|N>>>27),N=V+(R^O&(C^R))+x[2]+4243563512&4294967295,V=C+(N<<9&4294967295|N>>>23),N=O+(C^R&(V^C))+x[7]+1735328473&4294967295,O=V+(N<<14&4294967295|N>>>18),N=R+(V^C&(O^V))+x[12]+2368359562&4294967295,R=O+(N<<20&4294967295|N>>>12),N=C+(R^O^V)+x[5]+4294588738&4294967295,C=R+(N<<4&4294967295|N>>>28),N=V+(C^R^O)+x[8]+2272392833&4294967295,V=C+(N<<11&4294967295|N>>>21),N=O+(V^C^R)+x[11]+1839030562&4294967295,O=V+(N<<16&4294967295|N>>>16),N=R+(O^V^C)+x[14]+4259657740&4294967295,R=O+(N<<23&4294967295|N>>>9),N=C+(R^O^V)+x[1]+2763975236&4294967295,C=R+(N<<4&4294967295|N>>>28),N=V+(C^R^O)+x[4]+1272893353&4294967295,V=C+(N<<11&4294967295|N>>>21),N=O+(V^C^R)+x[7]+4139469664&4294967295,O=V+(N<<16&4294967295|N>>>16),N=R+(O^V^C)+x[10]+3200236656&4294967295,R=O+(N<<23&4294967295|N>>>9),N=C+(R^O^V)+x[13]+681279174&4294967295,C=R+(N<<4&4294967295|N>>>28),N=V+(C^R^O)+x[0]+3936430074&4294967295,V=C+(N<<11&4294967295|N>>>21),N=O+(V^C^R)+x[3]+3572445317&4294967295,O=V+(N<<16&4294967295|N>>>16),N=R+(O^V^C)+x[6]+76029189&4294967295,R=O+(N<<23&4294967295|N>>>9),N=C+(R^O^V)+x[9]+3654602809&4294967295,C=R+(N<<4&4294967295|N>>>28),N=V+(C^R^O)+x[12]+3873151461&4294967295,V=C+(N<<11&4294967295|N>>>21),N=O+(V^C^R)+x[15]+530742520&4294967295,O=V+(N<<16&4294967295|N>>>16),N=R+(O^V^C)+x[2]+3299628645&4294967295,R=O+(N<<23&4294967295|N>>>9),N=C+(O^(R|~V))+x[0]+4096336452&4294967295,C=R+(N<<6&4294967295|N>>>26),N=V+(R^(C|~O))+x[7]+1126891415&4294967295,V=C+(N<<10&4294967295|N>>>22),N=O+(C^(V|~R))+x[14]+2878612391&4294967295,O=V+(N<<15&4294967295|N>>>17),N=R+(V^(O|~C))+x[5]+4237533241&4294967295,R=O+(N<<21&4294967295|N>>>11),N=C+(O^(R|~V))+x[12]+1700485571&4294967295,C=R+(N<<6&4294967295|N>>>26),N=V+(R^(C|~O))+x[3]+2399980690&4294967295,V=C+(N<<10&4294967295|N>>>22),N=O+(C^(V|~R))+x[10]+4293915773&4294967295,O=V+(N<<15&4294967295|N>>>17),N=R+(V^(O|~C))+x[1]+2240044497&4294967295,R=O+(N<<21&4294967295|N>>>11),N=C+(O^(R|~V))+x[8]+1873313359&4294967295,C=R+(N<<6&4294967295|N>>>26),N=V+(R^(C|~O))+x[15]+4264355552&4294967295,V=C+(N<<10&4294967295|N>>>22),N=O+(C^(V|~R))+x[6]+2734768916&4294967295,O=V+(N<<15&4294967295|N>>>17),N=R+(V^(O|~C))+x[13]+1309151649&4294967295,R=O+(N<<21&4294967295|N>>>11),N=C+(O^(R|~V))+x[4]+4149444226&4294967295,C=R+(N<<6&4294967295|N>>>26),N=V+(R^(C|~O))+x[11]+3174756917&4294967295,V=C+(N<<10&4294967295|N>>>22),N=O+(C^(V|~R))+x[2]+718787259&4294967295,O=V+(N<<15&4294967295|N>>>17),N=R+(V^(O|~C))+x[9]+3951481745&4294967295,A.g[0]=A.g[0]+C&4294967295,A.g[1]=A.g[1]+(O+(N<<21&4294967295|N>>>11))&4294967295,A.g[2]=A.g[2]+O&4294967295,A.g[3]=A.g[3]+V&4294967295}r.prototype.v=function(A,C){C===void 0&&(C=A.length);const R=C-this.blockSize,x=this.C;let O=this.h,V=0;for(;V<C;){if(O==0)for(;V<=R;)i(this,A,V),V+=this.blockSize;if(typeof A=="string"){for(;V<C;)if(x[O++]=A.charCodeAt(V++),O==this.blockSize){i(this,x),O=0;break}}else for(;V<C;)if(x[O++]=A[V++],O==this.blockSize){i(this,x),O=0;break}}this.h=O,this.o+=C},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var C=1;C<A.length-8;++C)A[C]=0;C=this.o*8;for(var R=A.length-8;R<A.length;++R)A[R]=C&255,C/=256;for(this.v(A),A=Array(16),C=0,R=0;R<4;++R)for(let x=0;x<32;x+=8)A[C++]=this.g[R]>>>x&255;return A};function s(A,C){var R=a;return Object.prototype.hasOwnProperty.call(R,A)?R[A]:R[A]=C(A)}function o(A,C){this.h=C;const R=[];let x=!0;for(let O=A.length-1;O>=0;O--){const V=A[O]|0;x&&V==C||(R[O]=V,x=!1)}this.g=R}var a={};function l(A){return-128<=A&&A<128?s(A,function(C){return new o([C|0],C<0?-1:0)}):new o([A|0],A<0?-1:0)}function u(A){if(isNaN(A)||!isFinite(A))return f;if(A<0)return b(u(-A));const C=[];let R=1;for(let x=0;A>=R;x++)C[x]=A/R|0,R*=4294967296;return new o(C,0)}function d(A,C){if(A.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(A.charAt(0)=="-")return b(d(A.substring(1),C));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=u(Math.pow(C,8));let x=f;for(let V=0;V<A.length;V+=8){var O=Math.min(8,A.length-V);const N=parseInt(A.substring(V,V+O),C);O<8?(O=u(Math.pow(C,O)),x=x.j(O).add(u(N))):(x=x.j(R),x=x.add(u(N)))}return x}var f=l(0),m=l(1),w=l(16777216);t=o.prototype,t.m=function(){if(v(this))return-b(this).m();let A=0,C=1;for(let R=0;R<this.g.length;R++){const x=this.i(R);A+=(x>=0?x:4294967296+x)*C,C*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(E(this))return"0";if(v(this))return"-"+b(this).toString(A);const C=u(Math.pow(A,6));var R=this;let x="";for(;;){const O=L(R,C).g;R=S(R,O.j(C));let V=((R.g.length>0?R.g[0]:R.h)>>>0).toString(A);if(R=O,E(R))return V+x;for(;V.length<6;)V="0"+V;x=V+x}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function E(A){if(A.h!=0)return!1;for(let C=0;C<A.g.length;C++)if(A.g[C]!=0)return!1;return!0}function v(A){return A.h==-1}t.l=function(A){return A=S(this,A),v(A)?-1:E(A)?0:1};function b(A){const C=A.g.length,R=[];for(let x=0;x<C;x++)R[x]=~A.g[x];return new o(R,~A.h).add(m)}t.abs=function(){return v(this)?b(this):this},t.add=function(A){const C=Math.max(this.g.length,A.g.length),R=[];let x=0;for(let O=0;O<=C;O++){let V=x+(this.i(O)&65535)+(A.i(O)&65535),N=(V>>>16)+(this.i(O)>>>16)+(A.i(O)>>>16);x=N>>>16,V&=65535,N&=65535,R[O]=N<<16|V}return new o(R,R[R.length-1]&-2147483648?-1:0)};function S(A,C){return A.add(b(C))}t.j=function(A){if(E(this)||E(A))return f;if(v(this))return v(A)?b(this).j(b(A)):b(b(this).j(A));if(v(A))return b(this.j(b(A)));if(this.l(w)<0&&A.l(w)<0)return u(this.m()*A.m());const C=this.g.length+A.g.length,R=[];for(var x=0;x<2*C;x++)R[x]=0;for(x=0;x<this.g.length;x++)for(let O=0;O<A.g.length;O++){const V=this.i(x)>>>16,N=this.i(x)&65535,ut=A.i(O)>>>16,xn=A.i(O)&65535;R[2*x+2*O]+=N*xn,T(R,2*x+2*O),R[2*x+2*O+1]+=V*xn,T(R,2*x+2*O+1),R[2*x+2*O+1]+=N*ut,T(R,2*x+2*O+1),R[2*x+2*O+2]+=V*ut,T(R,2*x+2*O+2)}for(A=0;A<C;A++)R[A]=R[2*A+1]<<16|R[2*A];for(A=C;A<2*C;A++)R[A]=0;return new o(R,0)};function T(A,C){for(;(A[C]&65535)!=A[C];)A[C+1]+=A[C]>>>16,A[C]&=65535,C++}function k(A,C){this.g=A,this.h=C}function L(A,C){if(E(C))throw Error("division by zero");if(E(A))return new k(f,f);if(v(A))return C=L(b(A),C),new k(b(C.g),b(C.h));if(v(C))return C=L(A,b(C)),new k(b(C.g),C.h);if(A.g.length>30){if(v(A)||v(C))throw Error("slowDivide_ only works with positive integers.");for(var R=m,x=C;x.l(A)<=0;)R=U(R),x=U(x);var O=z(R,1),V=z(x,1);for(x=z(x,2),R=z(R,2);!E(x);){var N=V.add(x);N.l(A)<=0&&(O=O.add(R),V=N),x=z(x,1),R=z(R,1)}return C=S(A,O.j(C)),new k(O,C)}for(O=f;A.l(C)>=0;){for(R=Math.max(1,Math.floor(A.m()/C.m())),x=Math.ceil(Math.log(R)/Math.LN2),x=x<=48?1:Math.pow(2,x-48),V=u(R),N=V.j(C);v(N)||N.l(A)>0;)R-=x,V=u(R),N=V.j(C);E(V)&&(V=m),O=O.add(V),A=S(A,N)}return new k(O,A)}t.B=function(A){return L(this,A).h},t.and=function(A){const C=Math.max(this.g.length,A.g.length),R=[];for(let x=0;x<C;x++)R[x]=this.i(x)&A.i(x);return new o(R,this.h&A.h)},t.or=function(A){const C=Math.max(this.g.length,A.g.length),R=[];for(let x=0;x<C;x++)R[x]=this.i(x)|A.i(x);return new o(R,this.h|A.h)},t.xor=function(A){const C=Math.max(this.g.length,A.g.length),R=[];for(let x=0;x<C;x++)R[x]=this.i(x)^A.i(x);return new o(R,this.h^A.h)};function U(A){const C=A.g.length+1,R=[];for(let x=0;x<C;x++)R[x]=A.i(x)<<1|A.i(x-1)>>>31;return new o(R,A.h)}function z(A,C){const R=C>>5;C%=32;const x=A.g.length-R,O=[];for(let V=0;V<x;V++)O[V]=C>0?A.i(V+R)>>>C|A.i(V+R+1)<<32-C:A.i(V+R);return new o(O,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,GA=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Ji=o}).apply(typeof FS<"u"?FS:typeof self<"u"?self:typeof window<"u"?window:{});var nd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var KA,Wl,QA,Ud,ay,JA,YA,XA;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof nd=="object"&&nd];for(var p=0;p<c.length;++p){var g=c[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(c,p){if(p)e:{var g=r;c=c.split(".");for(var I=0;I<c.length-1;I++){var F=c[I];if(!(F in g))break e;g=g[F]}c=c[c.length-1],I=g[c],p=p(I),p!=I&&p!=null&&e(g,c,{configurable:!0,writable:!0,value:p})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(p){var g=[],I;for(I in p)Object.prototype.hasOwnProperty.call(p,I)&&g.push([I,p[I]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,g){return c.call.apply(c.bind,arguments)}function u(c,p,g){return u=l,u.apply(null,arguments)}function d(c,p){var g=Array.prototype.slice.call(arguments,1);return function(){var I=g.slice();return I.push.apply(I,arguments),c.apply(this,I)}}function f(c,p){function g(){}g.prototype=p.prototype,c.Z=p.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(I,F,j){for(var J=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)J[pe-2]=arguments[pe];return p.prototype[F].apply(I,J)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function w(c){const p=c.length;if(p>0){const g=Array(p);for(let I=0;I<p;I++)g[I]=c[I];return g}return[]}function E(c,p){for(let I=1;I<arguments.length;I++){const F=arguments[I];var g=typeof F;if(g=g!="object"?g:F?Array.isArray(F)?"array":g:"null",g=="array"||g=="object"&&typeof F.length=="number"){g=c.length||0;const j=F.length||0;c.length=g+j;for(let J=0;J<j;J++)c[g+J]=F[J]}else c.push(F)}}class v{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function b(c){o.setTimeout(()=>{throw c},0)}function S(){var c=A;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class T{constructor(){this.h=this.g=null}add(p,g){const I=k.get();I.set(p,g),this.h?this.h.next=I:this.g=I,this.h=I}}var k=new v(()=>new L,c=>c.reset());class L{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let U,z=!1,A=new T,C=()=>{const c=Promise.resolve(void 0);U=()=>{c.then(R)}};function R(){for(var c;c=S();){try{c.h.call(c.g)}catch(g){b(g)}var p=k;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}z=!1}function x(){this.u=this.u,this.C=this.C}x.prototype.u=!1,x.prototype.dispose=function(){this.u||(this.u=!0,this.N())},x.prototype[Symbol.dispose]=function(){this.dispose()},x.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};o.addEventListener("test",g,p),o.removeEventListener("test",g,p)}catch{}return c}();function N(c){return/^[\s\xa0]*$/.test(c)}function ut(c,p){O.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}f(ut,O),ut.prototype.init=function(c,p){const g=this.type=c.type,I=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(g=="mouseover"?p=c.fromElement:g=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&ut.Z.h.call(this)},ut.prototype.h=function(){ut.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var xn="closure_listenable_"+(Math.random()*1e6|0),hi=0;function fi(c,p,g,I,F){this.listener=c,this.proxy=null,this.src=p,this.type=g,this.capture=!!I,this.ha=F,this.key=++hi,this.da=this.fa=!1}function X(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function se(c,p,g){for(const I in c)p.call(g,c[I],I,c)}function he(c,p){for(const g in c)p.call(void 0,c[g],g,c)}function Oe(c){const p={};for(const g in c)p[g]=c[g];return p}const Ke="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function h(c,p){let g,I;for(let F=1;F<arguments.length;F++){I=arguments[F];for(g in I)c[g]=I[g];for(let j=0;j<Ke.length;j++)g=Ke[j],Object.prototype.hasOwnProperty.call(I,g)&&(c[g]=I[g])}}function _(c){this.src=c,this.g={},this.h=0}_.prototype.add=function(c,p,g,I,F){const j=c.toString();c=this.g[j],c||(c=this.g[j]=[],this.h++);const J=P(c,p,I,F);return J>-1?(p=c[J],g||(p.fa=!1)):(p=new fi(p,this.src,j,!!I,F),p.fa=g,c.push(p)),p};function y(c,p){const g=p.type;if(g in c.g){var I=c.g[g],F=Array.prototype.indexOf.call(I,p,void 0),j;(j=F>=0)&&Array.prototype.splice.call(I,F,1),j&&(X(p),c.g[g].length==0&&(delete c.g[g],c.h--))}}function P(c,p,g,I){for(let F=0;F<c.length;++F){const j=c[F];if(!j.da&&j.listener==p&&j.capture==!!g&&j.ha==I)return F}return-1}var M="closure_lm_"+(Math.random()*1e6|0),$={};function G(c,p,g,I,F){if(Array.isArray(p)){for(let j=0;j<p.length;j++)G(c,p[j],g,I,F);return null}return g=Gt(g),c&&c[xn]?c.J(p,g,a(I)?!!I.capture:!1,F):K(c,p,g,!1,I,F)}function K(c,p,g,I,F,j){if(!p)throw Error("Invalid event type");const J=a(F)?!!F.capture:!!F;let pe=Dr(c);if(pe||(c[M]=pe=new _(c)),g=pe.add(p,g,I,J,j),g.proxy)return g;if(I=te(),g.proxy=I,I.src=c,I.listener=g,c.addEventListener)V||(F=J),F===void 0&&(F=!1),c.addEventListener(p.toString(),I,F);else if(c.attachEvent)c.attachEvent(yn(p.toString()),I);else if(c.addListener&&c.removeListener)c.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return g}function te(){function c(g){return p.call(c.src,c.listener,g)}const p=Or;return c}function fe(c,p,g,I,F){if(Array.isArray(p))for(var j=0;j<p.length;j++)fe(c,p[j],g,I,F);else I=a(I)?!!I.capture:!!I,g=Gt(g),c&&c[xn]?(c=c.i,j=String(p).toString(),j in c.g&&(p=c.g[j],g=P(p,g,I,F),g>-1&&(X(p[g]),Array.prototype.splice.call(p,g,1),p.length==0&&(delete c.g[j],c.h--)))):c&&(c=Dr(c))&&(p=c.g[p.toString()],c=-1,p&&(c=P(p,g,I,F)),(g=c>-1?p[c]:null)&&me(g))}function me(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[xn])y(p.i,c);else{var g=c.type,I=c.proxy;p.removeEventListener?p.removeEventListener(g,I,c.capture):p.detachEvent?p.detachEvent(yn(g),I):p.addListener&&p.removeListener&&p.removeListener(I),(g=Dr(p))?(y(g,c),g.h==0&&(g.src=null,p[M]=null)):X(c)}}}function yn(c){return c in $?$[c]:$[c]="on"+c}function Or(c,p){if(c.da)c=!0;else{p=new ut(p,this);const g=c.listener,I=c.ha||c.src;c.fa&&me(c),c=g.call(I,p)}return c}function Dr(c){return c=c[M],c instanceof _?c:null}var et="__closure_events_fn_"+(Math.random()*1e9>>>0);function Gt(c){return typeof c=="function"?c:(c[et]||(c[et]=function(p){return c.handleEvent(p)}),c[et])}function Qe(){x.call(this),this.i=new _(this),this.M=this,this.G=null}f(Qe,x),Qe.prototype[xn]=!0,Qe.prototype.removeEventListener=function(c,p,g,I){fe(this,c,p,g,I)};function it(c,p){var g,I=c.G;if(I)for(g=[];I;I=I.G)g.push(I);if(c=c.M,I=p.type||p,typeof p=="string")p=new O(p,c);else if(p instanceof O)p.target=p.target||c;else{var F=p;p=new O(I,c),h(p,F)}F=!0;let j,J;if(g)for(J=g.length-1;J>=0;J--)j=p.g=g[J],F=Lr(j,I,!0,p)&&F;if(j=p.g=c,F=Lr(j,I,!0,p)&&F,F=Lr(j,I,!1,p)&&F,g)for(J=0;J<g.length;J++)j=p.g=g[J],F=Lr(j,I,!1,p)&&F}Qe.prototype.N=function(){if(Qe.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const g=c.g[p];for(let I=0;I<g.length;I++)X(g[I]);delete c.g[p],c.h--}}this.G=null},Qe.prototype.J=function(c,p,g,I){return this.i.add(String(c),p,!1,g,I)},Qe.prototype.K=function(c,p,g,I){return this.i.add(String(c),p,!0,g,I)};function Lr(c,p,g,I){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let F=!0;for(let j=0;j<p.length;++j){const J=p[j];if(J&&!J.da&&J.capture==g){const pe=J.listener,yt=J.ha||J.src;J.fa&&y(c.i,J),F=pe.call(yt,I)!==!1&&F}}return F&&!I.defaultPrevented}function Is(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:o.setTimeout(c,p||0)}function pi(c){c.g=Is(()=>{c.g=null,c.i&&(c.i=!1,pi(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class Cu extends x{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:pi(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Cs(c){x.call(this),this.h=c,this.g={}}f(Cs,x);var ku=[];function Yw(c){se(c.g,function(p,g){this.g.hasOwnProperty(g)&&me(p)},c),c.g={}}Cs.prototype.N=function(){Cs.Z.N.call(this),Yw(this)},Cs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ip=o.JSON.stringify,Yx=o.JSON.parse,Xx=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Xw(){}function Zw(){}var ll={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Cp(){O.call(this,"d")}f(Cp,O);function kp(){O.call(this,"c")}f(kp,O);var ks={},eE=null;function bu(){return eE=eE||new Qe}ks.Ia="serverreachability";function tE(c){O.call(this,ks.Ia,c)}f(tE,O);function cl(c){const p=bu();it(p,new tE(p))}ks.STAT_EVENT="statevent";function nE(c,p){O.call(this,ks.STAT_EVENT,c),this.stat=p}f(nE,O);function Kt(c){const p=bu();it(p,new nE(p,c))}ks.Ja="timingevent";function rE(c,p){O.call(this,ks.Ja,c),this.size=p}f(rE,O);function ul(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},p)}function dl(){this.g=!0}dl.prototype.ua=function(){this.g=!1};function Zx(c,p,g,I,F,j){c.info(function(){if(c.g)if(j){var J="",pe=j.split("&");for(let De=0;De<pe.length;De++){var yt=pe[De].split("=");if(yt.length>1){const Et=yt[0];yt=yt[1];const mr=Et.split("_");J=mr.length>=2&&mr[1]=="type"?J+(Et+"="+yt+"&"):J+(Et+"=redacted&")}}}else J=null;else J=j;return"XMLHTTP REQ ("+I+") [attempt "+F+"]: "+p+`
`+g+`
`+J})}function eM(c,p,g,I,F,j,J){c.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+F+"]: "+p+`
`+g+`
`+j+" "+J})}function Oo(c,p,g,I){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+nM(c,g)+(I?" "+I:"")})}function tM(c,p){c.info(function(){return"TIMEOUT: "+p})}dl.prototype.info=function(){};function nM(c,p){if(!c.g)return p;if(!p)return null;try{const j=JSON.parse(p);if(j){for(c=0;c<j.length;c++)if(Array.isArray(j[c])){var g=j[c];if(!(g.length<2)){var I=g[1];if(Array.isArray(I)&&!(I.length<1)){var F=I[0];if(F!="noop"&&F!="stop"&&F!="close")for(let J=1;J<I.length;J++)I[J]=""}}}}return Ip(j)}catch{return p}}var Au={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},iE={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},sE;function bp(){}f(bp,Xw),bp.prototype.g=function(){return new XMLHttpRequest},sE=new bp;function hl(c){return encodeURIComponent(String(c))}function rM(c){var p=1;c=c.split(":");const g=[];for(;p>0&&c.length;)g.push(c.shift()),p--;return c.length&&g.push(c.join(":")),g}function mi(c,p,g,I){this.j=c,this.i=p,this.l=g,this.S=I||1,this.V=new Cs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new oE}function oE(){this.i=null,this.g="",this.h=!1}var aE={},Ap={};function Pp(c,p,g){c.M=1,c.A=Ru(pr(p)),c.u=g,c.R=!0,lE(c,null)}function lE(c,p){c.F=Date.now(),Pu(c),c.B=pr(c.A);var g=c.B,I=c.S;Array.isArray(I)||(I=[String(I)]),EE(g.i,"t",I),c.C=0,g=c.j.L,c.h=new oE,c.g=jE(c.j,g?p:null,!c.u),c.P>0&&(c.O=new Cu(u(c.Y,c,c.g),c.P)),p=c.V,g=c.g,I=c.ba;var F="readystatechange";Array.isArray(F)||(F&&(ku[0]=F.toString()),F=ku);for(let j=0;j<F.length;j++){const J=G(g,F[j],I||p.handleEvent,!1,p.h||p);if(!J)break;p.g[J.key]=J}p=c.J?Oe(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),cl(),Zx(c.i,c.v,c.B,c.l,c.S,c.u)}mi.prototype.ba=function(c){c=c.target;const p=this.O;p&&_i(c)==3?p.j():this.Y(c)},mi.prototype.Y=function(c){try{if(c==this.g)e:{const pe=_i(this.g),yt=this.g.ya(),De=this.g.ca();if(!(pe<3)&&(pe!=3||this.g&&(this.h.h||this.g.la()||AE(this.g)))){this.K||pe!=4||yt==7||(yt==8||De<=0?cl(3):cl(2)),Rp(this);var p=this.g.ca();this.X=p;var g=iM(this);if(this.o=p==200,eM(this.i,this.v,this.B,this.l,this.S,pe,p),this.o){if(this.U&&!this.L){t:{if(this.g){var I,F=this.g;if((I=F.g?F.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(I)){var j=I;break t}}j=null}if(c=j)Oo(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Np(this,c);else{this.o=!1,this.m=3,Kt(12),bs(this),fl(this);break e}}if(this.R){c=!0;let Et;for(;!this.K&&this.C<g.length;)if(Et=sM(this,g),Et==Ap){pe==4&&(this.m=4,Kt(14),c=!1),Oo(this.i,this.l,null,"[Incomplete Response]");break}else if(Et==aE){this.m=4,Kt(15),Oo(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else Oo(this.i,this.l,Et,null),Np(this,Et);if(cE(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pe!=4||g.length!=0||this.h.h||(this.m=1,Kt(16),c=!1),this.o=this.o&&c,!c)Oo(this.i,this.l,g,"[Invalid Chunked Response]"),bs(this),fl(this);else if(g.length>0&&!this.W){this.W=!0;var J=this.j;J.g==this&&J.aa&&!J.P&&(J.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),jp(J),J.P=!0,Kt(11))}}else Oo(this.i,this.l,g,null),Np(this,g);pe==4&&bs(this),this.o&&!this.K&&(pe==4?DE(this.j,this):(this.o=!1,Pu(this)))}else vM(this.g),p==400&&g.indexOf("Unknown SID")>0?(this.m=3,Kt(12)):(this.m=0,Kt(13)),bs(this),fl(this)}}}catch{}finally{}};function iM(c){if(!cE(c))return c.g.la();const p=AE(c.g);if(p==="")return"";let g="";const I=p.length,F=_i(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return bs(c),fl(c),"";c.h.i=new o.TextDecoder}for(let j=0;j<I;j++)c.h.h=!0,g+=c.h.i.decode(p[j],{stream:!(F&&j==I-1)});return p.length=0,c.h.g+=g,c.C=0,c.h.g}function cE(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function sM(c,p){var g=c.C,I=p.indexOf(`
`,g);return I==-1?Ap:(g=Number(p.substring(g,I)),isNaN(g)?aE:(I+=1,I+g>p.length?Ap:(p=p.slice(I,I+g),c.C=I+g,p)))}mi.prototype.cancel=function(){this.K=!0,bs(this)};function Pu(c){c.T=Date.now()+c.H,uE(c,c.H)}function uE(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=ul(u(c.aa,c),p)}function Rp(c){c.D&&(o.clearTimeout(c.D),c.D=null)}mi.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(tM(this.i,this.B),this.M!=2&&(cl(),Kt(17)),bs(this),this.m=2,fl(this)):uE(this,this.T-c)};function fl(c){c.j.I==0||c.K||DE(c.j,c)}function bs(c){Rp(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,Yw(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function Np(c,p){try{var g=c.j;if(g.I!=0&&(g.g==c||xp(g.h,c))){if(!c.L&&xp(g.h,c)&&g.I==3){try{var I=g.Ba.g.parse(p)}catch{I=null}if(Array.isArray(I)&&I.length==3){var F=I;if(F[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)Du(g),Mu(g);else break e;Fp(g),Kt(18)}}else g.xa=F[1],0<g.xa-g.K&&F[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ul(u(g.Va,g),6e3));fE(g.h)<=1&&g.ta&&(g.ta=void 0)}else Ps(g,11)}else if((c.L||g.g==c)&&Du(g),!N(p))for(F=g.Ba.g.parse(p),p=0;p<F.length;p++){let De=F[p];const Et=De[0];if(!(Et<=g.K))if(g.K=Et,De=De[1],g.I==2)if(De[0]=="c"){g.M=De[1],g.ba=De[2];const mr=De[3];mr!=null&&(g.ka=mr,g.j.info("VER="+g.ka));const Rs=De[4];Rs!=null&&(g.za=Rs,g.j.info("SVER="+g.za));const vi=De[5];vi!=null&&typeof vi=="number"&&vi>0&&(I=1.5*vi,g.O=I,g.j.info("backChannelRequestTimeoutMs_="+I)),I=g;const wi=c.g;if(wi){const Vu=wi.g?wi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vu){var j=I.h;j.g||Vu.indexOf("spdy")==-1&&Vu.indexOf("quic")==-1&&Vu.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(Mp(j,j.h),j.h=null))}if(I.G){const Up=wi.g?wi.g.getResponseHeader("X-HTTP-Session-Id"):null;Up&&(I.wa=Up,ze(I.J,I.G,Up))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),I=g;var J=c;if(I.na=FE(I,I.L?I.ba:null,I.W),J.L){pE(I.h,J);var pe=J,yt=I.O;yt&&(pe.H=yt),pe.D&&(Rp(pe),Pu(pe)),I.g=J}else ME(I);g.i.length>0&&Ou(g)}else De[0]!="stop"&&De[0]!="close"||Ps(g,7);else g.I==3&&(De[0]=="stop"||De[0]=="close"?De[0]=="stop"?Ps(g,7):Vp(g):De[0]!="noop"&&g.l&&g.l.qa(De),g.A=0)}}cl(4)}catch{}}var oM=class{constructor(c,p){this.g=c,this.map=p}};function dE(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function hE(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function fE(c){return c.h?1:c.g?c.g.size:0}function xp(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function Mp(c,p){c.g?c.g.add(p):c.h=p}function pE(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}dE.prototype.cancel=function(){if(this.i=mE(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function mE(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const g of c.g.values())p=p.concat(g.G);return p}return w(c.i)}var gE=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function aM(c,p){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const I=c[g].indexOf("=");let F,j=null;I>=0?(F=c[g].substring(0,I),j=c[g].substring(I+1)):F=c[g],p(F,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function gi(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof gi?(this.l=c.l,pl(this,c.j),this.o=c.o,this.g=c.g,ml(this,c.u),this.h=c.h,Op(this,SE(c.i)),this.m=c.m):c&&(p=String(c).match(gE))?(this.l=!1,pl(this,p[1]||"",!0),this.o=gl(p[2]||""),this.g=gl(p[3]||"",!0),ml(this,p[4]),this.h=gl(p[5]||"",!0),Op(this,p[6]||"",!0),this.m=gl(p[7]||"")):(this.l=!1,this.i=new _l(null,this.l))}gi.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(yl(p,yE,!0),":");var g=this.g;return(g||p=="file")&&(c.push("//"),(p=this.o)&&c.push(yl(p,yE,!0),"@"),c.push(hl(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(yl(g,g.charAt(0)=="/"?uM:cM,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",yl(g,hM)),c.join("")},gi.prototype.resolve=function(c){const p=pr(this);let g=!!c.j;g?pl(p,c.j):g=!!c.o,g?p.o=c.o:g=!!c.g,g?p.g=c.g:g=c.u!=null;var I=c.h;if(g)ml(p,c.u);else if(g=!!c.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var F=p.h.lastIndexOf("/");F!=-1&&(I=p.h.slice(0,F+1)+I)}if(F=I,F==".."||F==".")I="";else if(F.indexOf("./")!=-1||F.indexOf("/.")!=-1){I=F.lastIndexOf("/",0)==0,F=F.split("/");const j=[];for(let J=0;J<F.length;){const pe=F[J++];pe=="."?I&&J==F.length&&j.push(""):pe==".."?((j.length>1||j.length==1&&j[0]!="")&&j.pop(),I&&J==F.length&&j.push("")):(j.push(pe),I=!0)}I=j.join("/")}else I=F}return g?p.h=I:g=c.i.toString()!=="",g?Op(p,SE(c.i)):g=!!c.m,g&&(p.m=c.m),p};function pr(c){return new gi(c)}function pl(c,p,g){c.j=g?gl(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function ml(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Op(c,p,g){p instanceof _l?(c.i=p,fM(c.i,c.l)):(g||(p=yl(p,dM)),c.i=new _l(p,c.l))}function ze(c,p,g){c.i.set(p,g)}function Ru(c){return ze(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function gl(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function yl(c,p,g){return typeof c=="string"?(c=encodeURI(c).replace(p,lM),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function lM(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var yE=/[#\/\?@]/g,cM=/[#\?:]/g,uM=/[#\?]/g,dM=/[#\?@]/g,hM=/#/g;function _l(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function As(c){c.g||(c.g=new Map,c.h=0,c.i&&aM(c.i,function(p,g){c.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=_l.prototype,t.add=function(c,p){As(this),this.i=null,c=Do(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(p),this.h+=1,this};function _E(c,p){As(c),p=Do(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function vE(c,p){return As(c),p=Do(c,p),c.g.has(p)}t.forEach=function(c,p){As(this),this.g.forEach(function(g,I){g.forEach(function(F){c.call(p,F,I,this)},this)},this)};function wE(c,p){As(c);let g=[];if(typeof p=="string")vE(c,p)&&(g=g.concat(c.g.get(Do(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)g=g.concat(c[p]);return g}t.set=function(c,p){return As(this),this.i=null,c=Do(this,c),vE(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=wE(this,c),c.length>0?String(c[0]):p):p};function EE(c,p,g){_E(c,p),g.length>0&&(c.i=null,c.g.set(Do(c,p),w(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let I=0;I<p.length;I++){var g=p[I];const F=hl(g);g=wE(this,g);for(let j=0;j<g.length;j++){let J=F;g[j]!==""&&(J+="="+hl(g[j])),c.push(J)}}return this.i=c.join("&")};function SE(c){const p=new _l;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function Do(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function fM(c,p){p&&!c.j&&(As(c),c.i=null,c.g.forEach(function(g,I){const F=I.toLowerCase();I!=F&&(_E(this,I),EE(this,F,g))},c)),c.j=p}function pM(c,p){const g=new dl;if(o.Image){const I=new Image;I.onload=d(yi,g,"TestLoadImage: loaded",!0,p,I),I.onerror=d(yi,g,"TestLoadImage: error",!1,p,I),I.onabort=d(yi,g,"TestLoadImage: abort",!1,p,I),I.ontimeout=d(yi,g,"TestLoadImage: timeout",!1,p,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=c}else p(!1)}function mM(c,p){const g=new dl,I=new AbortController,F=setTimeout(()=>{I.abort(),yi(g,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:I.signal}).then(j=>{clearTimeout(F),j.ok?yi(g,"TestPingServer: ok",!0,p):yi(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(F),yi(g,"TestPingServer: error",!1,p)})}function yi(c,p,g,I,F){try{F&&(F.onload=null,F.onerror=null,F.onabort=null,F.ontimeout=null),I(g)}catch{}}function gM(){this.g=new Xx}function Dp(c){this.i=c.Sb||null,this.h=c.ab||!1}f(Dp,Xw),Dp.prototype.g=function(){return new Nu(this.i,this.h)};function Nu(c,p){Qe.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Nu,Qe),t=Nu.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,wl(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||o).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,vl(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,wl(this)),this.g&&(this.readyState=3,wl(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;TE(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function TE(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?vl(this):wl(this),this.readyState==3&&TE(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,vl(this))},t.Na=function(c){this.g&&(this.response=c,vl(this))},t.ga=function(){this.g&&vl(this)};function vl(c){c.readyState=4,c.l=null,c.j=null,c.B=null,wl(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=p.next();return c.join(`\r
`)};function wl(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Nu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function IE(c){let p="";return se(c,function(g,I){p+=I,p+=":",p+=g,p+=`\r
`}),p}function Lp(c,p,g){e:{for(I in g){var I=!1;break e}I=!0}I||(g=IE(g),typeof c=="string"?g!=null&&hl(g):ze(c,p,g))}function tt(c){Qe.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(tt,Qe);var yM=/^https?$/i,_M=["POST","PUT"];t=tt.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,g,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():sE.g(),this.g.onreadystatechange=m(u(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(j){CE(this,j);return}if(c=g||"",g=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var F in I)g.set(F,I[F]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const j of I.keys())g.set(j,I.get(j));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(g.keys()).find(j=>j.toLowerCase()=="content-type"),F=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(_M,p,void 0)>=0)||I||F||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,J]of g)this.g.setRequestHeader(j,J);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(j){CE(this,j)}};function CE(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,kE(c),xu(c)}function kE(c){c.A||(c.A=!0,it(c,"complete"),it(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,it(this,"complete"),it(this,"abort"),xu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xu(this,!0)),tt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?bE(this):this.Xa())},t.Xa=function(){bE(this)};function bE(c){if(c.h&&typeof s<"u"){if(c.v&&_i(c)==4)setTimeout(c.Ca.bind(c),0);else if(it(c,"readystatechange"),_i(c)==4){c.h=!1;try{const j=c.ca();e:switch(j){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var I;if(I=j===0){let J=String(c.D).match(gE)[1]||null;!J&&o.self&&o.self.location&&(J=o.self.location.protocol.slice(0,-1)),I=!yM.test(J?J.toLowerCase():"")}g=I}if(g)it(c,"complete"),it(c,"success");else{c.o=6;try{var F=_i(c)>2?c.g.statusText:""}catch{F=""}c.l=F+" ["+c.ca()+"]",kE(c)}}finally{xu(c)}}}}function xu(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,p||it(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function _i(c){return c.g?c.g.readyState:0}t.ca=function(){try{return _i(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Yx(p)}};function AE(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function vM(c){const p={};c=(c.g&&_i(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<c.length;I++){if(N(c[I]))continue;var g=rM(c[I]);const F=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const j=p[F]||[];p[F]=j,j.push(g)}he(p,function(I){return I.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function El(c,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||p}function PE(c){this.za=0,this.i=[],this.j=new dl,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=El("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=El("baseRetryDelayMs",5e3,c),this.Za=El("retryDelaySeedMs",1e4,c),this.Ta=El("forwardChannelMaxRetries",2,c),this.va=El("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new dE(c&&c.concurrentRequestLimit),this.Ba=new gM,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=PE.prototype,t.ka=8,t.I=1,t.connect=function(c,p,g,I){Kt(0),this.W=c,this.H=p||{},g&&I!==void 0&&(this.H.OSID=g,this.H.OAID=I),this.F=this.X,this.J=FE(this,null,this.W),Ou(this)};function Vp(c){if(RE(c),c.I==3){var p=c.V++,g=pr(c.J);if(ze(g,"SID",c.M),ze(g,"RID",p),ze(g,"TYPE","terminate"),Sl(c,g),p=new mi(c,c.j,p),p.M=2,p.A=Ru(pr(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(p.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=p.A,g=!0),g||(p.g=jE(p.j,null),p.g.ea(p.A)),p.F=Date.now(),Pu(p)}VE(c)}function Mu(c){c.g&&(jp(c),c.g.cancel(),c.g=null)}function RE(c){Mu(c),c.v&&(o.clearTimeout(c.v),c.v=null),Du(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Ou(c){if(!hE(c.h)&&!c.m){c.m=!0;var p=c.Ea;U||C(),z||(U(),z=!0),A.add(p,c),c.D=0}}function wM(c,p){return fE(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=ul(u(c.Ea,c,p),LE(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const F=new mi(this,this.j,c);let j=this.o;if(this.U&&(j?(j=Oe(j),h(j,this.U)):j=this.U),this.u!==null||this.R||(F.J=j,j=null),this.S)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var I=this.i[g];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(p+=I,p>4096){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=xE(this,F,p),g=pr(this.J),ze(g,"RID",c),ze(g,"CVER",22),this.G&&ze(g,"X-HTTP-Session-Id",this.G),Sl(this,g),j&&(this.R?p="headers="+hl(IE(j))+"&"+p:this.u&&Lp(g,this.u,j)),Mp(this.h,F),this.Ra&&ze(g,"TYPE","init"),this.S?(ze(g,"$req",p),ze(g,"SID","null"),F.U=!0,Pp(F,g,null)):Pp(F,g,p),this.I=2}}else this.I==3&&(c?NE(this,c):this.i.length==0||hE(this.h)||NE(this))};function NE(c,p){var g;p?g=p.l:g=c.V++;const I=pr(c.J);ze(I,"SID",c.M),ze(I,"RID",g),ze(I,"AID",c.K),Sl(c,I),c.u&&c.o&&Lp(I,c.u,c.o),g=new mi(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),p&&(c.i=p.G.concat(c.i)),p=xE(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Mp(c.h,g),Pp(g,I,p)}function Sl(c,p){c.H&&se(c.H,function(g,I){ze(p,I,g)}),c.l&&se({},function(g,I){ze(p,I,g)})}function xE(c,p,g){g=Math.min(c.i.length,g);const I=c.l?u(c.l.Ka,c.l,c):null;e:{var F=c.i;let pe=-1;for(;;){const yt=["count="+g];pe==-1?g>0?(pe=F[0].g,yt.push("ofs="+pe)):pe=0:yt.push("ofs="+pe);let De=!0;for(let Et=0;Et<g;Et++){var j=F[Et].g;const mr=F[Et].map;if(j-=pe,j<0)pe=Math.max(0,F[Et].g-100),De=!1;else try{j="req"+j+"_"||"";try{var J=mr instanceof Map?mr:Object.entries(mr);for(const[Rs,vi]of J){let wi=vi;a(vi)&&(wi=Ip(vi)),yt.push(j+Rs+"="+encodeURIComponent(wi))}}catch(Rs){throw yt.push(j+"type="+encodeURIComponent("_badmap")),Rs}}catch{I&&I(mr)}}if(De){J=yt.join("&");break e}}J=void 0}return c=c.i.splice(0,g),p.G=c,J}function ME(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;U||C(),z||(U(),z=!0),A.add(p,c),c.A=0}}function Fp(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=ul(u(c.Da,c),LE(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,OE(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=ul(u(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Kt(10),Mu(this),OE(this))};function jp(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function OE(c){c.g=new mi(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=pr(c.na);ze(p,"RID","rpc"),ze(p,"SID",c.M),ze(p,"AID",c.K),ze(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&ze(p,"TO",c.ia),ze(p,"TYPE","xmlhttp"),Sl(c,p),c.u&&c.o&&Lp(p,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=Ru(pr(p)),g.u=null,g.R=!0,lE(g,c)}t.Va=function(){this.C!=null&&(this.C=null,Mu(this),Fp(this),Kt(19))};function Du(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function DE(c,p){var g=null;if(c.g==p){Du(c),jp(c),c.g=null;var I=2}else if(xp(c.h,p))g=p.G,pE(c.h,p),I=1;else return;if(c.I!=0){if(p.o)if(I==1){g=p.u?p.u.length:0,p=Date.now()-p.F;var F=c.D;I=bu(),it(I,new rE(I,g)),Ou(c)}else ME(c);else if(F=p.m,F==3||F==0&&p.X>0||!(I==1&&wM(c,p)||I==2&&Fp(c)))switch(g&&g.length>0&&(p=c.h,p.i=p.i.concat(g)),F){case 1:Ps(c,5);break;case 4:Ps(c,10);break;case 3:Ps(c,6);break;default:Ps(c,2)}}}function LE(c,p){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*p}function Ps(c,p){if(c.j.info("Error code "+p),p==2){var g=u(c.bb,c),I=c.Ua;const F=!I;I=new gi(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||pl(I,"https"),Ru(I),F?pM(I.toString(),g):mM(I.toString(),g)}else Kt(2);c.I=0,c.l&&c.l.pa(p),VE(c),RE(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Kt(2)):(this.j.info("Failed to ping google.com"),Kt(1))};function VE(c){if(c.I=0,c.ja=[],c.l){const p=mE(c.h);(p.length!=0||c.i.length!=0)&&(E(c.ja,p),E(c.ja,c.i),c.h.i.length=0,w(c.i),c.i.length=0),c.l.oa()}}function FE(c,p,g){var I=g instanceof gi?pr(g):new gi(g);if(I.g!="")p&&(I.g=p+"."+I.g),ml(I,I.u);else{var F=o.location;I=F.protocol,p=p?p+"."+F.hostname:F.hostname,F=+F.port;const j=new gi(null);I&&pl(j,I),p&&(j.g=p),F&&ml(j,F),g&&(j.h=g),I=j}return g=c.G,p=c.wa,g&&p&&ze(I,g,p),ze(I,"VER",c.ka),Sl(c,I),I}function jE(c,p,g){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new tt(new Dp({ab:g})):new tt(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function UE(){}t=UE.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Lu(){}Lu.prototype.g=function(c,p){return new _n(c,p)};function _n(c,p){Qe.call(this),this.g=new PE(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!N(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!N(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new Lo(this)}f(_n,Qe),_n.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){Vp(this.g)},_n.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=Ip(c),c=g);p.i.push(new oM(p.Ya++,c)),p.I==3&&Ou(p)},_n.prototype.N=function(){this.g.l=null,delete this.j,Vp(this.g),delete this.g,_n.Z.N.call(this)};function $E(c){Cp.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const g in p){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}f($E,Cp);function BE(){kp.call(this),this.status=1}f(BE,kp);function Lo(c){this.g=c}f(Lo,UE),Lo.prototype.ra=function(){it(this.g,"a")},Lo.prototype.qa=function(c){it(this.g,new $E(c))},Lo.prototype.pa=function(c){it(this.g,new BE)},Lo.prototype.oa=function(){it(this.g,"b")},Lu.prototype.createWebChannel=Lu.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,XA=function(){return new Lu},YA=function(){return bu()},JA=ks,ay={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Au.NO_ERROR=0,Au.TIMEOUT=8,Au.HTTP_ERROR=6,Ud=Au,iE.COMPLETE="complete",QA=iE,Zw.EventType=ll,ll.OPEN="a",ll.CLOSE="b",ll.ERROR="c",ll.MESSAGE="d",Qe.prototype.listen=Qe.prototype.J,Wl=Zw,tt.prototype.listenOnce=tt.prototype.K,tt.prototype.getLastError=tt.prototype.Ha,tt.prototype.getLastErrorCode=tt.prototype.ya,tt.prototype.getStatus=tt.prototype.ca,tt.prototype.getResponseJson=tt.prototype.La,tt.prototype.getResponseText=tt.prototype.la,tt.prototype.send=tt.prototype.ea,tt.prototype.setWithCredentials=tt.prototype.Fa,KA=tt}).apply(typeof nd<"u"?nd:typeof self<"u"?self:typeof window<"u"?window:{});const jS="@firebase/firestore",US="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Za="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo=new au("@firebase/firestore");function Uo(){return lo.logLevel}function ee(t,...e){if(lo.logLevel<=ge.DEBUG){const n=e.map(kv);lo.debug(`Firestore (${Za}): ${t}`,...n)}}function ai(t,...e){if(lo.logLevel<=ge.ERROR){const n=e.map(kv);lo.error(`Firestore (${Za}): ${t}`,...n)}}function Ra(t,...e){if(lo.logLevel<=ge.WARN){const n=e.map(kv);lo.warn(`Firestore (${Za}): ${t}`,...n)}}function kv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,ZA(t,r,n)}function ZA(t,e,n){let r=`FIRESTORE (${Za}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ai(r),new Error(r)}function Re(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||ZA(e,i,r)}function de(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Z extends fr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Jj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ut.UNAUTHENTICATED))}shutdown(){}}class Yj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Xj{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Re(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Yi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Yi,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Yi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Re(typeof r.accessToken=="string",31837,{l:r}),new eP(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Re(e===null||typeof e=="string",2055,{h:e}),new Ut(e)}}class Zj{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class e4{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new Zj(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class $S{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class t4{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,En(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Re(this.o===void 0,3512);const r=s=>{s.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new $S(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Re(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new $S(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=n4(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function ve(t,e){return t<e?-1:t>e?1:0}function ly(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return Em(i)===Em(s)?ve(i,s):Em(i)?1:-1}return ve(t.length,e.length)}const r4=55296,i4=57343;function Em(t){const e=t.charCodeAt(0);return e>=r4&&e<=i4}function Na(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS="__name__";class _r{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ae(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return _r.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof _r?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=_r.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return ve(e.length,n.length)}static compareSegments(e,n){const r=_r.isNumericId(e),i=_r.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?_r.extractNumericId(e).compare(_r.extractNumericId(n)):ly(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ji.fromString(e.substring(4,e.length-2))}}class $e extends _r{construct(e,n,r){return new $e(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Z(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new $e(n)}static emptyPath(){return new $e([])}}const s4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xt extends _r{construct(e,n,r){return new xt(e,n,r)}static isValidIdentifier(e){return s4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===BS}static keyField(){return new xt([BS])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new Z(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Z(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Z(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new Z(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xt(n)}static emptyPath(){return new xt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie($e.fromString(e))}static fromName(e){return new ie($e.fromString(e).popFirst(5))}static empty(){return new ie($e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$e.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return $e.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new $e(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tP(t,e,n){if(!n)throw new Z(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function o4(t,e,n,r){if(e===!0&&r===!0)throw new Z(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function zS(t){if(!ie.isDocumentKey(t))throw new Z(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function WS(t){if(ie.isDocumentKey(t))throw new Z(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function nP(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Ff(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae(12329,{type:typeof t})}function Bn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Z(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ff(t);throw new Z(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(t,e){const n={typeString:t};return e&&(n.value=e),n}function hu(t,e){if(!nP(t))throw new Z(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new Z(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qS=-62135596800,HS=1e6;class He{static now(){return He.fromMillis(Date.now())}static fromDate(e){return He.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*HS);return new He(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Z(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Z(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<qS)throw new Z(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Z(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/HS}_compareTo(e){return this.seconds===e.seconds?ve(this.nanoseconds,e.nanoseconds):ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:He._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(hu(e,He._jsonSchema))return new He(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-qS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}He._jsonSchemaVersion="firestore/timestamp/1.0",He._jsonSchema={type:mt("string",He._jsonSchemaVersion),seconds:mt("number"),nanoseconds:mt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{static fromTimestamp(e){return new ce(e)}static min(){return new ce(new He(0,0))}static max(){return new ce(new He(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc=-1;function a4(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ce.fromTimestamp(r===1e9?new He(n+1,0):new He(n,r));return new rs(i,ie.empty(),e)}function l4(t){return new rs(t.readTime,t.key,Bc)}class rs{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new rs(ce.min(),ie.empty(),Bc)}static max(){return new rs(ce.max(),ie.empty(),Bc)}}function c4(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ie.comparator(t.documentKey,e.documentKey),n!==0?n:ve(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class d4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function el(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==u4)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new W((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof W?n:W.resolve(n)}catch(n){return W.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):W.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):W.reject(n)}static resolve(e){return new W((n,r)=>{n(e)})}static reject(e){return new W((n,r)=>{r(e)})}static waitFor(e){return new W((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=W.resolve(!1);for(const r of e)n=n.next(i=>i?W.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new W((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new W((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function h4(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function tl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}jf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Av=-1;function Uf(t){return t==null}function Dh(t){return t===0&&1/t==-1/0}function f4(t){return typeof t=="number"&&Number.isInteger(t)&&!Dh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP="";function p4(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=GS(e)),e=m4(t.get(n),e);return GS(e)}function m4(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case rP:n+="";break;default:n+=s}}return n}function GS(t){return t+rP+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ss(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function iP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gt=class cy{constructor(e,n){this.comparator=e,this.root=n||Xi.EMPTY}insert(e,n){return new cy(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Xi.BLACK,null,null))}remove(e){return new cy(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xi.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rd(this.root,e,this.comparator,!1)}getReverseIterator(){return new rd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rd(this.root,e,this.comparator,!0)}},rd=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Xi=class Vr{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Vr.RED,this.left=i??Vr.EMPTY,this.right=s??Vr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Vr(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Vr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Vr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ae(27949);return e+(this.isRed()?0:1)}};Xi.EMPTY=null,Xi.RED=!0,Xi.BLACK=!1;Xi.EMPTY=new class{constructor(){this.size=0}get key(){throw ae(57766)}get value(){throw ae(16141)}get color(){throw ae(16727)}get left(){throw ae(29726)}get right(){throw ae(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Xi(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.comparator=e,this.data=new gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new QS(this.data.getIterator())}getIteratorFrom(e){return new QS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof wt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new wt(this.comparator);return n.data=e,n}}class QS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.fields=e,e.sort(xt.comparator)}static empty(){return new Tn([])}unionWith(e){let n=new wt(xt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Tn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Na(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new sP("Invalid base64 string: "+s):s}}(e);return new Lt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Lt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Lt.EMPTY_BYTE_STRING=new Lt("");const g4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function is(t){if(Re(!!t,39018),typeof t=="string"){let e=0;const n=g4.exec(t);if(Re(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ot(t.seconds),nanos:ot(t.nanos)}}function ot(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ss(t){return typeof t=="string"?Lt.fromBase64String(t):Lt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP="server_timestamp",aP="__type__",lP="__previous_value__",cP="__local_write_time__";function Pv(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[aP])==null?void 0:r.stringValue)===oP}function $f(t){const e=t.mapValue.fields[lP];return Pv(e)?$f(e):e}function zc(t){const e=is(t.mapValue.fields[cP].timestampValue);return new He(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e,n,r,i,s,o,a,l,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=d}}const Lh="(default)";class Wc{constructor(e,n){this.projectId=e,this.database=n||Lh}static empty(){return new Wc("","")}get isDefaultDatabase(){return this.database===Lh}isEqual(e){return e instanceof Wc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uP="__type__",_4="__max__",id={mapValue:{}},dP="__vector__",Vh="value";function os(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Pv(t)?4:w4(t)?9007199254740991:v4(t)?10:11:ae(28295,{value:t})}function xr(t,e){if(t===e)return!0;const n=os(t);if(n!==os(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zc(t).isEqual(zc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=is(i.timestampValue),a=is(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ss(i.bytesValue).isEqual(ss(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ot(i.geoPointValue.latitude)===ot(s.geoPointValue.latitude)&&ot(i.geoPointValue.longitude)===ot(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ot(i.integerValue)===ot(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ot(i.doubleValue),a=ot(s.doubleValue);return o===a?Dh(o)===Dh(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Na(t.arrayValue.values||[],e.arrayValue.values||[],xr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(KS(o)!==KS(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!xr(o[l],a[l])))return!1;return!0}(t,e);default:return ae(52216,{left:t})}}function qc(t,e){return(t.values||[]).find(n=>xr(n,e))!==void 0}function xa(t,e){if(t===e)return 0;const n=os(t),r=os(e);if(n!==r)return ve(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ve(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=ot(s.integerValue||s.doubleValue),l=ot(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return JS(t.timestampValue,e.timestampValue);case 4:return JS(zc(t),zc(e));case 5:return ly(t.stringValue,e.stringValue);case 6:return function(s,o){const a=ss(s),l=ss(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=ve(a[u],l[u]);if(d!==0)return d}return ve(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ve(ot(s.latitude),ot(o.latitude));return a!==0?a:ve(ot(s.longitude),ot(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return YS(t.arrayValue,e.arrayValue);case 10:return function(s,o){var m,w,E,v;const a=s.fields||{},l=o.fields||{},u=(m=a[Vh])==null?void 0:m.arrayValue,d=(w=l[Vh])==null?void 0:w.arrayValue,f=ve(((E=u==null?void 0:u.values)==null?void 0:E.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return f!==0?f:YS(u,d)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===id.mapValue&&o===id.mapValue)return 0;if(s===id.mapValue)return 1;if(o===id.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const m=ly(l[f],d[f]);if(m!==0)return m;const w=xa(a[l[f]],u[d[f]]);if(w!==0)return w}return ve(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ae(23264,{he:n})}}function JS(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ve(t,e);const n=is(t),r=is(e),i=ve(n.seconds,r.seconds);return i!==0?i:ve(n.nanos,r.nanos)}function YS(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=xa(n[i],r[i]);if(s)return s}return ve(n.length,r.length)}function Ma(t){return uy(t)}function uy(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=is(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ss(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=uy(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${uy(n.fields[o])}`;return i+"}"}(t.mapValue):ae(61005,{value:t})}function $d(t){switch(os(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$f(t);return e?16+$d(e):16;case 5:return 2*t.stringValue.length;case 6:return ss(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+$d(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Ss(r.fields,(s,o)=>{i+=s.length+$d(o)}),i}(t.mapValue);default:throw ae(13486,{value:t})}}function XS(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function dy(t){return!!t&&"integerValue"in t}function Rv(t){return!!t&&"arrayValue"in t}function ZS(t){return!!t&&"nullValue"in t}function eT(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Bd(t){return!!t&&"mapValue"in t}function v4(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[uP])==null?void 0:r.stringValue)===dP}function lc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ss(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=lc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=lc(t.arrayValue.values[n]);return e}return{...t}}function w4(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===_4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.value=e}static empty(){return new an({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Bd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=lc(n)}setAll(e){let n=xt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=lc(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Bd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return xr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Bd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ss(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new an(lc(this.value))}}function hP(t){const e=[];return Ss(t.fields,(n,r)=>{const i=new xt([n]);if(Bd(r)){const s=hP(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Tn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Bt(e,0,ce.min(),ce.min(),ce.min(),an.empty(),0)}static newFoundDocument(e,n,r,i){return new Bt(e,1,n,ce.min(),r,i,0)}static newNoDocument(e,n){return new Bt(e,2,n,ce.min(),ce.min(),an.empty(),0)}static newUnknownDocument(e,n){return new Bt(e,3,n,ce.min(),ce.min(),an.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=an.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=an.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,n){this.position=e,this.inclusive=n}}function tT(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ie.comparator(ie.fromName(o.referenceValue),n.key):r=xa(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function nT(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!xr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e,n="asc"){this.field=e,this.dir=n}}function E4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{}class pt extends fP{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new T4(e,n,r):n==="array-contains"?new k4(e,r):n==="in"?new b4(e,r):n==="not-in"?new A4(e,r):n==="array-contains-any"?new P4(e,r):new pt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new I4(e,r):new C4(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(xa(n,this.value)):n!==null&&os(this.value)===os(n)&&this.matchesComparison(xa(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class dr extends fP{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new dr(e,n)}matches(e){return pP(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function pP(t){return t.op==="and"}function mP(t){return S4(t)&&pP(t)}function S4(t){for(const e of t.filters)if(e instanceof dr)return!1;return!0}function hy(t){if(t instanceof pt)return t.field.canonicalString()+t.op.toString()+Ma(t.value);if(mP(t))return t.filters.map(e=>hy(e)).join(",");{const e=t.filters.map(n=>hy(n)).join(",");return`${t.op}(${e})`}}function gP(t,e){return t instanceof pt?function(r,i){return i instanceof pt&&r.op===i.op&&r.field.isEqual(i.field)&&xr(r.value,i.value)}(t,e):t instanceof dr?function(r,i){return i instanceof dr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&gP(o,i.filters[a]),!0):!1}(t,e):void ae(19439)}function yP(t){return t instanceof pt?function(n){return`${n.field.canonicalString()} ${n.op} ${Ma(n.value)}`}(t):t instanceof dr?function(n){return n.op.toString()+" {"+n.getFilters().map(yP).join(" ,")+"}"}(t):"Filter"}class T4 extends pt{constructor(e,n,r){super(e,n,r),this.key=ie.fromName(r.referenceValue)}matches(e){const n=ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class I4 extends pt{constructor(e,n){super(e,"in",n),this.keys=_P("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class C4 extends pt{constructor(e,n){super(e,"not-in",n),this.keys=_P("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function _P(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ie.fromName(r.referenceValue))}class k4 extends pt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Rv(n)&&qc(n.arrayValue,this.value)}}class b4 extends pt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&qc(this.value.arrayValue,n)}}class A4 extends pt{constructor(e,n){super(e,"not-in",n)}matches(e){if(qc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!qc(this.value.arrayValue,n)}}class P4 extends pt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Rv(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>qc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function rT(t,e=null,n=[],r=[],i=null,s=null,o=null){return new R4(t,e,n,r,i,s,o)}function Nv(t){const e=de(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>hy(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Uf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ma(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ma(r)).join(",")),e.Te=n}return e.Te}function xv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!E4(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!gP(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!nT(t.startAt,e.startAt)&&nT(t.endAt,e.endAt)}function fy(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function N4(t,e,n,r,i,s,o,a){return new nl(t,e,n,r,i,s,o,a)}function Bf(t){return new nl(t)}function iT(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function vP(t){return t.collectionGroup!==null}function cc(t){const e=de(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new wt(xt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Hc(s,r))}),n.has(xt.keyField().canonicalString())||e.Ie.push(new Hc(xt.keyField(),r))}return e.Ie}function Ar(t){const e=de(t);return e.Ee||(e.Ee=x4(e,cc(t))),e.Ee}function x4(t,e){if(t.limitType==="F")return rT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Hc(i.field,s)});const n=t.endAt?new Fh(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Fh(t.startAt.position,t.startAt.inclusive):null;return rT(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function py(t,e){const n=t.filters.concat([e]);return new nl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function my(t,e,n){return new nl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function zf(t,e){return xv(Ar(t),Ar(e))&&t.limitType===e.limitType}function wP(t){return`${Nv(Ar(t))}|lt:${t.limitType}`}function $o(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>yP(i)).join(", ")}]`),Uf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Ma(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Ma(i)).join(",")),`Target(${r})`}(Ar(t))}; limitType=${t.limitType})`}function Wf(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ie.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of cc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=tT(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,cc(r),i)||r.endAt&&!function(o,a,l){const u=tT(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,cc(r),i))}(t,e)}function M4(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function EP(t){return(e,n)=>{let r=!1;for(const i of cc(t)){const s=O4(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function O4(t,e,n){const r=t.field.isKeyField()?ie.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?xa(l,u):ae(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ss(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return iP(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4=new gt(ie.comparator);function li(){return D4}const SP=new gt(ie.comparator);function ql(...t){let e=SP;for(const n of t)e=e.insert(n.key,n);return e}function TP(t){let e=SP;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function zs(){return uc()}function IP(){return uc()}function uc(){return new Co(t=>t.toString(),(t,e)=>t.isEqual(e))}const L4=new gt(ie.comparator),V4=new wt(ie.comparator);function Ee(...t){let e=V4;for(const n of t)e=e.add(n);return e}const F4=new wt(ve);function j4(){return F4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dh(e)?"-0":e}}function CP(t){return{integerValue:""+t}}function U4(t,e){return f4(e)?CP(e):Mv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(){this._=void 0}}function $4(t,e,n){return t instanceof Gc?function(i,s){const o={fields:{[aP]:{stringValue:oP},[cP]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Pv(s)&&(s=$f(s)),s&&(o.fields[lP]=s),{mapValue:o}}(n,e):t instanceof Kc?bP(t,e):t instanceof Qc?AP(t,e):function(i,s){const o=kP(i,s),a=sT(o)+sT(i.Ae);return dy(o)&&dy(i.Ae)?CP(a):Mv(i.serializer,a)}(t,e)}function B4(t,e,n){return t instanceof Kc?bP(t,e):t instanceof Qc?AP(t,e):n}function kP(t,e){return t instanceof jh?function(r){return dy(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Gc extends qf{}class Kc extends qf{constructor(e){super(),this.elements=e}}function bP(t,e){const n=PP(e);for(const r of t.elements)n.some(i=>xr(i,r))||n.push(r);return{arrayValue:{values:n}}}class Qc extends qf{constructor(e){super(),this.elements=e}}function AP(t,e){let n=PP(e);for(const r of t.elements)n=n.filter(i=>!xr(i,r));return{arrayValue:{values:n}}}class jh extends qf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function sT(t){return ot(t.integerValue||t.doubleValue)}function PP(t){return Rv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e,n){this.field=e,this.transform=n}}function W4(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Kc&&i instanceof Kc||r instanceof Qc&&i instanceof Qc?Na(r.elements,i.elements,xr):r instanceof jh&&i instanceof jh?xr(r.Ae,i.Ae):r instanceof Gc&&i instanceof Gc}(t.transform,e.transform)}class q4{constructor(e,n){this.version=e,this.transformResults=n}}class zn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new zn}static exists(e){return new zn(void 0,e)}static updateTime(e){return new zn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Hf{}function RP(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ov(t.key,zn.none()):new fu(t.key,t.data,zn.none());{const n=t.data,r=an.empty();let i=new wt(xt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ts(t.key,r,new Tn(i.toArray()),zn.none())}}function H4(t,e,n){t instanceof fu?function(i,s,o){const a=i.value.clone(),l=aT(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ts?function(i,s,o){if(!zd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=aT(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(NP(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function dc(t,e,n,r){return t instanceof fu?function(s,o,a,l){if(!zd(s.precondition,o))return a;const u=s.value.clone(),d=lT(s.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ts?function(s,o,a,l){if(!zd(s.precondition,o))return a;const u=lT(s.fieldTransforms,l,o),d=o.data;return d.setAll(NP(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return zd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function G4(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=kP(r.transform,i||null);s!=null&&(n===null&&(n=an.empty()),n.set(r.field,s))}return n||null}function oT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Na(r,i,(s,o)=>W4(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class fu extends Hf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ts extends Hf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function NP(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function aT(t,e,n){const r=new Map;Re(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,B4(o,a,n[i]))}return r}function lT(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,$4(s,o,e))}return r}class Ov extends Hf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class K4 extends Hf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&H4(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=dc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=dc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=IP();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=RP(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ce.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ee())}isEqual(e){return this.batchId===e.batchId&&Na(this.mutations,e.mutations,(n,r)=>oT(n,r))&&Na(this.baseMutations,e.baseMutations,(n,r)=>oT(n,r))}}class Dv{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Re(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return L4}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Dv(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt,Ie;function X4(t){switch(t){case B.OK:return ae(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return ae(15467,{code:t})}}function xP(t){if(t===void 0)return ai("GRPC error has no .code"),B.UNKNOWN;switch(t){case dt.OK:return B.OK;case dt.CANCELLED:return B.CANCELLED;case dt.UNKNOWN:return B.UNKNOWN;case dt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case dt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case dt.INTERNAL:return B.INTERNAL;case dt.UNAVAILABLE:return B.UNAVAILABLE;case dt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case dt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case dt.NOT_FOUND:return B.NOT_FOUND;case dt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case dt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case dt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case dt.ABORTED:return B.ABORTED;case dt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case dt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case dt.DATA_LOSS:return B.DATA_LOSS;default:return ae(39323,{code:t})}}(Ie=dt||(dt={}))[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eU=new Ji([4294967295,4294967295],0);function cT(t){const e=Z4().encode(t),n=new GA;return n.update(e),new Uint8Array(n.digest())}function uT(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ji([n,r],0),new Ji([i,s],0)]}class Lv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Hl(`Invalid padding: ${n}`);if(r<0)throw new Hl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Hl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Hl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ji.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(Ji.fromNumber(r)));return i.compare(eU)===1&&(i=new Ji([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=cT(e),[r,i]=uT(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Lv(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=cT(e),[r,i]=uT(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Hl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,pu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Gf(ce.min(),i,new gt(ve),li(),Ee())}}class pu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new pu(r,n,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class MP{constructor(e,n){this.targetId=e,this.Ce=n}}class OP{constructor(e,n,r=Lt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class dT{constructor(){this.ve=0,this.Fe=hT(),this.Me=Lt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ee(),n=Ee(),r=Ee();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ae(38017,{changeType:s})}}),new pu(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=hT()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Re(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class tU{constructor(e){this.Ge=e,this.ze=new Map,this.je=li(),this.Je=sd(),this.He=sd(),this.Ye=new gt(ve)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ae(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(fy(s))if(r===0){const o=new ie(s.path);this.et(n,o,Bt.newNoDocument(o,ce.min()))}else Re(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=ss(r).toUint8Array()}catch(l){if(l instanceof sP)return Ra("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Lv(o,i,s)}catch(l){return Ra(l instanceof Hl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&fy(a.target)){const l=new ie(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Bt.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=Ee();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new Gf(e,n,this.Ye,this.je,r);return this.je=li(),this.Je=sd(),this.He=sd(),this.Ye=new gt(ve),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new dT,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new wt(ve),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new wt(ve),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new dT),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function sd(){return new gt(ie.comparator)}function hT(){return new gt(ie.comparator)}const nU={asc:"ASCENDING",desc:"DESCENDING"},rU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iU={and:"AND",or:"OR"};class sU{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function gy(t,e){return t.useProto3Json||Uf(e)?e:{value:e}}function Uh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DP(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function oU(t,e){return Uh(t,e.toTimestamp())}function Pr(t){return Re(!!t,49232),ce.fromTimestamp(function(n){const r=is(n);return new He(r.seconds,r.nanos)}(t))}function Vv(t,e){return yy(t,e).canonicalString()}function yy(t,e){const n=function(i){return new $e(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function LP(t){const e=$e.fromString(t);return Re($P(e),10190,{key:e.toString()}),e}function _y(t,e){return Vv(t.databaseId,e.path)}function Sm(t,e){const n=LP(e);if(n.get(1)!==t.databaseId.projectId)throw new Z(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Z(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ie(FP(n))}function VP(t,e){return Vv(t.databaseId,e)}function aU(t){const e=LP(t);return e.length===4?$e.emptyPath():FP(e)}function vy(t){return new $e(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function FP(t){return Re(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function fT(t,e,n){return{name:_y(t,e),fields:n.value.mapValue.fields}}function lU(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ae(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(Re(d===void 0||typeof d=="string",58123),Lt.fromBase64String(d||"")):(Re(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Lt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?B.UNKNOWN:xP(u.code);return new Z(d,u.message||"")}(o);n=new OP(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Sm(t,r.document.name),s=Pr(r.document.updateTime),o=r.document.createTime?Pr(r.document.createTime):ce.min(),a=new an({mapValue:{fields:r.document.fields}}),l=Bt.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Wd(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Sm(t,r.document),s=r.readTime?Pr(r.readTime):ce.min(),o=Bt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Wd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Sm(t,r.document),s=r.removedTargetIds||[];n=new Wd([],s,i,null)}else{if(!("filter"in e))return ae(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new Y4(i,s),a=r.targetId;n=new MP(a,o)}}return n}function cU(t,e){let n;if(e instanceof fu)n={update:fT(t,e.key,e.value)};else if(e instanceof Ov)n={delete:_y(t,e.key)};else if(e instanceof Ts)n={update:fT(t,e.key,e.data),updateMask:_U(e.fieldMask)};else{if(!(e instanceof K4))return ae(16599,{Vt:e.type});n={verify:_y(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Gc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Kc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Qc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof jh)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw ae(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:oU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ae(27497)}(t,e.precondition)),n}function uU(t,e){return t&&t.length>0?(Re(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?Pr(i.updateTime):Pr(s);return o.isEqual(ce.min())&&(o=Pr(s)),new q4(o,i.transformResults||[])}(n,e))):[]}function dU(t,e){return{documents:[VP(t,e.path)]}}function hU(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=VP(t,i);const s=function(u){if(u.length!==0)return UP(dr.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(m){return{field:Bo(m.field),direction:mU(m.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=gy(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function fU(t){let e=aU(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Re(r===1,65062);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(f){const m=jP(f);return m instanceof dr&&mP(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(E){return new Hc(zo(E.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Uf(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(f){const m=!!f.before,w=f.values||[];return new Fh(w,m)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const m=!f.before,w=f.values||[];return new Fh(w,m)}(n.endAt)),N4(e,i,o,s,a,"F",l,u)}function pU(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function jP(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=zo(n.unaryFilter.field);return pt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=zo(n.unaryFilter.field);return pt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=zo(n.unaryFilter.field);return pt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=zo(n.unaryFilter.field);return pt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ae(61313);default:return ae(60726)}}(t):t.fieldFilter!==void 0?function(n){return pt.create(zo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ae(58110);default:return ae(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return dr.create(n.compositeFilter.filters.map(r=>jP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ae(1026)}}(n.compositeFilter.op))}(t):ae(30097,{filter:t})}function mU(t){return nU[t]}function gU(t){return rU[t]}function yU(t){return iU[t]}function Bo(t){return{fieldPath:t.canonicalString()}}function zo(t){return xt.fromServerFormat(t.fieldPath)}function UP(t){return t instanceof pt?function(n){if(n.op==="=="){if(eT(n.value))return{unaryFilter:{field:Bo(n.field),op:"IS_NAN"}};if(ZS(n.value))return{unaryFilter:{field:Bo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(eT(n.value))return{unaryFilter:{field:Bo(n.field),op:"IS_NOT_NAN"}};if(ZS(n.value))return{unaryFilter:{field:Bo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bo(n.field),op:gU(n.op),value:n.value}}}(t):t instanceof dr?function(n){const r=n.getFilters().map(i=>UP(i));return r.length===1?r[0]:{compositeFilter:{op:yU(n.op),filters:r}}}(t):ae(54877,{filter:t})}function _U(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function $P(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e,n,r,i,s=ce.min(),o=ce.min(),a=Lt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Fi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Fi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(e){this.yt=e}}function wU(t){const e=fU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?my(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(){this.Cn=new SU}addToCollectionParentIndex(e,n){return this.Cn.add(n),W.resolve()}getCollectionParents(e,n){return W.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return W.resolve()}deleteFieldIndex(e,n){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,n){return W.resolve()}getDocumentsMatchingTarget(e,n){return W.resolve(null)}getIndexType(e,n){return W.resolve(0)}getFieldIndexes(e,n){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,n){return W.resolve(rs.min())}getMinOffsetFromCollectionGroup(e,n){return W.resolve(rs.min())}updateCollectionGroup(e,n,r){return W.resolve()}updateIndexEntries(e,n){return W.resolve()}}class SU{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new wt($e.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new wt($e.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},BP=41943040;class sn{static withCacheSize(e){return new sn(e,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sn.DEFAULT_COLLECTION_PERCENTILE=10,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sn.DEFAULT=new sn(BP,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sn.DISABLED=new sn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Oa(0)}static cr(){return new Oa(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="LruGarbageCollector",TU=1048576;function gT([t,e],[n,r]){const i=ve(t,n);return i===0?ve(e,r):i}class IU{constructor(e){this.Ir=e,this.buffer=new wt(gT),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();gT(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class CU{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(mT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){tl(n)?ee(mT,"Ignoring IndexedDB error during garbage collection: ",n):await el(n)}await this.Vr(3e5)})}}class kU{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return W.resolve(jf.ce);const r=new IU(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),W.resolve(pT)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),pT):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),Uo()<=ge.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(u-l)+`ms
Total Duration: ${u-d}ms`),W.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function bU(t,e){return new kU(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(){this.changes=new Co(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Bt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?W.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RU{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&dc(r.mutation,i,Tn.empty(),He.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ee()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ee()){const i=zs();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ql();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=zs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ee()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=li();const o=uc(),a=function(){return uc()}();return n.forEach((l,u)=>{const d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof Ts)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),dc(d.mutation,u,d.mutation.getFieldMask(),He.now())):o.set(u.key,Tn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>a.set(u,new PU(d,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=uc();let i=new gt((o,a)=>o-a),s=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let d=r.get(l)||Tn.empty();d=a.applyToLocalView(u,d),r.set(l,d);const f=(i.get(a.batchId)||Ee()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,f=IP();d.forEach(m=>{if(!s.has(m)){const w=RP(n.get(m),r.get(m));w!==null&&f.set(m,w),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return W.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):vP(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):W.resolve(zs());let a=Bc,l=s;return o.next(u=>W.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(d)?W.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{l=l.insert(d,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Ee())).next(d=>({batchId:a,changes:TP(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ie(n)).next(r=>{let i=ql();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=ql();return this.indexManager.getCollectionParents(e,s).next(a=>W.forEach(a,l=>{const u=function(f,m){return new nl(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Bt.newInvalidDocument(d)))});let a=ql();return o.forEach((l,u)=>{const d=s.get(l);d!==void 0&&dc(d.mutation,u,Tn.empty(),He.now()),Wf(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NU{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return W.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Pr(i.createTime)}}(n)),W.resolve()}getNamedQuery(e,n){return W.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:wU(i.bundledQuery),readTime:Pr(i.readTime)}}(n)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(){this.overlays=new gt(ie.comparator),this.qr=new Map}getOverlay(e,n){return W.resolve(this.overlays.get(n))}getOverlays(e,n){const r=zs();return W.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),W.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),W.resolve()}getOverlaysForCollection(e,n,r){const i=zs(),s=n.length+1,o=new ie(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return W.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new gt((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=zs(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=zs(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return W.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new J4(n,r));let s=this.qr.get(n);s===void 0&&(s=Ee(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MU{constructor(){this.sessionToken=Lt.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(){this.Qr=new wt(Tt.$r),this.Ur=new wt(Tt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Tt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Tt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ie(new $e([])),r=new Tt(n,e),i=new Tt(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ie(new $e([])),r=new Tt(n,e),i=new Tt(n,e+1);let s=Ee();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Tt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Tt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ie.comparator(e.key,n.key)||ve(e.Yr,n.Yr)}static Kr(e,n){return ve(e.Yr,n.Yr)||ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new wt(Tt.$r)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Q4(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new Tt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return W.resolve(o)}lookupMutationBatch(e,n){return W.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return W.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?Av:this.tr-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Tt(n,0),i=new Tt(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),W.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new wt(ve);return n.forEach(i=>{const s=new Tt(i,0),o=new Tt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),W.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ie.isDocumentKey(s)||(s=s.child(""));const o=new Tt(new ie(s),0);let a=new wt(ve);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),W.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Re(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return W.forEach(n.mutations,i=>{const s=new Tt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Tt(n,0),i=this.Zr.firstAfterOrEqual(r);return W.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(e){this.ri=e,this.docs=function(){return new gt(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return W.resolve(r?r.document.mutableCopy():Bt.newInvalidDocument(n))}getEntries(e,n){let r=li();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Bt.newInvalidDocument(i))}),W.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=li();const o=n.path,a=new ie(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||c4(l4(d),r)<=0||(i.has(d.key)||Wf(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return W.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ae(9500)}ii(e,n){return W.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new LU(this)}getSize(e){return W.resolve(this.size)}}class LU extends AU{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),W.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(e){this.persistence=e,this.si=new Co(n=>Nv(n),xv),this.lastRemoteSnapshotVersion=ce.min(),this.highestTargetId=0,this.oi=0,this._i=new Fv,this.targetCount=0,this.ai=Oa.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),W.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Oa(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,W.resolve()}updateTargetData(e,n){return this.Pr(n),W.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),W.waitFor(s).next(()=>i)}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return W.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),W.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),W.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),W.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return W.resolve(r)}containsKey(e,n){return W.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e,n){this.ui={},this.overlays={},this.ci=new jf(0),this.li=!1,this.li=!0,this.hi=new MU,this.referenceDelegate=e(this),this.Pi=new VU(this),this.indexManager=new EU,this.remoteDocumentCache=function(i){return new DU(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new vU(n),this.Ii=new NU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new xU,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new OU(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const i=new FU(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return W.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class FU extends d4{constructor(e){super(),this.currentSequenceNumber=e}}class jv{constructor(e){this.persistence=e,this.Ri=new Fv,this.Vi=null}static mi(e){return new jv(e)}get fi(){if(this.Vi)return this.Vi;throw ae(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),W.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),W.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),W.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.fi,r=>{const i=ie.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,ce.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return W.or([()=>W.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class $h{constructor(e,n){this.persistence=e,this.pi=new Co(r=>p4(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=bU(this,n)}static mi(e,n){return new $h(e,n)}Ei(){}di(e){return W.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return W.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?W.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,ce.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),W.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),W.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),W.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),W.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=$d(e.data.value)),n}br(e,n,r){return W.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return W.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Ee(),i=Ee();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Uv(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return p2()?8:h4(Ht())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new jU;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(Uo()<=ge.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",$o(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),W.resolve()):(Uo()<=ge.DEBUG&&ee("QueryEngine","Query:",$o(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Uo()<=ge.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",$o(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ar(n))):W.resolve())}ys(e,n){if(iT(n))return W.resolve(null);let r=Ar(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=my(n,null,"F"),r=Ar(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ee(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,my(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return iT(n)||i.isEqual(ce.min())?W.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?W.resolve(null):(Uo()<=ge.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),$o(n)),this.vs(e,o,n,a4(i,Bc)).next(a=>a))})}Ds(e,n){let r=new wt(EP(e));return n.forEach((i,s)=>{Wf(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return Uo()<=ge.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",$o(n)),this.ps.getDocumentsMatchingQuery(e,n,rs.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v="LocalStore",$U=3e8;class BU{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new gt(ve),this.xs=new Co(s=>Nv(s),xv),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RU(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function zU(t,e,n,r){return new BU(t,e,n,r)}async function WP(t,e){const n=de(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Ee();for(const u of i){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of s){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function WU(t,e){const n=de(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const f=u.batch,m=f.keys();let w=W.resolve();return m.forEach(E=>{w=w.next(()=>d.getEntry(l,E)).next(v=>{const b=u.docVersions.get(E);Re(b!==null,48541),v.version.compareTo(b)<0&&(f.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),d.addEntry(v)))})}),w.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ee();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function qP(t){const e=de(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function qU(t,e){const n=de(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((d,f)=>{const m=i.get(f);if(!m)return;a.push(n.Pi.removeMatchingKeys(s,d.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(s,d.addedDocuments,f)));let w=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?w=w.withResumeToken(Lt.EMPTY_BYTE_STRING,ce.min()).withLastLimboFreeSnapshotVersion(ce.min()):d.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(d.resumeToken,r)),i=i.insert(f,w),function(v,b,S){return v.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=$U?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(m,w,d)&&a.push(n.Pi.updateTargetData(s,w))});let l=li(),u=Ee();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(HU(s,o,e.documentUpdates).next(d=>{l=d.ks,u=d.qs})),!r.isEqual(ce.min())){const d=n.Pi.getLastRemoteSnapshotVersion(s).next(f=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return W.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function HU(t,e,n){let r=Ee(),i=Ee();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=li();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ce.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ee($v,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function GU(t,e){const n=de(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Av),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function KU(t,e){const n=de(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,W.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Fi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function wy(t,e,n){const r=de(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!tl(o))throw o;ee($v,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function yT(t,e,n){const r=de(t);let i=ce.min(),s=Ee();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const f=de(l),m=f.xs.get(d);return m!==void 0?W.resolve(f.Ms.get(m)):f.Pi.getTargetData(u,d)}(r,o,Ar(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:ce.min(),n?s:Ee())).next(a=>(QU(r,M4(e),a),{documents:a,Qs:s})))}function QU(t,e,n){let r=t.Os.get(e)||ce.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class _T{constructor(){this.activeTargetIds=j4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class JU{constructor(){this.Mo=new _T,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new _T,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT="ConnectivityMonitor";class wT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(vT,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(vT,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let od=null;function Ey(){return od===null?od=function(){return 268435456+Math.round(2147483648*Math.random())}():od++,"0x"+od.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tm="RestConnection",XU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ZU{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Lh?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Ey(),a=this.zo(e,n.toUriEncodedString());ee(Tm,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),d=_s(u);return this.Jo(e,a,l,r,d).then(f=>(ee(Tm,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Ra(Tm,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Za}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=XU[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e3{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jt="WebChannelConnection";class t3 extends ZU{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Ey();return new Promise((a,l)=>{const u=new KA;u.setWithCredentials(!0),u.listenOnce(QA.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ud.NO_ERROR:const f=u.getResponseJson();ee(jt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Ud.TIMEOUT:ee(jt,`RPC '${e}' ${o} timed out`),l(new Z(B.DEADLINE_EXCEEDED,"Request time out"));break;case Ud.HTTP_ERROR:const m=u.getStatus();if(ee(jt,`RPC '${e}' ${o} failed with status:`,m,"response text:",u.getResponseText()),m>0){let w=u.getResponseJson();Array.isArray(w)&&(w=w[0]);const E=w==null?void 0:w.error;if(E&&E.status&&E.message){const v=function(S){const T=S.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(T)>=0?T:B.UNKNOWN}(E.status);l(new Z(v,E.message))}else l(new Z(B.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new Z(B.UNAVAILABLE,"Connection failed."));break;default:ae(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{ee(jt,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(i);ee(jt,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",d,r,15)})}T_(e,n,r){const i=Ey(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=XA(),a=YA(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");ee(jt,`Creating RPC '${e}' stream ${i}: ${d}`,l);const f=o.createWebChannel(d,l);this.I_(f);let m=!1,w=!1;const E=new e3({Yo:b=>{w?ee(jt,`Not sending because RPC '${e}' stream ${i} is closed:`,b):(m||(ee(jt,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),ee(jt,`RPC '${e}' stream ${i} sending:`,b),f.send(b))},Zo:()=>f.close()}),v=(b,S,T)=>{b.listen(S,k=>{try{T(k)}catch(L){setTimeout(()=>{throw L},0)}})};return v(f,Wl.EventType.OPEN,()=>{w||(ee(jt,`RPC '${e}' stream ${i} transport opened.`),E.o_())}),v(f,Wl.EventType.CLOSE,()=>{w||(w=!0,ee(jt,`RPC '${e}' stream ${i} transport closed`),E.a_(),this.E_(f))}),v(f,Wl.EventType.ERROR,b=>{w||(w=!0,Ra(jt,`RPC '${e}' stream ${i} transport errored. Name:`,b.name,"Message:",b.message),E.a_(new Z(B.UNAVAILABLE,"The operation could not be completed")))}),v(f,Wl.EventType.MESSAGE,b=>{var S;if(!w){const T=b.data[0];Re(!!T,16349);const k=T,L=(k==null?void 0:k.error)||((S=k[0])==null?void 0:S.error);if(L){ee(jt,`RPC '${e}' stream ${i} received error:`,L);const U=L.status;let z=function(R){const x=dt[R];if(x!==void 0)return xP(x)}(U),A=L.message;z===void 0&&(z=B.INTERNAL,A="Unknown error status: "+U+" with message "+L.message),w=!0,E.a_(new Z(z,A)),f.close()}else ee(jt,`RPC '${e}' stream ${i} received:`,T),E.u_(T)}}),v(a,JA.STAT_EVENT,b=>{b.stat===ay.PROXY?ee(jt,`RPC '${e}' stream ${i} detected buffering proxy`):b.stat===ay.NOPROXY&&ee(jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.__()},0),E}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Im(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf(t){return new sU(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="PersistentStream";class GP{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new HP(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(ai(n.toString()),ai("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new Z(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(ET,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee(ET,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class n3 extends GP{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=lU(this.serializer,e),r=function(s){if(!("targetChange"in s))return ce.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ce.min():o.readTime?Pr(o.readTime):ce.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=vy(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=fy(l)?{documents:dU(s,l)}:{query:hU(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=DP(s,o.resumeToken);const u=gy(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ce.min())>0){a.readTime=Uh(s,o.snapshotVersion.toTimestamp());const u=gy(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=pU(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=vy(this.serializer),n.removeTarget=e,this.q_(n)}}class r3 extends GP{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Re(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Re(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Re(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=uU(e.writeResults,e.commitTime),r=Pr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=vy(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>cU(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3{}class s3 extends i3{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Z(B.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,yy(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Z(B.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,yy(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Z(B.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class o3{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ai(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co="RemoteStore";class a3{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ko(this)&&(ee(co,"Restarting streams for network reachability change."),await async function(l){const u=de(l);u.Ea.add(4),await mu(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Qf(u)}(this))})}),this.Ra=new o3(r,i)}}async function Qf(t){if(ko(t))for(const e of t.da)await e(!0)}async function mu(t){for(const e of t.da)await e(!1)}function KP(t,e){const n=de(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),qv(n)?Wv(n):rl(n).O_()&&zv(n,e))}function Bv(t,e){const n=de(t),r=rl(n);n.Ia.delete(e),r.O_()&&QP(n,e),n.Ia.size===0&&(r.O_()?r.L_():ko(n)&&n.Ra.set("Unknown"))}function zv(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ce.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}rl(t).Y_(e)}function QP(t,e){t.Va.Ue(e),rl(t).Z_(e)}function Wv(t){t.Va=new tU({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),rl(t).start(),t.Ra.ua()}function qv(t){return ko(t)&&!rl(t).x_()&&t.Ia.size>0}function ko(t){return de(t).Ea.size===0}function JP(t){t.Va=void 0}async function l3(t){t.Ra.set("Online")}async function c3(t){t.Ia.forEach((e,n)=>{zv(t,e)})}async function u3(t,e){JP(t),qv(t)?(t.Ra.ha(e),Wv(t)):t.Ra.set("Unknown")}async function d3(t,e,n){if(t.Ra.set("Online"),e instanceof OP&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){ee(co,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Bh(t,r)}else if(e instanceof Wd?t.Va.Ze(e):e instanceof MP?t.Va.st(e):t.Va.tt(e),!n.isEqual(ce.min()))try{const r=await qP(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.Ia.get(u);d&&s.Ia.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=s.Ia.get(l);if(!d)return;s.Ia.set(l,d.withResumeToken(Lt.EMPTY_BYTE_STRING,d.snapshotVersion)),QP(s,l);const f=new Fi(d.target,l,u,d.sequenceNumber);zv(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ee(co,"Failed to raise snapshot:",r),await Bh(t,r)}}async function Bh(t,e,n){if(!tl(e))throw e;t.Ea.add(1),await mu(t),t.Ra.set("Offline"),n||(n=()=>qP(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(co,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Qf(t)})}function YP(t,e){return e().catch(n=>Bh(t,n,e))}async function Jf(t){const e=de(t),n=as(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Av;for(;h3(e);)try{const i=await GU(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,f3(e,i)}catch(i){await Bh(e,i)}XP(e)&&ZP(e)}function h3(t){return ko(t)&&t.Ta.length<10}function f3(t,e){t.Ta.push(e);const n=as(t);n.O_()&&n.X_&&n.ea(e.mutations)}function XP(t){return ko(t)&&!as(t).x_()&&t.Ta.length>0}function ZP(t){as(t).start()}async function p3(t){as(t).ra()}async function m3(t){const e=as(t);for(const n of t.Ta)e.ea(n.mutations)}async function g3(t,e,n){const r=t.Ta.shift(),i=Dv.from(r,e,n);await YP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Jf(t)}async function y3(t,e){e&&as(t).X_&&await async function(r,i){if(function(o){return X4(o)&&o!==B.ABORTED}(i.code)){const s=r.Ta.shift();as(r).B_(),await YP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Jf(r)}}(t,e),XP(t)&&ZP(t)}async function ST(t,e){const n=de(t);n.asyncQueue.verifyOperationInProgress(),ee(co,"RemoteStore received new credentials");const r=ko(n);n.Ea.add(3),await mu(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Qf(n)}async function _3(t,e){const n=de(t);e?(n.Ea.delete(2),await Qf(n)):e||(n.Ea.add(2),await mu(n),n.Ra.set("Unknown"))}function rl(t){return t.ma||(t.ma=function(n,r,i){const s=de(n);return s.sa(),new n3(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:l3.bind(null,t),t_:c3.bind(null,t),r_:u3.bind(null,t),H_:d3.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),qv(t)?Wv(t):t.Ra.set("Unknown")):(await t.ma.stop(),JP(t))})),t.ma}function as(t){return t.fa||(t.fa=function(n,r,i){const s=de(n);return s.sa(),new r3(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:p3.bind(null,t),r_:y3.bind(null,t),ta:m3.bind(null,t),na:g3.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Jf(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(co,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Yi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Hv(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Z(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Gv(t,e){if(ai("AsyncQueue",`${e}: ${t}`),tl(t))return new Z(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{static emptySet(e){return new pa(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ie.comparator(n.key,r.key):(n,r)=>ie.comparator(n.key,r.key),this.keyedMap=ql(),this.sortedSet=new gt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof pa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new pa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(){this.ga=new gt(ie.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ae(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Da{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Da(e,n,pa.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v3{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class w3{constructor(){this.queries=IT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=de(n),s=i.queries;i.queries=IT(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new Z(B.ABORTED,"Firestore shutting down"))}}function IT(){return new Co(t=>wP(t),zf)}async function eR(t,e){const n=de(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new v3,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=Gv(o,`Initialization of query '${$o(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&Kv(n)}async function tR(t,e){const n=de(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function E3(t,e){const n=de(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&Kv(n)}function S3(t,e,n){const r=de(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function Kv(t){t.Ca.forEach(e=>{e.next()})}var Sy,CT;(CT=Sy||(Sy={})).Ma="default",CT.Cache="cache";class nR{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Da(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Da.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Sy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(e){this.key=e}}class iR{constructor(e){this.key=e}}class T3{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ee(),this.mutatedKeys=Ee(),this.eu=EP(e),this.tu=new pa(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new TT,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{const m=i.get(d),w=Wf(this.query,f)?f:null,E=!!m&&this.mutatedKeys.has(m.key),v=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let b=!1;m&&w?m.data.isEqual(w.data)?E!==v&&(r.track({type:3,doc:w}),b=!0):this.su(m,w)||(r.track({type:2,doc:w}),b=!0,(l&&this.eu(w,l)>0||u&&this.eu(w,u)<0)&&(a=!0)):!m&&w?(r.track({type:0,doc:w}),b=!0):m&&!w&&(r.track({type:1,doc:m}),b=!0,(l||u)&&(a=!0)),b&&(w?(o=o.add(w),s=v?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(w,E){const v=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae(20277,{Rt:b})}};return v(w)-v(E)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new Da(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new TT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ee(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new iR(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new rR(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ee();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Da.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Qv="SyncEngine";class I3{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class C3{constructor(e){this.key=e,this.hu=!1}}class k3{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Co(a=>wP(a),zf),this.Iu=new Map,this.Eu=new Set,this.du=new gt(ie.comparator),this.Au=new Map,this.Ru=new Fv,this.Vu={},this.mu=new Map,this.fu=Oa.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function b3(t,e,n=!0){const r=uR(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await sR(r,e,n,!0),i}async function A3(t,e){const n=uR(t);await sR(n,e,!0,!1)}async function sR(t,e,n,r){const i=await KU(t.localStore,Ar(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await P3(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&KP(t.remoteStore,i),a}async function P3(t,e,n,r,i){t.pu=(f,m,w)=>async function(v,b,S,T){let k=b.view.ru(S);k.Cs&&(k=await yT(v.localStore,b.query,!1).then(({documents:A})=>b.view.ru(A,k)));const L=T&&T.targetChanges.get(b.targetId),U=T&&T.targetMismatches.get(b.targetId)!=null,z=b.view.applyChanges(k,v.isPrimaryClient,L,U);return bT(v,b.targetId,z.au),z.snapshot}(t,f,m,w);const s=await yT(t.localStore,e,!0),o=new T3(e,s.Qs),a=o.ru(s.documents),l=pu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);bT(t,n,u.au);const d=new I3(e,n,o);return t.Tu.set(e,d),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function R3(t,e,n){const r=de(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!zf(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await wy(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Bv(r.remoteStore,i.targetId),Ty(r,i.targetId)}).catch(el)):(Ty(r,i.targetId),await wy(r.localStore,i.targetId,!0))}async function N3(t,e){const n=de(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Bv(n.remoteStore,r.targetId))}async function x3(t,e,n){const r=j3(t);try{const i=await function(o,a){const l=de(o),u=He.now(),d=a.reduce((w,E)=>w.add(E.key),Ee());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",w=>{let E=li(),v=Ee();return l.Ns.getEntries(w,d).next(b=>{E=b,E.forEach((S,T)=>{T.isValidDocument()||(v=v.add(S))})}).next(()=>l.localDocuments.getOverlayedDocuments(w,E)).next(b=>{f=b;const S=[];for(const T of a){const k=G4(T,f.get(T.key).overlayedDocument);k!=null&&S.push(new Ts(T.key,k,hP(k.value.mapValue),zn.exists(!0)))}return l.mutationQueue.addMutationBatch(w,u,S,a)}).next(b=>{m=b;const S=b.applyToLocalDocumentSet(f,v);return l.documentOverlayCache.saveOverlays(w,b.batchId,S)})}).then(()=>({batchId:m.batchId,changes:TP(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new gt(ve)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await gu(r,i.changes),await Jf(r.remoteStore)}catch(i){const s=Gv(i,"Failed to persist write");n.reject(s)}}async function oR(t,e){const n=de(t);try{const r=await qU(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(Re(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Re(o.hu,14607):i.removedDocuments.size>0&&(Re(o.hu,42227),o.hu=!1))}),await gu(n,r,e)}catch(r){await el(r)}}function kT(t,e,n){const r=de(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=de(o);l.onlineState=a;let u=!1;l.queries.forEach((d,f)=>{for(const m of f.Sa)m.va(a)&&(u=!0)}),u&&Kv(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function M3(t,e,n){const r=de(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new gt(ie.comparator);o=o.insert(s,Bt.newNoDocument(s,ce.min()));const a=Ee().add(s),l=new Gf(ce.min(),new Map,new gt(ve),o,a);await oR(r,l),r.du=r.du.remove(s),r.Au.delete(e),Jv(r)}else await wy(r.localStore,e,!1).then(()=>Ty(r,e,n)).catch(el)}async function O3(t,e){const n=de(t),r=e.batch.batchId;try{const i=await WU(n.localStore,e);lR(n,r,null),aR(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await gu(n,i)}catch(i){await el(i)}}async function D3(t,e,n){const r=de(t);try{const i=await function(o,a){const l=de(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(f=>(Re(f!==null,37113),d=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);lR(r,e,n),aR(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await gu(r,i)}catch(i){await el(i)}}function aR(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function lR(t,e,n){const r=de(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Ty(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||cR(t,r)})}function cR(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Bv(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Jv(t))}function bT(t,e,n){for(const r of n)r instanceof rR?(t.Ru.addReference(r.key,e),L3(t,r)):r instanceof iR?(ee(Qv,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||cR(t,r.key)):ae(19791,{wu:r})}function L3(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(Qv,"New document in limbo: "+n),t.Eu.add(r),Jv(t))}function Jv(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ie($e.fromString(e)),r=t.fu.next();t.Au.set(r,new C3(n)),t.du=t.du.insert(n,r),KP(t.remoteStore,new Fi(Ar(Bf(n.path)),r,"TargetPurposeLimboResolution",jf.ce))}}async function gu(t,e,n){const r=de(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){i.push(u);const f=Uv.As(l.targetId,u);s.push(f)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const d=de(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>W.forEach(u,m=>W.forEach(m.Es,w=>d.persistence.referenceDelegate.addReference(f,m.targetId,w)).next(()=>W.forEach(m.ds,w=>d.persistence.referenceDelegate.removeReference(f,m.targetId,w)))))}catch(f){if(!tl(f))throw f;ee($v,"Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const w=d.Ms.get(m),E=w.snapshotVersion,v=w.withLastLimboFreeSnapshotVersion(E);d.Ms=d.Ms.insert(m,v)}}}(r.localStore,s))}async function V3(t,e){const n=de(t);if(!n.currentUser.isEqual(e)){ee(Qv,"User change. New user:",e.toKey());const r=await WP(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new Z(B.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await gu(n,r.Ls)}}function F3(t,e){const n=de(t),r=n.Au.get(e);if(r&&r.hu)return Ee().add(r.key);{let i=Ee();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function uR(t){const e=de(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=oR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=F3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=M3.bind(null,e),e.Pu.H_=E3.bind(null,e.eventManager),e.Pu.yu=S3.bind(null,e.eventManager),e}function j3(t){const e=de(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=O3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=D3.bind(null,e),e}class zh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Kf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return zU(this.persistence,new UU,e.initialUser,this.serializer)}Cu(e){return new zP(jv.mi,this.serializer)}Du(e){return new JU}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zh.provider={build:()=>new zh};class U3 extends zh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Re(this.persistence.referenceDelegate instanceof $h,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new CU(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new zP(r=>$h.mi(r,n),this.serializer)}}class Iy{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>kT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=V3.bind(null,this.syncEngine),await _3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new w3}()}createDatastore(e){const n=Kf(e.databaseInfo.databaseId),r=function(s){return new t3(s)}(e.databaseInfo);return function(s,o,a,l){return new s3(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new a3(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>kT(this.syncEngine,n,0),function(){return wT.v()?new wT:new YU}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,d){const f=new k3(i,s,o,a,l,u);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=de(i);ee(co,"RemoteStore shutting down."),s.Ea.add(5),await mu(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Iy.provider={build:()=>new Iy};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ai("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls="FirestoreClient";class $3{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ut.UNAUTHENTICATED,this.clientId=bv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ee(ls,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(ls,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Gv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Cm(t,e){t.asyncQueue.verifyOperationInProgress(),ee(ls,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await WP(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function AT(t,e){t.asyncQueue.verifyOperationInProgress();const n=await B3(t);ee(ls,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>ST(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>ST(e.remoteStore,i)),t._onlineComponents=e}async function B3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(ls,"Using user provided OfflineComponentProvider");try{await Cm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Ra("Error using user provided cache. Falling back to memory cache: "+n),await Cm(t,new zh)}}else ee(ls,"Using default OfflineComponentProvider"),await Cm(t,new U3(void 0));return t._offlineComponents}async function hR(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(ls,"Using user provided OnlineComponentProvider"),await AT(t,t._uninitializedComponentsProvider._online)):(ee(ls,"Using default OnlineComponentProvider"),await AT(t,new Iy))),t._onlineComponents}function z3(t){return hR(t).then(e=>e.syncEngine)}async function Cy(t){const e=await hR(t),n=e.eventManager;return n.onListen=b3.bind(null,e.syncEngine),n.onUnlisten=R3.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=A3.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=N3.bind(null,e.syncEngine),n}function W3(t,e,n={}){const r=new Yi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new dR({next:m=>{d.Nu(),o.enqueueAndForget(()=>tR(s,f));const w=m.docs.has(a);!w&&m.fromCache?u.reject(new Z(B.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&l&&l.source==="server"?u.reject(new Z(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new nR(Bf(a.path),d,{includeMetadataChanges:!0,qa:!0});return eR(s,f)}(await Cy(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pR="firestore.googleapis.com",RT=!0;class NT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Z(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=pR,this.ssl=RT}else this.host=e.host,this.ssl=e.ssl??RT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=BP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<TU)throw new Z(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}o4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fR(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Yf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new NT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Z(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Z(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new NT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Jj;switch(r.type){case"firstParty":return new e4(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Z(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=PT.get(n);r&&(ee("ComponentProvider","Removing Datastore"),PT.delete(n),r.terminate())}(this),Promise.resolve()}}function q3(t,e,n,r={}){var u;t=Bn(t,Yf);const i=_s(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(fv(`https://${a}`),pv("Firestore",!0)),s.host!==pR&&s.host!==a&&Ra("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!ii(l,o)&&(t._setSettings(l),r.mockUserToken)){let d,f;if(typeof r.mockUserToken=="string")d=r.mockUserToken,f=Ut.MOCK_USER;else{d=eA(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Z(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ut(m)}t._authCredentials=new Yj(new eP(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new bo(this.firestore,e,this._query)}}class rt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rt(this.firestore,e,this._key)}toJSON(){return{type:rt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(hu(n,rt._jsonSchema))return new rt(e,r||null,new ie($e.fromString(n.referencePath)))}}rt._jsonSchemaVersion="firestore/documentReference/1.0",rt._jsonSchema={type:mt("string",rt._jsonSchemaVersion),referencePath:mt("string")};class Zi extends bo{constructor(e,n,r){super(e,n,Bf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rt(this.firestore,null,new ie(e))}withConverter(e){return new Zi(this.firestore,e,this._path)}}function Jc(t,e,...n){if(t=Me(t),tP("collection","path",e),t instanceof Yf){const r=$e.fromString(e,...n);return WS(r),new Zi(t,null,r)}{if(!(t instanceof rt||t instanceof Zi))throw new Z(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child($e.fromString(e,...n));return WS(r),new Zi(t.firestore,null,r)}}function rr(t,e,...n){if(t=Me(t),arguments.length===1&&(e=bv.newId()),tP("doc","path",e),t instanceof Yf){const r=$e.fromString(e,...n);return zS(r),new rt(t,null,new ie(r))}{if(!(t instanceof rt||t instanceof Zi))throw new Z(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child($e.fromString(e,...n));return zS(r),new rt(t.firestore,t instanceof Zi?t.converter:null,new ie(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT="AsyncQueue";class MT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new HP(this,"async_queue_retry"),this._c=()=>{const r=Im();r&&ee(xT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Im();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Im();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Yi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!tl(e))throw e;ee(xT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,ai("INTERNAL UNHANDLED ERROR: ",OT(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Hv.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&ae(47125,{Pc:OT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function OT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class cs extends Yf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new MT,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new MT(e),this._firestoreClient=void 0,await e}}}function H3(t,e){const n=typeof t=="object"?t:Of(),r=typeof t=="string"?t:Lh,i=vs(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Y1("firestore");s&&q3(i,...s)}return i}function Yv(t){if(t._terminated)throw new Z(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||G3(t),t._firestoreClient}function G3(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,d){return new y4(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,fR(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new $3(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ln(Lt.fromBase64String(e))}catch(n){throw new Z(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ln(Lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ln._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(hu(e,Ln._jsonSchema))return Ln.fromBase64String(e.bytes)}}Ln._jsonSchemaVersion="firestore/bytes/1.0",Ln._jsonSchema={type:mt("string",Ln._jsonSchemaVersion),bytes:mt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Z(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Z(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Z(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ve(this._lat,e._lat)||ve(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Rr._jsonSchemaVersion}}static fromJSON(e){if(hu(e,Rr._jsonSchema))return new Rr(e.latitude,e.longitude)}}Rr._jsonSchemaVersion="firestore/geoPoint/1.0",Rr._jsonSchema={type:mt("string",Rr._jsonSchemaVersion),latitude:mt("number"),longitude:mt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Nr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(hu(e,Nr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Nr(e.vectorValues);throw new Z(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Nr._jsonSchemaVersion="firestore/vectorValue/1.0",Nr._jsonSchema={type:mt("string",Nr._jsonSchemaVersion),vectorValues:mt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K3=/^__.*__$/;class Q3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ts(e,this.data,this.fieldMask,n,this.fieldTransforms):new fu(e,this.data,n,this.fieldTransforms)}}class mR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ts(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function gR(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae(40011,{Ac:t})}}class Xv{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Xv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Wh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(gR(this.Ac)&&K3.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class J3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Kf(e)}Cc(e,n,r,i=!1){return new Xv({Ac:e,methodName:n,Dc:r,path:xt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ep(t){const e=t._freezeSettings(),n=Kf(t._databaseId);return new J3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function yR(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);ew("Data must be an object, but it was:",o,r);const a=_R(r,o);let l,u;if(s.merge)l=new Tn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const m=ky(e,f,n);if(!o.contains(m))throw new Z(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);wR(d,m)||d.push(m)}l=new Tn(d),u=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=o.fieldTransforms;return new Q3(new an(a),l,u)}class tp extends Zf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof tp}}class Zv extends Zf{_toFieldTransform(e){return new z4(e.path,new Gc)}isEqual(e){return e instanceof Zv}}function Y3(t,e,n,r){const i=t.Cc(1,e,n);ew("Data must be an object, but it was:",i,r);const s=[],o=an.empty();Ss(r,(l,u)=>{const d=tw(e,l,n);u=Me(u);const f=i.yc(d);if(u instanceof tp)s.push(d);else{const m=yu(u,f);m!=null&&(s.push(d),o.set(d,m))}});const a=new Tn(s);return new mR(o,a,i.fieldTransforms)}function X3(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[ky(e,r,n)],l=[i];if(s.length%2!=0)throw new Z(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(ky(e,s[m])),l.push(s[m+1]);const u=[],d=an.empty();for(let m=a.length-1;m>=0;--m)if(!wR(u,a[m])){const w=a[m];let E=l[m];E=Me(E);const v=o.yc(w);if(E instanceof tp)u.push(w);else{const b=yu(E,v);b!=null&&(u.push(w),d.set(w,b))}}const f=new Tn(u);return new mR(d,f,o.fieldTransforms)}function Z3(t,e,n,r=!1){return yu(n,t.Cc(r?4:3,e))}function yu(t,e){if(vR(t=Me(t)))return ew("Unsupported field value:",e,t),_R(t,e);if(t instanceof Zf)return function(r,i){if(!gR(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=yu(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Me(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return U4(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=He.fromDate(r);return{timestampValue:Uh(i.serializer,s)}}if(r instanceof He){const s=new He(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Uh(i.serializer,s)}}if(r instanceof Rr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ln)return{bytesValue:DP(i.serializer,r._byteString)};if(r instanceof rt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Vv(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Nr)return function(o,a){return{mapValue:{fields:{[uP]:{stringValue:dP},[Vh]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return Mv(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${Ff(r)}`)}(t,e)}function _R(t,e){const n={};return iP(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ss(t,(r,i)=>{const s=yu(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function vR(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof He||t instanceof Rr||t instanceof Ln||t instanceof rt||t instanceof Zf||t instanceof Nr)}function ew(t,e,n){if(!vR(n)||!nP(n)){const r=Ff(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function ky(t,e,n){if((e=Me(e))instanceof Xf)return e._internalPath;if(typeof e=="string")return tw(t,e);throw Wh("Field path arguments must be of type string or ",t,!1,void 0,n)}const e6=new RegExp("[~\\*/\\[\\]]");function tw(t,e,n){if(e.search(e6)>=0)throw Wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Xf(...e.split("."))._internalPath}catch{throw Wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Wh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new Z(B.INVALID_ARGUMENT,a+t+l)}function wR(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new rt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new t6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(np("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class t6 extends ER{data(){return super.data()}}function np(t,e){return typeof e=="string"?tw(t,e):e instanceof Xf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Z(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class nw{}class SR extends nw{}function qh(t,e,...n){let r=[];e instanceof nw&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof rw).length,a=s.filter(l=>l instanceof rp).length;if(o>1||o>0&&a>0)throw new Z(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class rp extends SR{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new rp(e,n,r)}_apply(e){const n=this._parse(e);return TR(e._query,n),new bo(e.firestore,e.converter,py(e._query,n))}_parse(e){const n=ep(e.firestore);return function(s,o,a,l,u,d,f){let m;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Z(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){VT(f,d);const E=[];for(const v of f)E.push(LT(l,s,v));m={arrayValue:{values:E}}}else m=LT(l,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||VT(f,d),m=Z3(a,o,f,d==="in"||d==="not-in");return pt.create(u,d,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function hc(t,e,n){const r=e,i=np("where",t);return rp._create(i,r,n)}class rw extends nw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new rw(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:dr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)TR(o,l),o=py(o,l)}(e._query,n),new bo(e.firestore,e.converter,py(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class iw extends SR{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new iw(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new Z(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Z(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Hc(s,o)}(e._query,this._field,this._direction);return new bo(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new nl(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function r6(t,e="asc"){const n=e,r=np("orderBy",t);return iw._create(r,n)}function LT(t,e,n){if(typeof(n=Me(n))=="string"){if(n==="")throw new Z(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vP(e)&&n.indexOf("/")!==-1)throw new Z(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child($e.fromString(n));if(!ie.isDocumentKey(r))throw new Z(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return XS(t,new ie(r))}if(n instanceof rt)return XS(t,n._key);throw new Z(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ff(n)}.`)}function VT(t,e){if(!Array.isArray(t)||t.length===0)throw new Z(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function TR(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Z(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Z(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class i6{convertValue(e,n="none"){switch(os(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ot(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ss(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ss(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[Vh].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>ot(o.doubleValue));return new Nr(n)}convertGeoPoint(e){return new Rr(ot(e.latitude),ot(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=$f(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(zc(e));default:return null}}convertTimestamp(e){const n=is(e);return new He(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=$e.fromString(e);Re($P(r),9688,{name:e});const i=new Wc(r.get(1),r.get(3)),s=new ie(r.popFirst(5));return i.isEqual(n)||ai(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IR(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Gl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ys extends ER{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new qd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(np("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ys._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ys._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ys._jsonSchema={type:mt("string",Ys._jsonSchemaVersion),bundleSource:mt("string","DocumentSnapshot"),bundleName:mt("string"),bundle:mt("string")};class qd extends Ys{data(e={}){return super.data(e)}}class ma{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Gl(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new qd(this._firestore,this._userDataWriter,r.key,r,new Gl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Z(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new qd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Gl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new qd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Gl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:s6(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ma._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=bv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function s6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(t){t=Bn(t,rt);const e=Bn(t.firestore,cs);return W3(Yv(e),t._key).then(n=>kR(e,t,n))}ma._jsonSchemaVersion="firestore/querySnapshot/1.0",ma._jsonSchema={type:mt("string",ma._jsonSchemaVersion),bundleSource:mt("string","QuerySnapshot"),bundleName:mt("string"),bundle:mt("string")};class CR extends i6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ln(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new rt(this.firestore,null,n)}}function sw(t,e,n){t=Bn(t,rt);const r=Bn(t.firestore,cs),i=IR(t.converter,e,n);return ip(r,[yR(ep(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,zn.none())])}function Hd(t,e,n,...r){t=Bn(t,rt);const i=Bn(t.firestore,cs),s=ep(i);let o;return o=typeof(e=Me(e))=="string"||e instanceof Xf?X3(s,"updateDoc",t._key,e,n,r):Y3(s,"updateDoc",t._key,e),ip(i,[o.toMutation(t._key,zn.exists(!0))])}function a6(t){return ip(Bn(t.firestore,cs),[new Ov(t._key,zn.none())])}function l6(t,e){const n=Bn(t.firestore,cs),r=rr(t),i=IR(t.converter,e);return ip(n,[yR(ep(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,zn.exists(!1))]).then(()=>r)}function Hh(t,...e){var l,u,d;t=Me(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||DT(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(DT(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(u=f.error)==null?void 0:u.bind(f),e[r+2]=(d=f.complete)==null?void 0:d.bind(f)}let s,o,a;if(t instanceof rt)o=Bn(t.firestore,cs),a=Bf(t._key.path),s={next:f=>{e[r]&&e[r](kR(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=Bn(t,bo);o=Bn(f.firestore,cs),a=f._query;const m=new CR(o);s={next:w=>{e[r]&&e[r](new ma(o,m,f,w))},error:e[r+1],complete:e[r+2]},n6(t._query)}return function(m,w,E,v){const b=new dR(v),S=new nR(w,b,E);return m.asyncQueue.enqueueAndForget(async()=>eR(await Cy(m),S)),()=>{b.Nu(),m.asyncQueue.enqueueAndForget(async()=>tR(await Cy(m),S))}}(Yv(o),a,i,s)}function ip(t,e){return function(r,i){const s=new Yi;return r.asyncQueue.enqueueAndForget(async()=>x3(await z3(r),i,s)),s.promise}(Yv(t),e)}function kR(t,e,n){const r=n.docs.get(e._key),i=new CR(t);return new Ys(t,i,e._key,r,new Gl(n.hasPendingWrites,n.fromCache),e.converter)}function Ws(){return new Zv("serverTimestamp")}(function(e,n=!0){(function(i){Za=i})(To),cr(new Gn("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new cs(new Xj(r.getProvider("auth-internal")),new t4(o,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Z(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wc(u.options.projectId,d)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),fn(jS,US,e),fn(jS,US,"esm2020")})();var c6="firebase",u6="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fn(c6,u6,"app");const bR="@firebase/installations",ow="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AR=1e4,PR=`w:${ow}`,RR="FIS_v2",d6="https://firebaseinstallations.googleapis.com/v1",h6=60*60*1e3,f6="installations",p6="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},uo=new So(f6,p6,m6);function NR(t){return t instanceof fr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xR({projectId:t}){return`${d6}/projects/${t}/installations`}function MR(t){return{token:t.token,requestStatus:2,expiresIn:y6(t.expiresIn),creationTime:Date.now()}}async function OR(t,e){const r=(await e.json()).error;return uo.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function DR({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function g6(t,{refreshToken:e}){const n=DR(t);return n.append("Authorization",_6(e)),n}async function LR(t){const e=await t();return e.status>=500&&e.status<600?t():e}function y6(t){return Number(t.replace("s","000"))}function _6(t){return`${RR} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v6({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=xR(t),i=DR(t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={fid:n,authVersion:RR,appId:t.appId,sdkVersion:PR},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await LR(()=>fetch(r,a));if(l.ok){const u=await l.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:MR(u.authToken)}}else throw await OR("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w6(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E6=/^[cdef][\w-]{21}$/,by="";function S6(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=T6(t);return E6.test(n)?n:by}catch{return by}}function T6(t){return w6(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sp(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR=new Map;function jR(t,e){const n=sp(t);UR(n,e),I6(n,e)}function UR(t,e){const n=FR.get(t);if(n)for(const r of n)r(e)}function I6(t,e){const n=C6();n&&n.postMessage({key:t,fid:e}),k6()}let qs=null;function C6(){return!qs&&"BroadcastChannel"in self&&(qs=new BroadcastChannel("[Firebase] FID Change"),qs.onmessage=t=>{UR(t.data.key,t.data.fid)}),qs}function k6(){FR.size===0&&qs&&(qs.close(),qs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6="firebase-installations-database",A6=1,ho="firebase-installations-store";let km=null;function aw(){return km||(km=lA(b6,A6,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ho)}}})),km}async function Gh(t,e){const n=sp(t),i=(await aw()).transaction(ho,"readwrite"),s=i.objectStore(ho),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&jR(t,e.fid),e}async function $R(t){const e=sp(t),r=(await aw()).transaction(ho,"readwrite");await r.objectStore(ho).delete(e),await r.done}async function op(t,e){const n=sp(t),i=(await aw()).transaction(ho,"readwrite"),s=i.objectStore(ho),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&jR(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lw(t){let e;const n=await op(t.appConfig,r=>{const i=P6(r),s=R6(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===by?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function P6(t){const e=t||{fid:S6(),registrationStatus:0};return BR(e)}function R6(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(uo.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=N6(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:x6(t)}:{installationEntry:e}}async function N6(t,e){try{const n=await v6(t,e);return Gh(t.appConfig,n)}catch(n){throw NR(n)&&n.customData.serverCode===409?await $R(t.appConfig):await Gh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function x6(t){let e=await FT(t.appConfig);for(;e.registrationStatus===1;)await VR(100),e=await FT(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await lw(t);return r||n}return e}function FT(t){return op(t,e=>{if(!e)throw uo.create("installation-not-found");return BR(e)})}function BR(t){return M6(t)?{fid:t.fid,registrationStatus:0}:t}function M6(t){return t.registrationStatus===1&&t.registrationTime+AR<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O6({appConfig:t,heartbeatServiceProvider:e},n){const r=D6(t,n),i=g6(t,n),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={installation:{sdkVersion:PR,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await LR(()=>fetch(r,a));if(l.ok){const u=await l.json();return MR(u)}else throw await OR("Generate Auth Token",l)}function D6(t,{fid:e}){return`${xR(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cw(t,e=!1){let n;const r=await op(t.appConfig,s=>{if(!zR(s))throw uo.create("not-registered");const o=s.authToken;if(!e&&F6(o))return s;if(o.requestStatus===1)return n=L6(t,e),s;{if(!navigator.onLine)throw uo.create("app-offline");const a=U6(s);return n=V6(t,a),a}});return n?await n:r.authToken}async function L6(t,e){let n=await jT(t.appConfig);for(;n.authToken.requestStatus===1;)await VR(100),n=await jT(t.appConfig);const r=n.authToken;return r.requestStatus===0?cw(t,e):r}function jT(t){return op(t,e=>{if(!zR(e))throw uo.create("not-registered");const n=e.authToken;return $6(n)?{...e,authToken:{requestStatus:0}}:e})}async function V6(t,e){try{const n=await O6(t,e),r={...e,authToken:n};return await Gh(t.appConfig,r),n}catch(n){if(NR(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await $R(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await Gh(t.appConfig,r)}throw n}}function zR(t){return t!==void 0&&t.registrationStatus===2}function F6(t){return t.requestStatus===2&&!j6(t)}function j6(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+h6}function U6(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function $6(t){return t.requestStatus===1&&t.requestTime+AR<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B6(t){const e=t,{installationEntry:n,registrationPromise:r}=await lw(e);return r?r.catch(console.error):cw(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z6(t,e=!1){const n=t;return await W6(n),(await cw(n,e)).token}async function W6(t){const{registrationPromise:e}=await lw(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q6(t){if(!t||!t.options)throw bm("App Configuration");if(!t.name)throw bm("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw bm(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function bm(t){return uo.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR="installations",H6="installations-internal",G6=t=>{const e=t.getProvider("app").getImmediate(),n=q6(e),r=vs(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},K6=t=>{const e=t.getProvider("app").getImmediate(),n=vs(e,WR).getImmediate();return{getId:()=>B6(n),getToken:i=>z6(n,i)}};function Q6(){cr(new Gn(WR,G6,"PUBLIC")),cr(new Gn(H6,K6,"PRIVATE"))}Q6();fn(bR,ow);fn(bR,ow,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kh="analytics",J6="firebase_id",Y6="origin",X6=60*1e3,Z6="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",uw="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tn=new au("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e$={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},kn=new So("analytics","Analytics",e$);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t$(t){if(!t.startsWith(uw)){const e=kn.create("invalid-gtag-resource",{gtagURL:t});return tn.warn(e.message),""}return t}function qR(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function n$(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function r$(t,e){const n=n$("firebase-js-sdk-policy",{createScriptURL:t$}),r=document.createElement("script"),i=`${uw}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function i$(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function s$(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await qR(n)).find(u=>u.measurementId===i);l&&await e[l.appId]}}catch(a){tn.error(a)}t("config",i,s)}async function o$(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await qR(n);for(const l of o){const u=a.find(f=>f.measurementId===l),d=u&&e[u.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){tn.error(s)}}function a$(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await o$(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await s$(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,u]=o;t("get",a,l,u)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){tn.error(a)}}return i}function l$(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=a$(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function c$(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(uw)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u$=30,d$=1e3;class h${constructor(e={},n=d$){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const HR=new h$;function f$(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function p$(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:f$(n)},i=Z6.replace("{app-id}",e),s=await fetch(i,r);if(s.status!==200&&s.status!==304){let a="";try{const l=await s.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw kn.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}async function m$(t,e=HR,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw kn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw kn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new _$;return setTimeout(async()=>{a.abort()},X6),GR({appId:r,apiKey:i,measurementId:s},o,a,e)}async function GR(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=HR){var a;const{appId:s,measurementId:o}=t;try{await g$(r,e)}catch(l){if(o)return tn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:s,measurementId:o};throw l}try{const l=await p$(t);return i.deleteThrottleMetadata(s),l}catch(l){const u=l;if(!y$(u)){if(i.deleteThrottleMetadata(s),o)return tn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:s,measurementId:o};throw l}const d=Number((a=u==null?void 0:u.customData)==null?void 0:a.httpStatus)===503?uS(n,i.intervalMillis,u$):uS(n,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return i.setThrottleMetadata(s,f),tn.debug(`Calling attemptFetch again in ${d} millis`),GR(t,f,r,i)}}function g$(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(kn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function y$(t){if(!(t instanceof fr)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class _${constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function v$(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o={...r,send_to:s};t("event",n,o)}}async function w$(t,e,n,r){if(r&&r.global){const i={};for(const s of Object.keys(n))i[`user_properties.${s}`]=n[s];return t("set",i),Promise.resolve()}else{const i=await e;t("config",i,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E$(){if(rA())try{await iA()}catch(t){return tn.warn(kn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return tn.warn(kn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function S$(t,e,n,r,i,s,o){const a=m$(t);a.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&tn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>tn.error(m)),e.push(a);const l=E$().then(m=>{if(m)return r.getId()}),[u,d]=await Promise.all([a,l]);c$(s)||r$(s,u.measurementId),i("js",new Date);const f=(o==null?void 0:o.config)??{};return f[Y6]="firebase",f.update=!0,d!=null&&(f[J6]=d),i("config",u.measurementId,f),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T${constructor(e){this.app=e}_delete(){return delete ga[this.app.options.appId],Promise.resolve()}}let ga={},UT=[];const $T={};let Am="dataLayer",I$="gtag",BT,dw,zT=!1;function C$(){const t=[];if(tA()&&t.push("This is a browser extension environment."),m2()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=kn.create("invalid-analytics-context",{errorInfo:e});tn.warn(n.message)}}function k$(t,e,n){C$();const r=t.options.appId;if(!r)throw kn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)tn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw kn.create("no-api-key");if(ga[r]!=null)throw kn.create("already-exists",{id:r});if(!zT){i$(Am);const{wrappedGtag:s,gtagCore:o}=l$(ga,UT,$T,Am,I$);dw=s,BT=o,zT=!0}return ga[r]=S$(t,UT,$T,e,BT,Am,n),new T$(t)}function b$(t=Of()){t=Me(t);const e=vs(t,Kh);return e.isInitialized()?e.getImmediate():A$(t)}function A$(t,e={}){const n=vs(t,Kh);if(n.isInitialized()){const i=n.getImmediate();if(ii(e,n.getOptions()))return i;throw kn.create("already-initialized")}return n.initialize({options:e})}function P$(t,e,n){t=Me(t),w$(dw,ga[t.app.options.appId],e,n).catch(r=>tn.error(r))}function R$(t,e,n,r){t=Me(t),v$(dw,ga[t.app.options.appId],e,n,r).catch(i=>tn.error(i))}const WT="@firebase/analytics",qT="0.10.19";function N$(){cr(new Gn(Kh,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return k$(r,i,n)},"PUBLIC")),cr(new Gn("analytics-internal",t,"PRIVATE")),fn(WT,qT),fn(WT,qT,"esm2020");function t(e){try{const n=e.getProvider(Kh).getImmediate();return{logEvent:(r,i,s)=>R$(n,r,i,s),setUserProperties:(r,i)=>P$(n,r,i)}}catch(n){throw kn.create("interop-component-reg-failed",{reason:n})}}}N$();var HT={};const GT="@firebase/database",KT="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let KR="";function x$(t){KR=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M${constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Nt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Fc(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O${constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Mr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new M$(e)}}catch{}return new O$},Hs=QR("localStorage"),D$=QR("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ya=new au("@firebase/database"),L$=function(){let t=1;return function(){return t++}}(),JR=function(t){const e=C2(t),n=new E2;n.update(e);const r=n.digest();return hv.encodeByteArray(r)},_u=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=_u.apply(null,r):typeof r=="object"?e+=Nt(r):e+=r,e+=" "}return e};let fc=null,QT=!0;const V$=function(t,e){Y(!0,"Can't turn on custom loggers persistently."),ya.logLevel=ge.VERBOSE,fc=ya.log.bind(ya)},Rt=function(...t){if(QT===!0&&(QT=!1,fc===null&&D$.get("logging_enabled")===!0&&V$()),fc){const e=_u.apply(null,t);fc(e)}},vu=function(t){return function(...e){Rt(t,...e)}},Ay=function(...t){const e="FIREBASE INTERNAL ERROR: "+_u(...t);ya.error(e)},ci=function(...t){const e=`FIREBASE FATAL ERROR: ${_u(...t)}`;throw ya.error(e),new Error(e)},pn=function(...t){const e="FIREBASE WARNING: "+_u(...t);ya.warn(e)},F$=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&pn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ap=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},j$=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},La="[MIN_NAME]",fo="[MAX_NAME]",Ao=function(t,e){if(t===e)return 0;if(t===La||e===fo)return-1;if(e===La||t===fo)return 1;{const n=JT(t),r=JT(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},U$=function(t,e){return t===e?0:t<e?-1:1},Nl=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Nt(e))},hw=function(t){if(typeof t!="object"||t===null)return Nt(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Nt(e[r]),n+=":",n+=hw(t[e[r]]);return n+="}",n},YR=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function mn(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const XR=function(t){Y(!ap(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let i,s,o,a,l;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(l=n;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();const d=u.join("");let f="";for(l=0;l<64;l+=8){let m=parseInt(d.substr(l,8),2).toString(16);m.length===1&&(m="0"+m),f=f+m}return f.toLowerCase()},$$=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},B$=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},z$=new RegExp("^-?(0*)\\d{1,10}$"),W$=-2147483648,q$=2147483647,JT=function(t){if(z$.test(t)){const e=Number(t);if(e>=W$&&e<=q$)return e}return null},il=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw pn("Exception was thrown by user callback.",n),e},Math.floor(0))}},H$=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},pc=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G${constructor(e,n){this.appCheckProvider=n,this.appName=e.name,En(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)==null||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){pn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K${constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Rt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',pn(e)}}class Gd{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Gd.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw="5",ZR="v",eN="s",tN="r",nN="f",rN=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,iN="ls",sN="p",Py="ac",oN="websocket",aN="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e,n,r,i,s=!1,o="",a=!1,l=!1,u=null){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Hs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Hs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function Q$(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function cN(t,e,n){Y(typeof e=="string","typeof type must == string"),Y(typeof n=="object","typeof params must == object");let r;if(e===oN)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===aN)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Q$(t)&&(n.ns=t.namespace);const i=[];return mn(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J${constructor(){this.counters_={}}incrementCounter(e,n=1){Mr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return n2(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm={},Rm={};function pw(t){const e=t.toString();return Pm[e]||(Pm[e]=new J$),Pm[e]}function Y$(t,e){const n=t.toString();return Rm[n]||(Rm[n]=e()),Rm[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X${constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&il(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT="start",Z$="close",e9="pLPCommand",t9="pRTLPCB",uN="id",dN="pw",hN="ser",n9="cb",r9="seg",i9="ts",s9="d",o9="dframe",fN=1870,pN=30,a9=fN-pN,l9=25e3,c9=3e4;class ra{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=vu(e),this.stats_=pw(n),this.urlFn=l=>(this.appCheckToken&&(l[Py]=this.appCheckToken),cN(n,aN,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new X$(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(c9)),j$(()=>{if(this.isClosed_)return;this.scriptTagHolder=new mw((...s)=>{const[o,a,l,u,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===YT)this.id=a,this.password=l;else if(o===Z$)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[YT]="t",r[hN]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[n9]=this.scriptTagHolder.uniqueCallbackIdentifier),r[ZR]=fw,this.transportSessionId&&(r[eN]=this.transportSessionId),this.lastSessionId&&(r[iN]=this.lastSessionId),this.applicationId&&(r[sN]=this.applicationId),this.appCheckToken&&(r[Py]=this.appCheckToken),typeof location<"u"&&location.hostname&&rN.test(location.hostname)&&(r[tN]=nN);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ra.forceAllow_=!0}static forceDisallow(){ra.forceDisallow_=!0}static isAvailable(){return ra.forceAllow_?!0:!ra.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!$$()&&!B$()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Nt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=K1(n),i=YR(r,a9);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[o9]="t",r[uN]=e,r[dN]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Nt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class mw{constructor(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=L$(),window[e9+this.uniqueCallbackIdentifier]=e,window[t9+this.uniqueCallbackIdentifier]=n,this.myIFrame=mw.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Rt("frame writing exception"),a.stack&&Rt(a.stack),Rt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Rt("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[uN]=this.myID,e[dN]=this.myPW,e[hN]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+pN+r.length<=fN;){const o=this.pendingSegs.shift();r=r+"&"+r9+i+"="+o.seg+"&"+i9+i+"="+o.ts+"&"+s9+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(l9)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Rt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9=16384,d9=45e3;let Qh=null;typeof MozWebSocket<"u"?Qh=MozWebSocket:typeof WebSocket<"u"&&(Qh=WebSocket);class tr{constructor(e,n,r,i,s,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=vu(this.connId),this.stats_=pw(n),this.connURL=tr.connectionURL_(n,o,a,i,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,i,s){const o={};return o[ZR]=fw,typeof location<"u"&&location.hostname&&rN.test(location.hostname)&&(o[tN]=nN),n&&(o[eN]=n),r&&(o[iN]=r),i&&(o[Py]=i),s&&(o[sN]=s),cN(e,oN,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Hs.set("previous_websocket_failure",!0);try{let r;f2(),this.mySock=new Qh(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){tr.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Qh!==null&&!tr.forceDisallow_}static previouslyFailed(){return Hs.isInMemoryStorage||Hs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Hs.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=Fc(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Y(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=Nt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=YR(n,u9);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(d9))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}tr.responsesRequiredToBeHealthy=2;tr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{static get ALL_TRANSPORTS(){return[ra,tr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=tr&&tr.isAvailable();let r=n&&!tr.previouslyFailed();if(e.webSocketOnly&&(n||pn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[tr];else{const i=this.transports_=[];for(const s of Yc.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Yc.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Yc.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h9=6e4,f9=5e3,p9=10*1024,m9=100*1024,Nm="t",XT="d",g9="s",ZT="r",y9="e",eI="o",tI="a",nI="n",rI="p",_9="h";class v9{constructor(e,n,r,i,s,o,a,l,u,d){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=vu("c:"+this.id+":"),this.transportManager_=new Yc(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=pc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>m9?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>p9?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Nm in e){const n=e[Nm];n===tI?this.upgradeIfSecondaryHealthy_():n===ZT?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===eI&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Nl("t",e),r=Nl("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:rI,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:tI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:nI,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Nl("t",e),r=Nl("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Nl(Nm,e);if(XT in e){const r=e[XT];if(n===_9){const i={...r};this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===nI){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===g9?this.onConnectionShutdown_(r):n===ZT?this.onReset_(r):n===y9?Ay("Server Error: "+r):n===eI?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ay("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),fw!==r&&pn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),pc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(h9))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):pc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(f9))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:rI,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Hs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e){this.allowedEvents_=e,this.listeners_={},Y(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){Y(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh extends gN{static getInstance(){return new Jh}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!mv()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Y(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI=32,sI=768;class Fe{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function xe(){return new Fe("")}function ye(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function us(t){return t.pieces_.length-t.pieceNum_}function Ue(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Fe(t.pieces_,e)}function gw(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function w9(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Xc(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function yN(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Fe(e,0)}function lt(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Fe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Fe(n,0)}function we(t){return t.pieceNum_>=t.pieces_.length}function Fn(t,e){const n=ye(t),r=ye(e);if(n===null)return e;if(n===r)return Fn(Ue(t),Ue(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function E9(t,e){const n=Xc(t,0),r=Xc(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=Ao(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function _N(t,e){if(us(t)!==us(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function jn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(us(t)>us(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class S9{constructor(e,n){this.errorPrefix_=n,this.parts_=Xc(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Mf(this.parts_[r]);vN(this)}}function T9(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Mf(e),vN(t)}function I9(t){const e=t.parts_.pop();t.byteLength_-=Mf(e),t.parts_.length>0&&(t.byteLength_-=1)}function vN(t){if(t.byteLength_>sI)throw new Error(t.errorPrefix_+"has a key path longer than "+sI+" bytes ("+t.byteLength_+").");if(t.parts_.length>iI)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+iI+") or object contains a cycle "+Fs(t))}function Fs(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw extends gN{static getInstance(){return new yw}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return Y(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xl=1e3,C9=60*5*1e3,oI=30*1e3,k9=1.3,b9=3e4,A9="server_kill",aI=3;class Xr extends mN{constructor(e,n,r,i,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Xr.nextPersistentConnectionId_++,this.log_=vu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=xl,this.maxReconnectDelay_=C9,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");yw.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Jh.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const i=++this.requestNumber_,s={r:i,a:e,b:n};this.log_(Nt(s)),Y(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const n=new Br,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(e,n,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),Y(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Y(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,u=a.s;Xr.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Mr(e,"w")){const r=Aa(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();pn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||w2(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=oI)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=v2(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),Y(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,n)}sendUnlisten_(e,n,r,i){this.log_("Unlisten on "+e+" for "+n);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,i){const s={p:n,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,r,i){this.putInternal("p",e,n,r,i)}merge(e,n,r,i){this.putInternal("m",e,n,r,i)}putInternal(e,n,r,i,s){this.initConnection_();const o={p:n,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Nt(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Ay("Unrecognized action received from server: "+Nt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Y(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=xl,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=xl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>b9&&(this.reconnectDelay_=xl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*k9)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Xr.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},u=function(f){Y(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(f)};this.realtime_={close:l,sendRequest:u};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,m]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);o?Rt("getToken() completed but was canceled"):(Rt("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=m&&m.token,a=new v9(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,w=>{pn(w+" ("+this.repoInfo_.toString()+")"),this.interrupt(A9)},s))}catch(f){this.log_("Failed to get token: "+f),o||(this.repoInfo_.nodeAdmin&&pn(f),l())}}}interrupt(e){Rt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Rt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],kh(this.interruptReasons_)&&(this.reconnectDelay_=xl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(s=>hw(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const r=new Fe(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(n),s.delete(n),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,n){Rt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=aI&&(this.reconnectDelay_=oI,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Rt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=aI&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+KR.replace(/\./g,"-")]=1,mv()?e["framework.cordova"]=1:nA()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Jh.getInstance().currentlyOnline();return kh(this.interruptReasons_)&&e}}Xr.nextPersistentConnectionId_=0;Xr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Ce(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new Ce(La,e),i=new Ce(La,n);return this.compare(r,i)!==0}minPost(){return Ce.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ad;class wN extends lp{static get __EMPTY_NODE(){return ad}static set __EMPTY_NODE(e){ad=e}compare(e,n){return Ao(e.name,n.name)}isDefinedOn(e){throw Ja("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Ce.MIN}maxPost(){return new Ce(fo,ad)}makePost(e,n){return Y(typeof e=="string","KeyIndex indexValue must always be a string."),new Ce(e,ad)}toString(){return".key"}}const _a=new wN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Ct{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ct.RED,this.left=i??cn.EMPTY_NODE,this.right=s??cn.EMPTY_NODE}copy(e,n,r,i,s){return new Ct(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return cn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,i;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return cn.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ct.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ct.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Ct.RED=!0;Ct.BLACK=!1;class P9{copy(e,n,r,i,s){return this}insert(e,n,r){return new Ct(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class cn{constructor(e,n=cn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new cn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Ct.BLACK,null,null))}remove(e){return new cn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ct.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ld(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ld(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ld(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ld(this.root_,null,this.comparator_,!0,e)}}cn.EMPTY_NODE=new P9;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R9(t,e){return Ao(t.name,e.name)}function _w(t,e){return Ao(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ry;function N9(t){Ry=t}const EN=function(t){return typeof t=="number"?"number:"+XR(t):"string:"+t},SN=function(t){if(t.isLeafNode()){const e=t.val();Y(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Mr(e,".sv"),"Priority must be a string or number.")}else Y(t===Ry||t.isEmpty(),"priority of unexpected type.");Y(t===Ry||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lI;class St{static set __childrenNodeConstructor(e){lI=e}static get __childrenNodeConstructor(){return lI}constructor(e,n=St.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Y(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),SN(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new St(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:St.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return we(e)?this:ye(e)===".priority"?this.priorityNode_:St.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:St.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=ye(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(Y(r!==".priority"||us(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,St.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ue(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+EN(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=XR(this.value_):e+=this.value_,this.lazyHash_=JR(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===St.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof St.__childrenNodeConstructor?-1:(Y(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,i=St.VALUE_TYPE_ORDER.indexOf(n),s=St.VALUE_TYPE_ORDER.indexOf(r);return Y(i>=0,"Unknown leaf type: "+n),Y(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}St.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TN,IN;function x9(t){TN=t}function M9(t){IN=t}class O9 extends lp{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Ao(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Ce.MIN}maxPost(){return new Ce(fo,new St("[PRIORITY-POST]",IN))}makePost(e,n){const r=TN(e);return new Ce(n,new St("[PRIORITY-POST]",r))}toString(){return".priority"}}const Mt=new O9;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D9=Math.log(2);class L9{constructor(e){const n=s=>parseInt(Math.log(s)/D9,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Yh=function(t,e,n,r){t.sort(e);const i=function(l,u){const d=u-l;let f,m;if(d===0)return null;if(d===1)return f=t[l],m=n?n(f):f,new Ct(m,f.node,Ct.BLACK,null,null);{const w=parseInt(d/2,10)+l,E=i(l,w),v=i(w+1,u);return f=t[w],m=n?n(f):f,new Ct(m,f.node,Ct.BLACK,E,v)}},s=function(l){let u=null,d=null,f=t.length;const m=function(E,v){const b=f-E,S=f;f-=E;const T=i(b+1,S),k=t[b],L=n?n(k):k;w(new Ct(L,k.node,v,null,T))},w=function(E){u?(u.left=E,u=E):(d=E,u=E)};for(let E=0;E<l.count;++E){const v=l.nextBitIsOne(),b=Math.pow(2,l.count-(E+1));v?m(b,Ct.BLACK):(m(b,Ct.BLACK),m(b,Ct.RED))}return d},o=new L9(t.length),a=s(o);return new cn(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xm;const Fo={};class Gr{static get Default(){return Y(Fo&&Mt,"ChildrenNode.ts has not been loaded"),xm=xm||new Gr({".priority":Fo},{".priority":Mt}),xm}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=Aa(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof cn?n:null}hasIndex(e){return Mr(this.indexSet_,e.toString())}addIndex(e,n){Y(e!==_a,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(Ce.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Yh(r,e.getCompare()):a=Fo;const l=e.toString(),u={...this.indexSet_};u[l]=e;const d={...this.indexes_};return d[l]=a,new Gr(d,u)}addToIndexes(e,n){const r=bh(this.indexes_,(i,s)=>{const o=Aa(this.indexSet_,s);if(Y(o,"Missing index implementation for "+s),i===Fo)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(Ce.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),Yh(a,o.getCompare())}else return Fo;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new Ce(e.name,a))),l.insert(e,e.node)}});return new Gr(r,this.indexSet_)}removeFromIndexes(e,n){const r=bh(this.indexes_,i=>{if(i===Fo)return i;{const s=n.get(e.name);return s?i.remove(new Ce(e.name,s)):i}});return new Gr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ml;class Pe{static get EMPTY_NODE(){return Ml||(Ml=new Pe(new cn(_w),null,Gr.Default))}constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&SN(this.priorityNode_),this.children_.isEmpty()&&Y(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ml}updatePriority(e){return this.children_.isEmpty()?this:new Pe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Ml:n}}getChild(e){const n=ye(e);return n===null?this:this.getImmediateChild(n).getChild(Ue(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(Y(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new Ce(e,n);let i,s;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?Ml:this.priorityNode_;return new Pe(i,o,s)}}updateChild(e,n){const r=ye(e);if(r===null)return n;{Y(ye(e)!==".priority"||us(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(Ue(e),n);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,i=0,s=!0;if(this.forEachChild(Mt,(o,a)=>{n[o]=a.val(e),r++,s&&Pe.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+EN(this.getPriority().val())+":"),this.forEachChild(Mt,(n,r)=>{const i=r.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":JR(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new Ce(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new Ce(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new Ce(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,Ce.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,Ce.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===wu?-1:0}withIndex(e){if(e===_a||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new Pe(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===_a||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Mt),i=n.getIterator(Mt);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===_a?null:this.indexMap_.get(e.toString())}}Pe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class V9 extends Pe{constructor(){super(new cn(_w),Pe.EMPTY_NODE,Gr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Pe.EMPTY_NODE}isEmpty(){return!1}}const wu=new V9;Object.defineProperties(Ce,{MIN:{value:new Ce(La,Pe.EMPTY_NODE)},MAX:{value:new Ce(fo,wu)}});wN.__EMPTY_NODE=Pe.EMPTY_NODE;St.__childrenNodeConstructor=Pe;N9(wu);M9(wu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F9=!0;function ht(t,e=null){if(t===null)return Pe.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),Y(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new St(n,ht(e))}if(!(t instanceof Array)&&F9){const n=[];let r=!1;if(mn(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=ht(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new Ce(o,l)))}}),n.length===0)return Pe.EMPTY_NODE;const s=Yh(n,R9,o=>o.name,_w);if(r){const o=Yh(n,Mt.getCompare());return new Pe(s,ht(e),new Gr({".priority":o},{".priority":Mt}))}else return new Pe(s,ht(e),Gr.Default)}else{let n=Pe.EMPTY_NODE;return mn(t,(r,i)=>{if(Mr(t,r)&&r.substring(0,1)!=="."){const s=ht(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(ht(e))}}x9(ht);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j9 extends lp{constructor(e){super(),this.indexPath_=e,Y(!we(e)&&ye(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Ao(e.name,n.name):s}makePost(e,n){const r=ht(e),i=Pe.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ce(n,i)}maxPost(){const e=Pe.EMPTY_NODE.updateChild(this.indexPath_,wu);return new Ce(fo,e)}toString(){return Xc(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U9 extends lp{compare(e,n){const r=e.node.compareTo(n.node);return r===0?Ao(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Ce.MIN}maxPost(){return Ce.MAX}makePost(e,n){const r=ht(e);return new Ce(n,r)}toString(){return".value"}}const $9=new U9;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B9(t){return{type:"value",snapshotNode:t}}function z9(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function W9(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function cI(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function q9(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Mt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Y(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Y(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:La}hasEnd(){return this.endSet_}getIndexEndValue(){return Y(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Y(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:fo}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Y(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Mt}copy(){const e=new vw;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function uI(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Mt?n="$priority":t.index_===$9?n="$value":t.index_===_a?n="$key":(Y(t.index_ instanceof j9,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Nt(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=Nt(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Nt(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Nt(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Nt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function dI(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Mt&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh extends mN{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(Y(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=vu("p:rest:"),this.listens_={}}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=Xh.getListenId_(e,r),a={};this.listens_[o]=a;const l=uI(e._queryParams);this.restRequest_(s+".json",l,(u,d)=>{let f=d;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(s,f,!1,r),Aa(this.listens_,o)===a){let m;u?u===401?m="permission_denied":m="rest_error:"+u:m="ok",i(m,null)}})}unlisten(e,n){const r=Xh.getListenId_(e,n);delete this.listens_[r]}get(e){const n=uI(e._queryParams),r=e._path.toString(),i=new Br;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ya(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Fc(a.responseText)}catch{pn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&pn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H9{constructor(){this.rootNode_=Pe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(){return{value:null,children:new Map}}function sl(t,e,n){if(we(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=ye(e);t.children.has(r)||t.children.set(r,Zh());const i=t.children.get(r);e=Ue(e),sl(i,e,n)}}function Ny(t,e){if(we(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Mt,(r,i)=>{sl(t,new Fe(r),i)}),Ny(t,e)}}else if(t.children.size>0){const n=ye(e);return e=Ue(e),t.children.has(n)&&Ny(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function xy(t,e,n){t.value!==null?n(e,t.value):G9(t,(r,i)=>{const s=new Fe(e.toString()+"/"+r);xy(i,s,n)})}function G9(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K9{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&mn(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI=10*1e3,Q9=30*1e3,J9=5*60*1e3;class Y9{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new K9(e);const r=hI+(Q9-hI)*Math.random();pc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;mn(e,(i,s)=>{s>0&&Mr(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),pc(this.reportStats_.bind(this),Math.floor(Math.random()*2*J9))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tr;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Tr||(Tr={}));function CN(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function kN(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function bN(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Tr.ACK_USER_WRITE,this.source=CN()}operationForChild(e){if(we(this.path)){if(this.affectedTree.value!=null)return Y(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Fe(e));return new ef(xe(),n,this.revert)}}else return Y(ye(this.path)===e,"operationForChild called for unrelated child."),new ef(Ue(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Tr.OVERWRITE}operationForChild(e){return we(this.path)?new po(this.source,xe(),this.snap.getImmediateChild(e)):new po(this.source,Ue(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Tr.MERGE}operationForChild(e){if(we(this.path)){const n=this.children.subtree(new Fe(e));return n.isEmpty()?null:n.value?new po(this.source,xe(),n.value):new Zc(this.source,xe(),n)}else return Y(ye(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Zc(this.source,Ue(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(we(e))return this.isFullyInitialized()&&!this.filtered_;const n=ye(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function X9(t,e,n,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(q9(o.childName,o.snapshotNode))}),Ol(t,i,"child_removed",e,r,n),Ol(t,i,"child_added",e,r,n),Ol(t,i,"child_moved",s,r,n),Ol(t,i,"child_changed",e,r,n),Ol(t,i,"value",e,r,n),i}function Ol(t,e,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,l)=>e5(t,a,l)),o.forEach(a=>{const l=Z9(t,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,t.query_))})})}function Z9(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function e5(t,e,n){if(e.childName==null||n.childName==null)throw Ja("Should only compare child_ events.");const r=new Ce(e.childName,e.snapshotNode),i=new Ce(n.childName,n.snapshotNode);return t.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(t,e){return{eventCache:t,serverCache:e}}function mc(t,e,n,r){return AN(new ww(e,n,r),t.serverCache)}function PN(t,e,n,r){return AN(t.eventCache,new ww(e,n,r))}function My(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function mo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mm;const t5=()=>(Mm||(Mm=new cn(U$)),Mm);class qe{static fromObject(e){let n=new qe(null);return mn(e,(r,i)=>{n=n.set(new Fe(r),i)}),n}constructor(e,n=t5()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:xe(),value:this.value};if(we(e))return null;{const r=ye(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(Ue(e),n);return s!=null?{path:lt(new Fe(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(we(e))return this;{const n=ye(e),r=this.children.get(n);return r!==null?r.subtree(Ue(e)):new qe(null)}}set(e,n){if(we(e))return new qe(n,this.children);{const r=ye(e),s=(this.children.get(r)||new qe(null)).set(Ue(e),n),o=this.children.insert(r,s);return new qe(this.value,o)}}remove(e){if(we(e))return this.children.isEmpty()?new qe(null):new qe(null,this.children);{const n=ye(e),r=this.children.get(n);if(r){const i=r.remove(Ue(e));let s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new qe(null):new qe(this.value,s)}else return this}}get(e){if(we(e))return this.value;{const n=ye(e),r=this.children.get(n);return r?r.get(Ue(e)):null}}setTree(e,n){if(we(e))return n;{const r=ye(e),s=(this.children.get(r)||new qe(null)).setTree(Ue(e),n);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new qe(this.value,o)}}fold(e){return this.fold_(xe(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(lt(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,xe(),n)}findOnPath_(e,n,r){const i=this.value?r(n,this.value):!1;if(i)return i;if(we(e))return null;{const s=ye(e),o=this.children.get(s);return o?o.findOnPath_(Ue(e),lt(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,xe(),n)}foreachOnPath_(e,n,r){if(we(e))return this;{this.value&&r(n,this.value);const i=ye(e),s=this.children.get(i);return s?s.foreachOnPath_(Ue(e),lt(n,i),r):new qe(null)}}foreach(e){this.foreach_(xe(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(lt(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e){this.writeTree_=e}static empty(){return new or(new qe(null))}}function gc(t,e,n){if(we(e))return new or(new qe(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=Fn(i,e);return s=s.updateChild(o,n),new or(t.writeTree_.set(i,s))}else{const i=new qe(n),s=t.writeTree_.setTree(e,i);return new or(s)}}}function fI(t,e,n){let r=t;return mn(n,(i,s)=>{r=gc(r,lt(e,i),s)}),r}function pI(t,e){if(we(e))return or.empty();{const n=t.writeTree_.setTree(e,new qe(null));return new or(n)}}function Oy(t,e){return Po(t,e)!=null}function Po(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Fn(n.path,e)):null}function mI(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Mt,(r,i)=>{e.push(new Ce(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Ce(r,i.value))}),e}function es(t,e){if(we(e))return t;{const n=Po(t,e);return n!=null?new or(new qe(n)):new or(t.writeTree_.subtree(e))}}function Dy(t){return t.writeTree_.isEmpty()}function Va(t,e){return RN(xe(),t.writeTree_,e)}function RN(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(Y(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=RN(lt(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(lt(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(t,e){return LN(e,t)}function n5(t,e,n,r,i){Y(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=gc(t.visibleWrites,e,n)),t.lastWriteId=r}function r5(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function i5(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);Y(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&s5(a,r.path)?i=!1:jn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return o5(t),!0;if(r.snap)t.visibleWrites=pI(t.visibleWrites,r.path);else{const a=r.children;mn(a,l=>{t.visibleWrites=pI(t.visibleWrites,lt(r.path,l))})}return!0}else return!1}function s5(t,e){if(t.snap)return jn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&jn(lt(t.path,n),e))return!0;return!1}function o5(t){t.visibleWrites=xN(t.allWrites,a5,xe()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function a5(t){return t.visible}function xN(t,e,n){let r=or.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let a;if(s.snap)jn(n,o)?(a=Fn(n,o),r=gc(r,a,s.snap)):jn(o,n)&&(a=Fn(o,n),r=gc(r,xe(),s.snap.getChild(a)));else if(s.children){if(jn(n,o))a=Fn(n,o),r=fI(r,a,s.children);else if(jn(o,n))if(a=Fn(o,n),we(a))r=fI(r,xe(),s.children);else{const l=Aa(s.children,ye(a));if(l){const u=l.getChild(Ue(a));r=gc(r,xe(),u)}}}else throw Ja("WriteRecord should have .snap or .children")}}return r}function MN(t,e,n,r,i){if(!r&&!i){const s=Po(t.visibleWrites,e);if(s!=null)return s;{const o=es(t.visibleWrites,e);if(Dy(o))return n;if(n==null&&!Oy(o,xe()))return null;{const a=n||Pe.EMPTY_NODE;return Va(o,a)}}}else{const s=es(t.visibleWrites,e);if(!i&&Dy(s))return n;if(!i&&n==null&&!Oy(s,xe()))return null;{const o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(jn(u.path,e)||jn(e,u.path))},a=xN(t.allWrites,o,e),l=n||Pe.EMPTY_NODE;return Va(a,l)}}}function l5(t,e,n){let r=Pe.EMPTY_NODE;const i=Po(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Mt,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=es(t.visibleWrites,e);return n.forEachChild(Mt,(o,a)=>{const l=Va(es(s,new Fe(o)),a);r=r.updateImmediateChild(o,l)}),mI(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=es(t.visibleWrites,e);return mI(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function c5(t,e,n,r,i){Y(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=lt(e,n);if(Oy(t.visibleWrites,s))return null;{const o=es(t.visibleWrites,s);return Dy(o)?i.getChild(n):Va(o,i.getChild(n))}}function u5(t,e,n,r){const i=lt(e,n),s=Po(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){const o=es(t.visibleWrites,i);return Va(o,r.getNode().getImmediateChild(n))}else return null}function d5(t,e){return Po(t.visibleWrites,e)}function h5(t,e,n,r,i,s,o){let a;const l=es(t.visibleWrites,e),u=Po(l,xe());if(u!=null)a=u;else if(n!=null)a=Va(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const d=[],f=o.getCompare(),m=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let w=m.getNext();for(;w&&d.length<i;)f(w,r)!==0&&d.push(w),w=m.getNext();return d}else return[]}function f5(){return{visibleWrites:or.empty(),allWrites:[],lastWriteId:-1}}function Ly(t,e,n,r){return MN(t.writeTree,t.treePath,e,n,r)}function ON(t,e){return l5(t.writeTree,t.treePath,e)}function gI(t,e,n,r){return c5(t.writeTree,t.treePath,e,n,r)}function tf(t,e){return d5(t.writeTree,lt(t.treePath,e))}function p5(t,e,n,r,i,s){return h5(t.writeTree,t.treePath,e,n,r,i,s)}function Ew(t,e,n){return u5(t.writeTree,t.treePath,e,n)}function DN(t,e){return LN(lt(t.treePath,e),t.writeTree)}function LN(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m5{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;Y(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),Y(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,cI(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,W9(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,z9(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,cI(r,e.snapshotNode,i.oldSnap));else throw Ja("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const VN=new g5;class Sw{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new ww(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ew(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:mo(this.viewCache_),s=p5(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}}function y5(t,e){Y(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),Y(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function _5(t,e,n,r,i){const s=new m5;let o,a;if(n.type===Tr.OVERWRITE){const u=n;u.source.fromUser?o=Vy(t,e,u.path,u.snap,r,i,s):(Y(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!we(u.path),o=nf(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===Tr.MERGE){const u=n;u.source.fromUser?o=w5(t,e,u.path,u.children,r,i,s):(Y(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=Fy(t,e,u.path,u.children,r,i,a,s))}else if(n.type===Tr.ACK_USER_WRITE){const u=n;u.revert?o=T5(t,e,u.path,r,i,s):o=E5(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===Tr.LISTEN_COMPLETE)o=S5(t,e,n.path,r,s);else throw Ja("Unknown operation type: "+n.type);const l=s.getChanges();return v5(e,o,l),{viewCache:o,changes:l}}function v5(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=My(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(B9(My(e)))}}function FN(t,e,n,r,i,s){const o=e.eventCache;if(tf(r,n)!=null)return e;{let a,l;if(we(n))if(Y(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=mo(e),d=u instanceof Pe?u:Pe.EMPTY_NODE,f=ON(r,d);a=t.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{const u=Ly(r,mo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{const u=ye(n);if(u===".priority"){Y(us(n)===1,"Can't have a priority with additional path components");const d=o.getNode();l=e.serverCache.getNode();const f=gI(r,n,d,l);f!=null?a=t.filter.updatePriority(d,f):a=o.getNode()}else{const d=Ue(n);let f;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const m=gI(r,n,o.getNode(),l);m!=null?f=o.getNode().getImmediateChild(u).updateChild(d,m):f=o.getNode().getImmediateChild(u)}else f=Ew(r,u,e.serverCache);f!=null?a=t.filter.updateChild(o.getNode(),u,f,d,i,s):a=o.getNode()}}return mc(e,a,o.isFullyInitialized()||we(n),t.filter.filtersNodes())}}function nf(t,e,n,r,i,s,o,a){const l=e.serverCache;let u;const d=o?t.filter:t.filter.getIndexedFilter();if(we(n))u=d.updateFullNode(l.getNode(),r,null);else if(d.filtersNodes()&&!l.isFiltered()){const w=l.getNode().updateChild(n,r);u=d.updateFullNode(l.getNode(),w,null)}else{const w=ye(n);if(!l.isCompleteForPath(n)&&us(n)>1)return e;const E=Ue(n),b=l.getNode().getImmediateChild(w).updateChild(E,r);w===".priority"?u=d.updatePriority(l.getNode(),b):u=d.updateChild(l.getNode(),w,b,E,VN,null)}const f=PN(e,u,l.isFullyInitialized()||we(n),d.filtersNodes()),m=new Sw(i,f,s);return FN(t,f,n,i,m,a)}function Vy(t,e,n,r,i,s,o){const a=e.eventCache;let l,u;const d=new Sw(i,e,s);if(we(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=mc(e,u,!0,t.filter.filtersNodes());else{const f=ye(n);if(f===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),l=mc(e,u,a.isFullyInitialized(),a.isFiltered());else{const m=Ue(n),w=a.getNode().getImmediateChild(f);let E;if(we(m))E=r;else{const v=d.getCompleteChild(f);v!=null?gw(m)===".priority"&&v.getChild(yN(m)).isEmpty()?E=v:E=v.updateChild(m,r):E=Pe.EMPTY_NODE}if(w.equals(E))l=e;else{const v=t.filter.updateChild(a.getNode(),f,E,m,d,o);l=mc(e,v,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function yI(t,e){return t.eventCache.isCompleteForChild(e)}function w5(t,e,n,r,i,s,o){let a=e;return r.foreach((l,u)=>{const d=lt(n,l);yI(e,ye(d))&&(a=Vy(t,a,d,u,i,s,o))}),r.foreach((l,u)=>{const d=lt(n,l);yI(e,ye(d))||(a=Vy(t,a,d,u,i,s,o))}),a}function _I(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Fy(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;we(n)?u=r:u=new qe(null).setTree(n,r);const d=e.serverCache.getNode();return u.children.inorderTraversal((f,m)=>{if(d.hasChild(f)){const w=e.serverCache.getNode().getImmediateChild(f),E=_I(t,w,m);l=nf(t,l,new Fe(f),E,i,s,o,a)}}),u.children.inorderTraversal((f,m)=>{const w=!e.serverCache.isCompleteForChild(f)&&m.value===null;if(!d.hasChild(f)&&!w){const E=e.serverCache.getNode().getImmediateChild(f),v=_I(t,E,m);l=nf(t,l,new Fe(f),v,i,s,o,a)}}),l}function E5(t,e,n,r,i,s,o){if(tf(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(we(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return nf(t,e,n,l.getNode().getChild(n),i,s,a,o);if(we(n)){let u=new qe(null);return l.getNode().forEachChild(_a,(d,f)=>{u=u.set(new Fe(d),f)}),Fy(t,e,n,u,i,s,a,o)}else return e}else{let u=new qe(null);return r.foreach((d,f)=>{const m=lt(n,d);l.isCompleteForPath(m)&&(u=u.set(d,l.getNode().getChild(m)))}),Fy(t,e,n,u,i,s,a,o)}}function S5(t,e,n,r,i){const s=e.serverCache,o=PN(e,s.getNode(),s.isFullyInitialized()||we(n),s.isFiltered());return FN(t,o,n,r,VN,i)}function T5(t,e,n,r,i,s){let o;if(tf(r,n)!=null)return e;{const a=new Sw(r,e,i),l=e.eventCache.getNode();let u;if(we(n)||ye(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Ly(r,mo(e));else{const f=e.serverCache.getNode();Y(f instanceof Pe,"serverChildren would be complete if leaf node"),d=ON(r,f)}d=d,u=t.filter.updateFullNode(l,d,s)}else{const d=ye(n);let f=Ew(r,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=l.getImmediateChild(d)),f!=null?u=t.filter.updateChild(l,d,f,Ue(n),a,s):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(l,d,Pe.EMPTY_NODE,Ue(n),a,s):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Ly(r,mo(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||tf(r,xe())!=null,mc(e,u,o,t.filter.filtersNodes())}}function I5(t,e){const n=mo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!we(e)&&!n.getImmediateChild(ye(e)).isEmpty())?n.getChild(e):null}function vI(t,e,n,r){e.type===Tr.MERGE&&e.source.queryId!==null&&(Y(mo(t.viewCache_),"We should always have a full cache before handling merges"),Y(My(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=_5(t.processor_,i,e,n,r);return y5(t.processor_,s.viewCache),Y(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,C5(t,s.changes,s.viewCache.eventCache.getNode())}function C5(t,e,n,r){const i=t.eventRegistrations_;return X9(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wI;function k5(t){Y(!wI,"__referenceConstructor has already been defined"),wI=t}function Tw(t,e,n,r){const i=e.source.queryId;if(i!==null){const s=t.views.get(i);return Y(s!=null,"SyncTree gave us an op for an invalid query."),vI(s,e,n,r)}else{let s=[];for(const o of t.views.values())s=s.concat(vI(o,e,n,r));return s}}function Iw(t,e){let n=null;for(const r of t.views.values())n=n||I5(r,e);return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EI;function b5(t){Y(!EI,"__referenceConstructor has already been defined"),EI=t}class SI{constructor(e){this.listenProvider_=e,this.syncPointTree_=new qe(null),this.pendingWriteTree_=f5(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function jN(t,e,n,r,i){return n5(t.pendingWriteTree_,e,n,r,i),i?up(t,new po(CN(),e,n)):[]}function Gs(t,e,n=!1){const r=r5(t.pendingWriteTree_,e);if(i5(t.pendingWriteTree_,e)){let s=new qe(null);return r.snap!=null?s=s.set(xe(),!0):mn(r.children,o=>{s=s.set(new Fe(o),!0)}),up(t,new ef(r.path,s,n))}else return[]}function cp(t,e,n){return up(t,new po(kN(),e,n))}function A5(t,e,n){const r=qe.fromObject(n);return up(t,new Zc(kN(),e,r))}function P5(t,e,n,r){const i=BN(t,r);if(i!=null){const s=zN(i),o=s.path,a=s.queryId,l=Fn(o,e),u=new po(bN(a),l,n);return WN(t,o,u)}else return[]}function R5(t,e,n,r){const i=BN(t,r);if(i){const s=zN(i),o=s.path,a=s.queryId,l=Fn(o,e),u=qe.fromObject(n),d=new Zc(bN(a),l,u);return WN(t,o,d)}else return[]}function Cw(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=Fn(o,e),u=Iw(a,l);if(u)return u});return MN(i,e,s,n,!0)}function up(t,e){return UN(e,t.syncPointTree_,null,NN(t.pendingWriteTree_,xe()))}function UN(t,e,n,r){if(we(t.path))return $N(t,e,n,r);{const i=e.get(xe());n==null&&i!=null&&(n=Iw(i,xe()));let s=[];const o=ye(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const u=n?n.getImmediateChild(o):null,d=DN(r,o);s=s.concat(UN(a,l,u,d))}return i&&(s=s.concat(Tw(i,t,r,n))),s}}function $N(t,e,n,r){const i=e.get(xe());n==null&&i!=null&&(n=Iw(i,xe()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,u=DN(r,o),d=t.operationForChild(o);d&&(s=s.concat($N(d,a,l,u)))}),i&&(s=s.concat(Tw(i,t,r,n))),s}function BN(t,e){return t.tagToQueryMap.get(e)}function zN(t){const e=t.indexOf("$");return Y(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Fe(t.substr(0,e))}}function WN(t,e,n){const r=t.syncPointTree_.get(e);Y(r,"Missing sync point for query tag that we're tracking");const i=NN(t.pendingWriteTree_,e);return Tw(r,n,i,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new kw(n)}node(){return this.node_}}class bw{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=lt(this.path_,e);return new bw(this.syncTree_,n)}node(){return Cw(this.syncTree_,this.path_)}}const N5=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},TI=function(t,e,n){if(!t||typeof t!="object")return t;if(Y(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return x5(t[".sv"],e,n);if(typeof t[".sv"]=="object")return M5(t[".sv"],e);Y(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},x5=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:Y(!1,"Unexpected server value: "+t)}},M5=function(t,e,n){t.hasOwnProperty("increment")||Y(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&Y(!1,"Unexpected increment value: "+r);const i=e.node();if(Y(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},O5=function(t,e,n,r){return Aw(e,new bw(n,t),r)},qN=function(t,e,n){return Aw(t,new kw(e),n)};function Aw(t,e,n){const r=t.getPriority().val(),i=TI(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=TI(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new St(a,ht(i)):t}else{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new St(i))),o.forEachChild(Mt,(a,l)=>{const u=Aw(l,e.getImmediateChild(a),n);u!==l&&(s=s.updateImmediateChild(a,u))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Rw(t,e){let n=e instanceof Fe?e:new Fe(e),r=t,i=ye(n);for(;i!==null;){const s=Aa(r.node.children,i)||{children:{},childCount:0};r=new Pw(i,r,s),n=Ue(n),i=ye(n)}return r}function ol(t){return t.node.value}function HN(t,e){t.node.value=e,jy(t)}function GN(t){return t.node.childCount>0}function D5(t){return ol(t)===void 0&&!GN(t)}function dp(t,e){mn(t.node.children,(n,r)=>{e(new Pw(n,t,r))})}function KN(t,e,n,r){n&&e(t),dp(t,i=>{KN(i,e,!0)})}function L5(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Eu(t){return new Fe(t.parent===null?t.name:Eu(t.parent)+"/"+t.name)}function jy(t){t.parent!==null&&V5(t.parent,t.name,t)}function V5(t,e,n){const r=D5(n),i=Mr(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,jy(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,jy(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F5=/[\[\].#$\/\u0000-\u001F\u007F]/,j5=/[\[\].#$\u0000-\u001F\u007F]/,Om=10*1024*1024,Nw=function(t){return typeof t=="string"&&t.length!==0&&!F5.test(t)},QN=function(t){return typeof t=="string"&&t.length!==0&&!j5.test(t)},U5=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),QN(t)},JN=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!ap(t)||t&&typeof t=="object"&&Mr(t,".sv")},Uy=function(t,e,n,r){hp(Pa(t,"value"),e,n)},hp=function(t,e,n){const r=n instanceof Fe?new S9(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Fs(r));if(typeof e=="function")throw new Error(t+"contains a function "+Fs(r)+" with contents = "+e.toString());if(ap(e))throw new Error(t+"contains "+e.toString()+" "+Fs(r));if(typeof e=="string"&&e.length>Om/3&&Mf(e)>Om)throw new Error(t+"contains a string greater than "+Om+" utf8 bytes "+Fs(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(mn(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Nw(o)))throw new Error(t+" contains an invalid key ("+o+") "+Fs(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);T9(r,o),hp(t,a,r),I9(r)}),i&&s)throw new Error(t+' contains ".value" child '+Fs(r)+" in addition to actual children.")}},$5=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=Xc(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Nw(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(E9);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&jn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},B5=function(t,e,n,r){const i=Pa(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];mn(e,(o,a)=>{const l=new Fe(o);if(hp(i,a,lt(n,l)),gw(l)===".priority"&&!JN(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),$5(i,s)},z5=function(t,e,n){if(ap(e))throw new Error(Pa(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!JN(e))throw new Error(Pa(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},YN=function(t,e,n,r){if(!QN(n))throw new Error(Pa(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},W5=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),YN(t,e,n)},Kl=function(t,e){if(ye(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},q5=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Nw(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!U5(n))throw new Error(Pa(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function XN(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();n!==null&&!_N(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function ui(t,e,n){XN(t,n),G5(t,r=>jn(r,e)||jn(e,r))}function G5(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];if(i){const s=i.path;e(s)?(K5(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function K5(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();fc&&Rt("event: "+n.toString()),il(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5="repo_interrupt",J5=25;class Y5{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new H5,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Zh(),this.transactionQueueTree_=new Pw,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function X5(t,e,n){if(t.stats_=pw(t.repoInfo_),t.forceRestClient_||H$())t.server_=new Xh(t.repoInfo_,(r,i,s,o)=>{II(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>CI(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Nt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Xr(t.repoInfo_,e,(r,i,s,o)=>{II(t,r,i,s,o)},r=>{CI(t,r)},r=>{eB(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=Y$(t.repoInfo_,()=>new Y9(t.stats_,t.server_)),t.infoData_=new H9,t.infoSyncTree_=new SI({startListening:(r,i,s,o)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=cp(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Mw(t,"connected",!1),t.serverSyncTree_=new SI({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,l)=>{const u=o(a,l);ui(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function Z5(t){const n=t.infoData_.getNode(new Fe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function xw(t){return N5({timestamp:Z5(t)})}function II(t,e,n,r,i){t.dataUpdateCount++;const s=new Fe(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const l=bh(n,u=>ht(u));o=R5(t.serverSyncTree_,s,l,i)}else{const l=ht(n);o=P5(t.serverSyncTree_,s,l,i)}else if(r){const l=bh(n,u=>ht(u));o=A5(t.serverSyncTree_,s,l)}else{const l=ht(n);o=cp(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=fp(t,s)),ui(t.eventQueue_,a,o)}function CI(t,e){Mw(t,"connected",e),e===!1&&nB(t)}function eB(t,e){mn(e,(n,r)=>{Mw(t,n,r)})}function Mw(t,e,n){const r=new Fe("/.info/"+e),i=ht(n);t.infoData_.updateSnapshot(r,i);const s=cp(t.infoSyncTree_,r,i);ui(t.eventQueue_,r,s)}function ZN(t){return t.nextWriteId_++}function tB(t,e,n,r,i){Ow(t,"set",{path:e.toString(),value:n,priority:r});const s=xw(t),o=ht(n,r),a=Cw(t.serverSyncTree_,e),l=qN(o,a,s),u=ZN(t),d=jN(t.serverSyncTree_,e,l,u,!0);XN(t.eventQueue_,d),t.server_.put(e.toString(),o.val(!0),(m,w)=>{const E=m==="ok";E||pn("set at "+e+" failed: "+m);const v=Gs(t.serverSyncTree_,u,!E);ui(t.eventQueue_,e,v),Fa(t,i,m,w)});const f=ix(t,e);fp(t,f),ui(t.eventQueue_,f,[])}function nB(t){Ow(t,"onDisconnectEvents");const e=xw(t),n=Zh();xy(t.onDisconnect_,xe(),(i,s)=>{const o=O5(i,s,t.serverSyncTree_,e);sl(n,i,o)});let r=[];xy(n,xe(),(i,s)=>{r=r.concat(cp(t.serverSyncTree_,i,s));const o=ix(t,i);fp(t,o)}),t.onDisconnect_=Zh(),ui(t.eventQueue_,xe(),r)}function rB(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&Ny(t.onDisconnect_,e),Fa(t,n,r,i)})}function kI(t,e,n,r){const i=ht(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&sl(t.onDisconnect_,e,i),Fa(t,r,s,o)})}function iB(t,e,n,r,i){const s=ht(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&sl(t.onDisconnect_,e,s),Fa(t,i,o,a)})}function sB(t,e,n,r){if(kh(n)){Rt("onDisconnect().update() called with empty data.  Don't do anything."),Fa(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&mn(n,(o,a)=>{const l=ht(a);sl(t.onDisconnect_,lt(e,o),l)}),Fa(t,r,i,s)})}function oB(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Q5)}function Ow(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Rt(n,...e)}function Fa(t,e,n,r){e&&il(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function ex(t,e,n){return Cw(t.serverSyncTree_,e,n)||Pe.EMPTY_NODE}function Dw(t,e=t.transactionQueueTree_){if(e||pp(t,e),ol(e)){const n=nx(t,e);Y(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&aB(t,Eu(e),n)}else GN(e)&&dp(e,n=>{Dw(t,n)})}function aB(t,e,n){const r=n.map(u=>u.currentWriteId),i=ex(t,e,r);let s=i;const o=i.hash();for(let u=0;u<n.length;u++){const d=n[u];Y(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const f=Fn(e,d.path);s=s.updateChild(f,d.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;t.server_.put(l.toString(),a,u=>{Ow(t,"transaction put response",{path:l.toString(),status:u});let d=[];if(u==="ok"){const f=[];for(let m=0;m<n.length;m++)n[m].status=2,d=d.concat(Gs(t.serverSyncTree_,n[m].currentWriteId)),n[m].onComplete&&f.push(()=>n[m].onComplete(null,!0,n[m].currentOutputSnapshotResolved)),n[m].unwatcher();pp(t,Rw(t.transactionQueueTree_,e)),Dw(t,t.transactionQueueTree_),ui(t.eventQueue_,e,d);for(let m=0;m<f.length;m++)il(f[m])}else{if(u==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{pn("transaction at "+l.toString()+" failed: "+u);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=u}fp(t,e)}},o)}function fp(t,e){const n=tx(t,e),r=Eu(n),i=nx(t,n);return lB(t,i,r),r}function lB(t,e,n){if(e.length===0)return;const r=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=Fn(n,l.path);let d=!1,f;if(Y(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)d=!0,f=l.abortReason,i=i.concat(Gs(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=J5)d=!0,f="maxretry",i=i.concat(Gs(t.serverSyncTree_,l.currentWriteId,!0));else{const m=ex(t,l.path,o);l.currentInputSnapshot=m;const w=e[a].update(m.val());if(w!==void 0){hp("transaction failed: Data returned ",w,l.path);let E=ht(w);typeof w=="object"&&w!=null&&Mr(w,".priority")||(E=E.updatePriority(m.getPriority()));const b=l.currentWriteId,S=xw(t),T=qN(E,m,S);l.currentOutputSnapshotRaw=E,l.currentOutputSnapshotResolved=T,l.currentWriteId=ZN(t),o.splice(o.indexOf(b),1),i=i.concat(jN(t.serverSyncTree_,l.path,T,l.currentWriteId,l.applyLocally)),i=i.concat(Gs(t.serverSyncTree_,b,!0))}else d=!0,f="nodata",i=i.concat(Gs(t.serverSyncTree_,l.currentWriteId,!0))}ui(t.eventQueue_,n,i),i=[],d&&(e[a].status=2,function(m){setTimeout(m,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}pp(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)il(r[a]);Dw(t,t.transactionQueueTree_)}function tx(t,e){let n,r=t.transactionQueueTree_;for(n=ye(e);n!==null&&ol(r)===void 0;)r=Rw(r,n),e=Ue(e),n=ye(e);return r}function nx(t,e){const n=[];return rx(t,e,n),n.sort((r,i)=>r.order-i.order),n}function rx(t,e,n){const r=ol(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);dp(e,i=>{rx(t,i,n)})}function pp(t,e){const n=ol(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,HN(e,n.length>0?n:void 0)}dp(e,r=>{pp(t,r)})}function ix(t,e){const n=Eu(tx(t,e)),r=Rw(t.transactionQueueTree_,e);return L5(r,i=>{Dm(t,i)}),Dm(t,r),KN(r,i=>{Dm(t,i)}),n}function Dm(t,e){const n=ol(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(Y(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(Y(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Gs(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?HN(e,void 0):n.length=s+1,ui(t.eventQueue_,Eu(e),i);for(let o=0;o<r.length;o++)il(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cB(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function uB(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):pn(`Invalid query segment '${n}' in query '${t}'`)}return e}const bI=function(t,e){const n=dB(t),r=n.namespace;n.domain==="firebase.com"&&ci(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&ci("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||F$();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new lN(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Fe(n.pathString)}},dB=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(d,f)),d<f&&(i=cB(t.substring(d,f)));const m=uB(t.substring(Math.min(t.length,f)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const w=e.slice(0,u);if(w.toLowerCase()==="localhost")n="localhost";else if(w.split(".").length<=2)n=w;else{const E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),n=e.substring(E+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hB{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Br;return rB(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Kl("OnDisconnect.remove",this._path);const e=new Br;return kI(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Kl("OnDisconnect.set",this._path),Uy("OnDisconnect.set",e,this._path);const n=new Br;return kI(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Kl("OnDisconnect.setWithPriority",this._path),Uy("OnDisconnect.setWithPriority",e,this._path),z5("OnDisconnect.setWithPriority",n);const r=new Br;return iB(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){Kl("OnDisconnect.update",this._path),B5("OnDisconnect.update",e,this._path);const n=new Br;return sB(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return we(this._path)?null:gw(this._path)}get ref(){return new Ro(this._repo,this._path)}get _queryIdentifier(){const e=dI(this._queryParams),n=hw(e);return n==="{}"?"default":n}get _queryObject(){return dI(this._queryParams)}isEqual(e){if(e=Me(e),!(e instanceof Lw))return!1;const n=this._repo===e._repo,r=_N(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+w9(this._path)}}class Ro extends Lw{constructor(e,n){super(e,n,new vw,!1)}get parent(){const e=yN(this._path);return e===null?null:new Ro(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}function fB(t,e){return t=Me(t),t._checkNotDeleted("ref"),e!==void 0?pB(t._root,e):t._root}function pB(t,e){return t=Me(t),ye(t._path)===null?W5("child","path",e):YN("child","path",e),new Ro(t._repo,lt(t._path,e))}function mB(t){return t=Me(t),new hB(t._repo,t._path)}function gB(t,e){t=Me(t),Kl("set",t._path),Uy("set",e,t._path);const n=new Br;return tB(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}k5(Ro);b5(Ro);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yB="FIREBASE_DATABASE_EMULATOR_HOST",$y={};let _B=!1;function vB(t,e,n,r){const i=e.lastIndexOf(":"),s=e.substring(0,i),o=_s(s);t.repoInfo_=new lN(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(t.authTokenProvider_=r)}function wB(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||ci("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=bI(s,i),a=o.repoInfo,l;typeof process<"u"&&HT&&(l=HT[yB]),l?(s=`http://${l}?ns=${a.namespace}`,o=bI(s,i),a=o.repoInfo):o.repoInfo.secure;const u=new K$(t.name,t.options,e);q5("Invalid Firebase Database URL",o),we(o.path)||ci("Database URL must point to the root of a Firebase Database (not including a child path).");const d=SB(a,t,u,new G$(t,n));return new TB(d,t)}function EB(t,e){const n=$y[e];(!n||n[t.key]!==t)&&ci(`Database ${e}(${t.repoInfo_}) has already been deleted.`),oB(t),delete n[t.key]}function SB(t,e,n,r){let i=$y[e.name];i||(i={},$y[e.name]=i);let s=i[t.toURLString()];return s&&ci("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Y5(t,_B,n,r),i[t.toURLString()]=s,s}class TB{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(X5(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ro(this._repo,xe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(EB(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ci("Cannot call "+e+" on a deleted database.")}}function IB(t=Of(),e){const n=vs(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=Y1("database");r&&CB(n,...r)}return n}function CB(t,e,n,r={}){t=Me(t),t._checkNotDeleted("useEmulator");const i=`${e}:${n}`,s=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&ii(r,s.repoInfo_.emulatorOptions))return;ci("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&ci('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Gd(Gd.OWNER);else if(r.mockUserToken){const a=typeof r.mockUserToken=="string"?r.mockUserToken:eA(r.mockUserToken,t.app.options.projectId);o=new Gd(a)}_s(e)&&(fv(e),pv("Database",!0)),vB(s,i,r,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kB(t){x$(To),cr(new Gn("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return wB(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),fn(GT,KT,t),fn(GT,KT,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bB={".sv":"timestamp"};function AI(){return bB}Xr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Xr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};kB();const AB={apiKey:"AIzaSyAtBRrVvheg2cIVyBq7RfXLTRlwXGhyw6Q",authDomain:"totalreliefmd.firebaseapp.com",projectId:"totalreliefmd",storageBucket:"totalreliefmd.firebasestorage.app",messagingSenderId:"906049680832",appId:"1:906049680832:web:76093f680d8a3009398425",measurementId:"G-CT16QBMPPC"},mp=yv(AB),rf=HA(mp),Xt=H3(mp),PB=IB(mp);b$(mp);const sx=q.createContext({currentUser:null,userProfile:null,loading:!0,isAdmin:!1,isSupervisor:!1,isFacility:!1}),No=()=>q.useContext(sx),RB=({children:t})=>{const[e,n]=q.useState(null),[r,i]=q.useState(null),[s,o]=q.useState(!0);q.useEffect(()=>VF(rf,async u=>{if(n(u),u)try{const d=rr(Xt,"users",u.uid),f=await o6(d);f.exists()?i(f.data()):(console.warn("User document does not exist in Firestore for UID:",u.uid),i(null))}catch(d){console.error("Error fetching user profile:",d),i(null)}else i(null);o(!1)}),[]);const a={currentUser:e,userProfile:r,loading:s,isAdmin:(r==null?void 0:r.role)==="admin",isSupervisor:(r==null?void 0:r.role)==="supervisor",isFacility:(r==null?void 0:r.role)==="facility"};return D.jsx(sx.Provider,{value:a,children:!s&&t})};function PI(t,e){if(t==null)return{};var n,r,i=function(o,a){if(o==null)return{};var l={};for(var u in o)if({}.hasOwnProperty.call(o,u)){if(a.indexOf(u)!==-1)continue;l[u]=o[u]}return l}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Rn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ke(t){return ke=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ke(t)}function ox(t){var e=function(n,r){if(ke(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var s=i.call(n,r);if(ke(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(t,"string");return ke(e)=="symbol"?e:e+""}function RI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ox(r.key),r)}}function Nn(t,e,n){return e&&RI(t.prototype,e),n&&RI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function gp(t,e){if(e&&(ke(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(t)}function hr(t){return hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hr(t)}function eu(t,e){return eu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},eu(t,e)}function yp(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eu(t,e)}function Er(t,e,n){return(e=ox(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NI(t,e,n,r,i,s,o){try{var a=t[s](o),l=a.value}catch(u){return void n(u)}a.done?e(l):Promise.resolve(l).then(r,i)}function le(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(l){NI(s,r,i,o,a,"next",l)}function a(l){NI(s,r,i,o,a,"throw",l)}o(void 0)})}}function xI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Wt(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var i=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(i!=null){var s,o,a,l,u=[],d=!0,f=!1;try{if(a=(i=i.call(n)).next,r===0){if(Object(i)!==i)return;d=!1}else for(;!(d=(s=a.call(i)).done)&&(u.push(s.value),u.length!==r);d=!0);}catch(m){f=!0,o=m}finally{try{if(!d&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(f)throw o}}return u}}(t,e)||function(n,r){if(n){if(typeof n=="string")return xI(n,r);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?xI(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function NB(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var MI,cd={exports:{}},By=function(){if(MI)return cd.exports;MI=1;var t,e=typeof Reflect=="object"?Reflect:null,n=e&&typeof e.apply=="function"?e.apply:function(v,b,S){return Function.prototype.apply.call(v,b,S)};t=e&&typeof e.ownKeys=="function"?e.ownKeys:Object.getOwnPropertySymbols?function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:function(v){return Object.getOwnPropertyNames(v)};var r=Number.isNaN||function(v){return v!=v};function i(){i.init.call(this)}cd.exports=i,cd.exports.once=function(v,b){return new Promise(function(S,T){function k(U){v.removeListener(b,L),T(U)}function L(){typeof v.removeListener=="function"&&v.removeListener("error",k),S([].slice.call(arguments))}E(v,b,L,{once:!0}),b!=="error"&&function(U,z,A){typeof U.on=="function"&&E(U,"error",z,A)}(v,k,{once:!0})})},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function o(v){if(typeof v!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof v)}function a(v){return v._maxListeners===void 0?i.defaultMaxListeners:v._maxListeners}function l(v,b,S,T){var k,L,U,z;if(o(S),(L=v._events)===void 0?(L=v._events=Object.create(null),v._eventsCount=0):(L.newListener!==void 0&&(v.emit("newListener",b,S.listener?S.listener:S),L=v._events),U=L[b]),U===void 0)U=L[b]=S,++v._eventsCount;else if(typeof U=="function"?U=L[b]=T?[S,U]:[U,S]:T?U.unshift(S):U.push(S),(k=a(v))>0&&U.length>k&&!U.warned){U.warned=!0;var A=new Error("Possible EventEmitter memory leak detected. "+U.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");A.name="MaxListenersExceededWarning",A.emitter=v,A.type=b,A.count=U.length,z=A,console&&console.warn&&console.warn(z)}return v}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(v,b,S){var T={fired:!1,wrapFn:void 0,target:v,type:b,listener:S},k=u.bind(T);return k.listener=S,T.wrapFn=k,k}function f(v,b,S){var T=v._events;if(T===void 0)return[];var k=T[b];return k===void 0?[]:typeof k=="function"?S?[k.listener||k]:[k]:S?function(L){for(var U=new Array(L.length),z=0;z<U.length;++z)U[z]=L[z].listener||L[z];return U}(k):w(k,k.length)}function m(v){var b=this._events;if(b!==void 0){var S=b[v];if(typeof S=="function")return 1;if(S!==void 0)return S.length}return 0}function w(v,b){for(var S=new Array(b),T=0;T<b;++T)S[T]=v[T];return S}function E(v,b,S,T){if(typeof v.on=="function")T.once?v.once(b,S):v.on(b,S);else{if(typeof v.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof v);v.addEventListener(b,function k(L){T.once&&v.removeEventListener(b,k),S(L)})}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(v){if(typeof v!="number"||v<0||r(v))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+v+".");s=v}}),i.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||r(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");return this._maxListeners=v,this},i.prototype.getMaxListeners=function(){return a(this)},i.prototype.emit=function(v){for(var b=[],S=1;S<arguments.length;S++)b.push(arguments[S]);var T=v==="error",k=this._events;if(k!==void 0)T=T&&k.error===void 0;else if(!T)return!1;if(T){var L;if(b.length>0&&(L=b[0]),L instanceof Error)throw L;var U=new Error("Unhandled error."+(L?" ("+L.message+")":""));throw U.context=L,U}var z=k[v];if(z===void 0)return!1;if(typeof z=="function")n(z,this,b);else{var A=z.length,C=w(z,A);for(S=0;S<A;++S)n(C[S],this,b)}return!0},i.prototype.addListener=function(v,b){return l(this,v,b,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(v,b){return l(this,v,b,!0)},i.prototype.once=function(v,b){return o(b),this.on(v,d(this,v,b)),this},i.prototype.prependOnceListener=function(v,b){return o(b),this.prependListener(v,d(this,v,b)),this},i.prototype.removeListener=function(v,b){var S,T,k,L,U;if(o(b),(T=this._events)===void 0)return this;if((S=T[v])===void 0)return this;if(S===b||S.listener===b)--this._eventsCount==0?this._events=Object.create(null):(delete T[v],T.removeListener&&this.emit("removeListener",v,S.listener||b));else if(typeof S!="function"){for(k=-1,L=S.length-1;L>=0;L--)if(S[L]===b||S[L].listener===b){U=S[L].listener,k=L;break}if(k<0)return this;k===0?S.shift():function(z,A){for(;A+1<z.length;A++)z[A]=z[A+1];z.pop()}(S,k),S.length===1&&(T[v]=S[0]),T.removeListener!==void 0&&this.emit("removeListener",v,U||b)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(v){var b,S,T;if((S=this._events)===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[v]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete S[v]),this;if(arguments.length===0){var k,L=Object.keys(S);for(T=0;T<L.length;++T)(k=L[T])!=="removeListener"&&this.removeAllListeners(k);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(b=S[v])=="function")this.removeListener(v,b);else if(b!==void 0)for(T=b.length-1;T>=0;T--)this.removeListener(v,b[T]);return this},i.prototype.listeners=function(v){return f(this,v,!0)},i.prototype.rawListeners=function(v){return f(this,v,!1)},i.listenerCount=function(v,b){return typeof v.listenerCount=="function"?v.listenerCount(b):m.call(v,b)},i.prototype.listenerCount=m,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]},cd.exports}(),ud=NB(By),OI=Object.prototype.hasOwnProperty;function DI(t,e,n){for(n of t.keys())if(Yt(n,e))return n}function Yt(t,e){var n,r,i;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&Yt(t[r],e[r]););return r===-1}if(n===Set){if(t.size!==e.size)return!1;for(r of t)if((i=r)&&typeof i=="object"&&!(i=DI(e,i))||!e.has(i))return!1;return!0}if(n===Map){if(t.size!==e.size)return!1;for(r of t)if((i=r[0])&&typeof i=="object"&&!(i=DI(e,i))||!Yt(r[1],e.get(i)))return!1;return!0}if(n===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(n===DataView){if((r=t.byteLength)===e.byteLength)for(;r--&&t.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(t)){if((r=t.byteLength)===e.byteLength)for(;r--&&t[r]===e[r];);return r===-1}if(!n||typeof t=="object"){for(n in r=0,t)if(OI.call(t,n)&&++r&&!OI.call(e,n)||!(n in e)||!Yt(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!=t&&e!=e}const xB={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},ax={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},st={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Qt={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Ci={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class H{static getFirstMatch(e,n){const r=n.match(e);return r&&r.length>0&&r[1]||""}static getSecondMatch(e,n){const r=n.match(e);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(e,n,r){if(e.test(n))return r}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const n=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(n.push(0),n[0]===10)switch(n[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const n=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(n.push(0),!(n[0]===1&&n[1]<5))return n[0]===1&&n[1]<6?"Cupcake":n[0]===1&&n[1]>=6?"Donut":n[0]===2&&n[1]<2?"Eclair":n[0]===2&&n[1]===2?"Froyo":n[0]===2&&n[1]>2?"Gingerbread":n[0]===3?"Honeycomb":n[0]===4&&n[1]<1?"Ice Cream Sandwich":n[0]===4&&n[1]<4?"Jelly Bean":n[0]===4&&n[1]>=4?"KitKat":n[0]===5?"Lollipop":n[0]===6?"Marshmallow":n[0]===7?"Nougat":n[0]===8?"Oreo":n[0]===9?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,n,r=!1){const i=H.getVersionPrecision(e),s=H.getVersionPrecision(n);let o=Math.max(i,s),a=0;const l=H.map([e,n],u=>{const d=o-H.getVersionPrecision(u),f=u+new Array(d+1).join(".0");return H.map(f.split("."),m=>new Array(20-m.length).join("0")+m).reverse()});for(r&&(a=o-Math.min(i,s)),o-=1;o>=a;){if(l[0][o]>l[1][o])return 1;if(l[0][o]===l[1][o]){if(o===a)return 0;o-=1}else if(l[0][o]<l[1][o])return-1}}static map(e,n){const r=[];let i;if(Array.prototype.map)return Array.prototype.map.call(e,n);for(i=0;i<e.length;i+=1)r.push(n(e[i]));return r}static find(e,n){let r,i;if(Array.prototype.find)return Array.prototype.find.call(e,n);for(r=0,i=e.length;r<i;r+=1){const s=e[r];if(n(s,r))return s}}static assign(e,...n){const r=e;let i,s;if(Object.assign)return Object.assign(e,...n);for(i=0,s=n.length;i<s;i+=1){const o=n[i];typeof o=="object"&&o!==null&&Object.keys(o).forEach(a=>{r[a]=o[a]})}return e}static getBrowserAlias(e){return xB[e]}static getBrowserTypeByAlias(e){return ax[e]||""}}const Le=/version\/(\d+(\.?_?\d+)+)/i,MB=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},n=H.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},n=H.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},n=H.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},n=H.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},n=H.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},n=H.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},n=H.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},n=H.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},n=H.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},n=H.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},n=H.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},n=H.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},n=H.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},n=H.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},n=H.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return n&&(e.version=n),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},n=H.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},n=H.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},n=H.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},n=H.getFirstMatch(Le,t)||H.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},n=H.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},n=H.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},n=H.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},n=H.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},n=H.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},n=H.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},n=H.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},n=H.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},n=H.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e={name:"Android Browser"},n=H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},n=H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},n=H.getFirstMatch(Le,t);return n&&(e.version=n),e}},{test:[/.*/i],describe(t){const e=t.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:H.getFirstMatch(e,t),version:H.getSecondMatch(e,t)}}}];var OB=[{test:[/Roku\/DVP/],describe(t){const e=H.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:Qt.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=H.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:Qt.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=H.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),n=H.getWindowsVersionName(e);return{name:Qt.Windows,version:e,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:Qt.iOS},n=H.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return n&&(e.version=n),e}},{test:[/macintosh/i],describe(t){const e=H.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),n=H.getMacOSVersionName(e),r={name:Qt.MacOS,version:e};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=H.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:Qt.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e=H.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),n=H.getAndroidVersionName(e),r={name:Qt.Android,version:e};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=H.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),n={name:Qt.WebOS};return e&&e.length&&(n.version=e),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=H.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||H.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||H.getFirstMatch(/\bbb(\d+)/i,t);return{name:Qt.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=H.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:Qt.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=H.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:Qt.Tizen,version:e}}},{test:[/linux/i],describe:()=>({name:Qt.Linux})},{test:[/CrOS/],describe:()=>({name:Qt.ChromeOS})},{test:[/PlayStation 4/],describe(t){const e=H.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:Qt.PlayStation4,version:e}}}],DB=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(t){const e=H.getFirstMatch(/(can-l01)/i,t)&&"Nova",n={type:st.mobile,vendor:"Huawei"};return e&&(n.model=e),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:st.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:st.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:st.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:st.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:st.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:st.tablet})},{test(t){const e=t.test(/ipod|iphone/i),n=t.test(/like (ipod|iphone)/i);return e&&!n},describe(t){const e=H.getFirstMatch(/(ipod|iphone)/i,t);return{type:st.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:st.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:st.mobile})},{test:t=>t.getBrowserName(!0)==="blackberry",describe:()=>({type:st.mobile,vendor:"BlackBerry"})},{test:t=>t.getBrowserName(!0)==="bada",describe:()=>({type:st.mobile})},{test:t=>t.getBrowserName()==="windows phone",describe:()=>({type:st.mobile,vendor:"Microsoft"})},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe:()=>({type:st.tablet})},{test:t=>t.getOSName(!0)==="android",describe:()=>({type:st.mobile})},{test:t=>t.getOSName(!0)==="macos",describe:()=>({type:st.desktop,vendor:"Apple"})},{test:t=>t.getOSName(!0)==="windows",describe:()=>({type:st.desktop})},{test:t=>t.getOSName(!0)==="linux",describe:()=>({type:st.desktop})},{test:t=>t.getOSName(!0)==="playstation 4",describe:()=>({type:st.tv})},{test:t=>t.getOSName(!0)==="roku",describe:()=>({type:st.tv})}],LB=[{test:t=>t.getBrowserName(!0)==="microsoft edge",describe(t){if(/\sedg\//i.test(t))return{name:Ci.Blink};const e=H.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:Ci.EdgeHTML,version:e}}},{test:[/trident/i],describe(t){const e={name:Ci.Trident},n=H.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:t=>t.test(/presto/i),describe(t){const e={name:Ci.Presto},n=H.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=t.test(/gecko/i),n=t.test(/like gecko/i);return e&&!n},describe(t){const e={name:Ci.Gecko},n=H.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:Ci.Blink})},{test:[/(apple)?webkit/i],describe(t){const e={name:Ci.WebKit},n=H.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}}];class LI{constructor(e,n=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},n!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=H.find(MB,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=H.find(OB,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:n}=this.getOS();return e?String(n).toLowerCase()||"":n||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:n}=this.getPlatform();return e?String(n).toLowerCase()||"":n||""}parsePlatform(){this.parsedResult.platform={};const e=H.find(DB,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=H.find(LB,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return H.assign({},this.parsedResult)}satisfies(e){const n={};let r=0;const i={};let s=0;if(Object.keys(e).forEach(o=>{const a=e[o];typeof a=="string"?(i[o]=a,s+=1):typeof a=="object"&&(n[o]=a,r+=1)}),r>0){const o=Object.keys(n),a=H.find(o,u=>this.isOS(u));if(a){const u=this.satisfies(n[a]);if(u!==void 0)return u}const l=H.find(o,u=>this.isPlatform(u));if(l){const u=this.satisfies(n[l]);if(u!==void 0)return u}}if(s>0){const o=Object.keys(i),a=H.find(o,l=>this.isBrowser(l,!0));if(a!==void 0)return this.compareVersion(i[a])}}isBrowser(e,n=!1){const r=this.getBrowserName().toLowerCase();let i=e.toLowerCase();const s=H.getBrowserTypeByAlias(i);return n&&s&&(i=s.toLowerCase()),i===r}compareVersion(e){let n=[0],r=e,i=!1;const s=this.getBrowserVersion();if(typeof s=="string")return e[0]===">"||e[0]==="<"?(r=e.substr(1),e[1]==="="?(i=!0,r=e.substr(2)):n=[],e[0]===">"?n.push(1):n.push(-1)):e[0]==="="?r=e.substr(1):e[0]==="~"&&(i=!0,r=e.substr(1)),n.indexOf(H.compareVersions(s,r,i))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,n=!1){return this.isBrowser(e,n)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(n=>this.is(n))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class VB{static getParser(e,n=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new LI(e,n)}static parse(e){return new LI(e).getResult()}static get BROWSER_MAP(){return ax}static get ENGINE_MAP(){return Ci}static get OS_MAP(){return Qt}static get PLATFORMS_MAP(){return st}}function _p(){return Date.now()+Math.random().toString()}function Dl(){throw new Error("Method must be implemented in subclass")}function lx(t,e){return e!=null&&e.proxyUrl?e.proxyUrl+(e.proxyUrl.slice(-1)==="/"?"":"/")+t.substring(8):t}function sf(t){return t!=null&&t.callObjectBundleUrlOverride?t.callObjectBundleUrlOverride:lx("https://c.daily.co/call-machine/versioned/".concat("0.85.0","/static/call-machine-object-bundle.js"),t)}function of(t){try{new URL(t)}catch{return!1}return!0}const je=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Xs="8.55.0",Ae=globalThis;function af(t,e,n){const r=Ae,i=r.__SENTRY__=r.__SENTRY__||{},s=i[Xs]=i[Xs]||{};return s[t]||(s[t]=e())}const xo=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,zy=["debug","info","warn","error","log","assert","trace"],lf={};function Su(t){if(!("console"in Ae))return t();const e=Ae.console,n={},r=Object.keys(lf);r.forEach(i=>{const s=lf[i];n[i]=e[i],e[i]=s});try{return t()}finally{r.forEach(i=>{e[i]=n[i]})}}const ue=af("logger",function(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return xo?zy.forEach(n=>{e[n]=(...r)=>{t&&Su(()=>{Ae.console[n](`Sentry Logger [${n}]:`,...r)})}}):zy.forEach(n=>{e[n]=()=>{}}),e}),Ks="?",VI=/\(error: (.*)\)/,FI=/captureMessage|captureException/;function dd(t){return t[t.length-1]||{}}const jI="<anonymous>";function ds(t){try{return t&&typeof t=="function"&&t.name||jI}catch{return jI}}function UI(t){const e=t.exception;if(e){const n=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)}),n}catch{return}}}const Kd={},$I={};function Zs(t,e){Kd[t]=Kd[t]||[],Kd[t].push(e)}function eo(t,e){if(!$I[t]){$I[t]=!0;try{e()}catch(n){xo&&ue.error(`Error while instrumenting ${t}`,n)}}}function ar(t,e){const n=t&&Kd[t];if(n)for(const r of n)try{r(e)}catch(i){xo&&ue.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${ds(r)}
Error:`,i)}}let Lm=null;function FB(){Lm=Ae.onerror,Ae.onerror=function(t,e,n,r,i){return ar("error",{column:r,error:i,line:n,msg:t,url:e}),!!Lm&&Lm.apply(this,arguments)},Ae.onerror.__SENTRY_INSTRUMENTED__=!0}let Vm=null;function jB(){Vm=Ae.onunhandledrejection,Ae.onunhandledrejection=function(t){return ar("unhandledrejection",t),!Vm||Vm.apply(this,arguments)},Ae.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function vp(){return Vw(Ae),Ae}function Vw(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||Xs,e[Xs]=e[Xs]||{}}const cx=Object.prototype.toString;function Fw(t){switch(cx.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return go(t,Error)}}function al(t,e){return cx.call(t)===`[object ${e}]`}function ux(t){return al(t,"ErrorEvent")}function BI(t){return al(t,"DOMError")}function Kr(t){return al(t,"String")}function jw(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function Wy(t){return t===null||jw(t)||typeof t!="object"&&typeof t!="function"}function ja(t){return al(t,"Object")}function wp(t){return typeof Event<"u"&&go(t,Event)}function Ep(t){return!!(t&&t.then&&typeof t.then=="function")}function go(t,e){try{return t instanceof e}catch{return!1}}function dx(t){return!(typeof t!="object"||t===null||!t.__isVue&&!t._isVue)}const Uw=Ae;function hx(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,i=[];let s=0,o=0;const a=" > ",l=a.length;let u;const d=Array.isArray(e)?e:e.keyAttrs,f=!Array.isArray(e)&&e.maxStringLength||80;for(;n&&s++<r&&(u=UB(n,d),!(u==="html"||s>1&&o+i.length*l+u.length>=f));)i.push(u),o+=u.length,n=n.parentNode;return i.reverse().join(a)}catch{return"<unknown>"}}function UB(t,e){const n=t,r=[];if(!n||!n.tagName)return"";if(Uw.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const i=e&&e.length?e.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(i&&i.length)i.forEach(o=>{r.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&Kr(o)){const a=o.split(/\s+/);for(const l of a)r.push(`.${l}`)}}const s=["aria-label","type","name","title","alt"];for(const o of s){const a=n.getAttribute(o);a&&r.push(`[${o}="${a}"]`)}return r.join("")}function va(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function zI(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const i=t[r];try{dx(i)?n.push("[VueViewModel]"):n.push(String(i))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function $B(t,e,n=!1){return!!Kr(t)&&(al(e,"RegExp")?e.test(t):!!Kr(e)&&(n?t===e:t.includes(e)))}function hd(t,e=[],n=!1){return e.some(r=>$B(t,r,n))}function In(t,e,n){if(!(e in t))return;const r=t[e],i=n(r);typeof i=="function"&&fx(i,r);try{t[e]=i}catch{xo&&ue.log(`Failed to replace method "${e}" in object`,t)}}function yo(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{xo&&ue.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function fx(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,yo(t,"__sentry_original__",e)}catch{}}function $w(t){return t.__sentry_original__}function px(t){if(Fw(t))return{message:t.message,name:t.name,stack:t.stack,...qI(t)};if(wp(t)){const e={type:t.type,target:WI(t.target),currentTarget:WI(t.currentTarget),...qI(t)};return typeof CustomEvent<"u"&&go(t,CustomEvent)&&(e.detail=t.detail),e}return t}function WI(t){try{return e=t,typeof Element<"u"&&go(e,Element)?hx(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}var e}function qI(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}return{}}function Un(t){return qy(t,new Map)}function qy(t,e){if(function(n){if(!ja(n))return!1;try{const r=Object.getPrototypeOf(n).constructor.name;return!r||r==="Object"}catch{return!0}}(t)){const n=e.get(t);if(n!==void 0)return n;const r={};e.set(t,r);for(const i of Object.getOwnPropertyNames(t))t[i]!==void 0&&(r[i]=qy(t[i],e));return r}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const r=[];return e.set(t,r),t.forEach(i=>{r.push(qy(i,e))}),r}return t}function Tu(){return Date.now()/1e3}const Zr=function(){const{performance:t}=Ae;if(!t||!t.now)return Tu;const e=Date.now()-t.now(),n=t.timeOrigin==null?e:t.timeOrigin;return()=>(n+t.now())/1e3}();function Wn(){const t=Ae,e=t.crypto||t.msCrypto;let n=()=>16*Math.random();try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(15&n())>>r/4).toString(16))}function mx(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function Ai(t){const{message:e,event_id:n}=t;if(e)return e;const r=mx(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function Hy(t,e,n){const r=t.exception=t.exception||{},i=r.values=r.values||[],s=i[0]=i[0]||{};s.value||(s.value=e||""),s.type||(s.type="Error")}function Ua(t,e){const n=mx(t);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...e},e&&"data"in e){const i={...r&&r.data,...e.data};n.mechanism.data=i}}function HI(t){if(function(e){try{return e.__sentry_captured__}catch{}}(t))return!0;try{yo(t,"__sentry_captured__",!0)}catch{}return!1}var jr;function _o(t){return new Dn(e=>{e(t)})}function cf(t){return new Dn((e,n)=>{n(t)})}(()=>{const{performance:t}=Ae;!t||!t.now||(t.now(),t.timing&&t.timing.navigationStart)})(),function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"}(jr||(jr={}));class Dn{constructor(e){Dn.prototype.__init.call(this),Dn.prototype.__init2.call(this),Dn.prototype.__init3.call(this),Dn.prototype.__init4.call(this),this._state=jr.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new Dn((r,i)=>{this._handlers.push([!1,s=>{if(e)try{r(e(s))}catch(o){i(o)}else r(s)},s=>{if(n)try{r(n(s))}catch(o){i(o)}else i(s)}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Dn((n,r)=>{let i,s;return this.then(o=>{s=!1,i=o,e&&e()},o=>{s=!0,i=o,e&&e()}).then(()=>{s?r(i):n(i)})})}__init(){this._resolve=e=>{this._setResult(jr.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(jr.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{this._state===jr.PENDING&&(Ep(n)?n.then(this._resolve,this._reject):(this._state=e,this._value=n,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===jr.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===jr.RESOLVED&&n[1](this._value),this._state===jr.REJECTED&&n[2](this._value),n[0]=!0)})}}}function BB(t){const e=Zr(),n={sid:Wn(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(r){return Un({sid:`${r.sid}`,init:r.init,started:new Date(1e3*r.started).toISOString(),timestamp:new Date(1e3*r.timestamp).toISOString(),status:r.status,errors:r.errors,did:typeof r.did=="number"||typeof r.did=="string"?`${r.did}`:void 0,duration:r.duration,abnormal_mechanism:r.abnormal_mechanism,attrs:{release:r.release,environment:r.environment,ip_address:r.ipAddress,user_agent:r.userAgent}})}(n)};return t&&$a(n,t),n}function $a(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),t.did||e.did||(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Zr(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Wn()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function GI(){return Wn()}function Gy(){return Wn().substring(16)}function Sp(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&e&&Object.keys(e).length===0)return t;const r={...t};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=Sp(r[i],e[i],n-1));return r}const Ky="_sentrySpan";function KI(t,e){e?yo(t,Ky,e):delete t[Ky]}function QI(t){return t[Ky]}class Bw{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:GI(),spanId:Gy()}}clone(){const e=new Bw;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,KI(e,QI(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&$a(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,[r,i]=n instanceof hs?[n.getScopeData(),n.getRequestSession()]:ja(n)?[e,e.requestSession]:[],{tags:s,extra:o,user:a,contexts:l,level:u,fingerprint:d=[],propagationContext:f}=r||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...o},this._contexts={...this._contexts,...l},a&&Object.keys(a).length&&(this._user=a),u&&(this._level=u),d.length&&(this._fingerprint=d),f&&(this._propagationContext=f),i&&(this._requestSession=i),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,KI(this,void 0),this._attachments=[],this.setPropagationContext({traceId:GI()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:100;if(r<=0)return this;const i={timestamp:Tu(),...e};return this._breadcrumbs.push(i),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),this._client&&this._client.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:QI(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Sp(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:Gy(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=n&&n.event_id?n.event_id:Wn();if(!this._client)return ue.warn("No client configured on scope - will not capture exception!"),r;const i=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:i,...n,event_id:r},this),r}captureMessage(e,n,r){const i=r&&r.event_id?r.event_id:Wn();if(!this._client)return ue.warn("No client configured on scope - will not capture message!"),i;const s=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:s,...r,event_id:i},this),i}captureEvent(e,n){const r=n&&n.event_id?n.event_id:Wn();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(ue.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}const hs=Bw;class zB{constructor(e,n){let r,i;r=e||new hs,i=n||new hs,this._stack=[{scope:r}],this._isolationScope=i}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(i){throw this._popScope(),i}return Ep(r)?r.then(i=>(this._popScope(),i),i=>{throw this._popScope(),i}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function Ba(){const t=Vw(vp());return t.stack=t.stack||new zB(af("defaultCurrentScope",()=>new hs),af("defaultIsolationScope",()=>new hs))}function WB(t){return Ba().withScope(t)}function qB(t,e){const n=Ba();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function JI(t){return Ba().withScope(()=>t(Ba().getIsolationScope()))}function zw(t){const e=Vw(t);return e.acs?e.acs:{withIsolationScope:JI,withScope:WB,withSetScope:qB,withSetIsolationScope:(n,r)=>JI(r),getCurrentScope:()=>Ba().getScope(),getIsolationScope:()=>Ba().getIsolationScope()}}function Mo(){return zw(vp()).getCurrentScope()}function Iu(){return zw(vp()).getIsolationScope()}function zt(){return Mo().getClient()}function HB(t){const e=t.getPropagationContext(),{traceId:n,spanId:r,parentSpanId:i}=e;return Un({trace_id:n,span_id:r,parent_span_id:i})}function GB(t){const e=t._sentryMetrics;if(!e)return;const n={};for(const[,[r,i]]of e)(n[r]||(n[r]=[])).push(Un(i));return n}const KB=/^sentry-/;function QB(t){const e=function(r){if(!(!r||!Kr(r)&&!Array.isArray(r)))return Array.isArray(r)?r.reduce((i,s)=>{const o=YI(s);return Object.entries(o).forEach(([a,l])=>{i[a]=l}),i},{}):YI(r)}(t);if(!e)return;const n=Object.entries(e).reduce((r,[i,s])=>(i.match(KB)&&(r[i.slice(7)]=s),r),{});return Object.keys(n).length>0?n:void 0}function YI(t){return t.split(",").map(e=>e.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}let XI=!1;function JB(t){const{spanId:e,traceId:n,isRemote:r}=t.spanContext();return Un({parent_span_id:r?e:Ww(t).parent_span_id,span_id:r?Gy():e,trace_id:n})}function ZI(t){return typeof t=="number"?eC(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?eC(t.getTime()):Zr()}function eC(t){return t>9999999999?t/1e3:t}function Ww(t){if(function(e){return typeof e.getSpanJSON=="function"}(t))return t.getSpanJSON();try{const{spanId:e,traceId:n}=t.spanContext();if(function(r){const i=r;return!!(i.attributes&&i.startTime&&i.name&&i.endTime&&i.status)}(t)){const{attributes:r,startTime:i,name:s,endTime:o,parentSpanId:a,status:l}=t;return Un({span_id:e,trace_id:n,data:r,description:s,parent_span_id:a,start_timestamp:ZI(i),timestamp:ZI(o)||void 0,status:YB(l),op:r["sentry.op"],origin:r["sentry.origin"],_metrics_summary:GB(t)})}return{span_id:e,trace_id:n}}catch{return{}}}function YB(t){if(t&&t.code!==0)return t.code===1?"ok":t.message||"unknown_error"}function gx(t){return t._sentryRootSpan||t}function XB(){XI||(Su(()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")}),XI=!0)}const qw="production";function yx(t,e){const n=e.getOptions(),{publicKey:r}=e.getDsn()||{},i=Un({environment:n.environment||qw,release:n.release,public_key:r,trace_id:t});return e.emit("createDsc",i),i}function ZB(t){const e=zt();if(!e)return{};const n=gx(t),r=n._frozenDsc;if(r)return r;const i=n.spanContext().traceState,s=i&&i.get("sentry.dsc"),o=s&&QB(s);if(o)return o;const a=yx(t.spanContext().traceId,e),l=Ww(n),u=l.data||{},d=u["sentry.sample_rate"];d!=null&&(a.sample_rate=`${d}`);const f=u["sentry.source"],m=l.description;return f!=="url"&&m&&(a.transaction=m),function(w){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const E=zt(),v=E&&E.getOptions();return!!v&&(v.enableTracing||"tracesSampleRate"in v||"tracesSampler"in v)}()&&(a.sampled=String(function(w){const{traceFlags:E}=w.spanContext();return E===1}(n))),e.emit("createDsc",a,n),a}const ez=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function uf(t,e=!1){const{host:n,path:r,pass:i,port:s,projectId:o,protocol:a,publicKey:l}=t;return`${a}://${l}${e&&i?`:${i}`:""}@${n}${s?`:${s}`:""}/${r&&`${r}/`}${o}`}function tC(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function tz(t){const e=typeof t=="string"?function(n){const r=ez.exec(n);if(!r)return void Su(()=>{console.error(`Invalid Sentry Dsn: ${n}`)});const[i,s,o="",a="",l="",u=""]=r.slice(1);let d="",f=u;const m=f.split("/");if(m.length>1&&(d=m.slice(0,-1).join("/"),f=m.pop()),f){const w=f.match(/^\d+/);w&&(f=w[0])}return tC({host:a,pass:o,path:d,projectId:f,port:l,protocol:i,publicKey:s})}(t):tC(t);if(e&&function(n){if(!xo)return!0;const{port:r,projectId:i,protocol:s}=n;return!(["protocol","publicKey","host","projectId"].find(o=>!n[o]&&(ue.error(`Invalid Sentry Dsn: ${o} missing`),!0))||(i.match(/^\d+$/)?function(o){return o==="http"||o==="https"}(s)?r&&isNaN(parseInt(r,10))&&(ue.error(`Invalid Sentry Dsn: Invalid port ${r}`),1):(ue.error(`Invalid Sentry Dsn: Invalid protocol ${s}`),1):(ue.error(`Invalid Sentry Dsn: Invalid projectId ${i}`),1)))}(e))return e}function Ur(t,e=100,n=1/0){try{return Qy("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function _x(t,e=3,n=102400){const r=Ur(t,e);return i=r,function(s){return~-encodeURI(s).split(/%..|./).length}(JSON.stringify(i))>n?_x(t,e-1,n):r;var i}function Qy(t,e,n=1/0,r=1/0,i=function(){const s=typeof WeakSet=="function",o=s?new WeakSet:[];return[function(a){if(s)return!!o.has(a)||(o.add(a),!1);for(let l=0;l<o.length;l++)if(o[l]===a)return!0;return o.push(a),!1},function(a){if(s)o.delete(a);else for(let l=0;l<o.length;l++)if(o[l]===a){o.splice(l,1);break}}]}()){const[s,o]=i;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const a=function(w,E){try{if(w==="domain"&&E&&typeof E=="object"&&E._events)return"[Domain]";if(w==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&E===global)return"[Global]";if(typeof window<"u"&&E===window)return"[Window]";if(typeof document<"u"&&E===document)return"[Document]";if(dx(E))return"[VueViewModel]";if(ja(v=E)&&"nativeEvent"in v&&"preventDefault"in v&&"stopPropagation"in v)return"[SyntheticEvent]";if(typeof E=="number"&&!Number.isFinite(E))return`[${E}]`;if(typeof E=="function")return`[Function: ${ds(E)}]`;if(typeof E=="symbol")return`[${String(E)}]`;if(typeof E=="bigint")return`[BigInt: ${String(E)}]`;const b=function(S){const T=Object.getPrototypeOf(S);return T?T.constructor.name:"null prototype"}(E);return/^HTML(\w*)Element$/.test(b)?`[HTMLElement: ${b}]`:`[object ${b}]`}catch(b){return`**non-serializable** (${b})`}var v}(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const l=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(l===0)return a.replace("object ","");if(s(e))return"[Circular ~]";const u=e;if(u&&typeof u.toJSON=="function")try{return Qy("",u.toJSON(),l-1,r,i)}catch{}const d=Array.isArray(e)?[]:{};let f=0;const m=px(e);for(const w in m){if(!Object.prototype.hasOwnProperty.call(m,w))continue;if(f>=r){d[w]="[MaxProperties ~]";break}const E=m[w];d[w]=Qy(w,E,l-1,r,i),f++}return o(e),d}function tu(t,e=[]){return[t,e]}function nz(t,e){const[n,r]=t;return[n,[...r,e]]}function nC(t,e){const n=t[1];for(const r of n)if(e(r,r[0].type))return!0;return!1}function Jy(t){return Ae.__SENTRY__&&Ae.__SENTRY__.encodePolyfill?Ae.__SENTRY__.encodePolyfill(t):new TextEncoder().encode(t)}function rz(t){const[e,n]=t;let r=JSON.stringify(e);function i(s){typeof r=="string"?r=typeof s=="string"?r+s:[Jy(r),s]:r.push(typeof s=="string"?Jy(s):s)}for(const s of n){const[o,a]=s;if(i(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)i(a);else{let l;try{l=JSON.stringify(a)}catch{l=JSON.stringify(Ur(a))}i(l)}}return typeof r=="string"?r:function(s){const o=s.reduce((u,d)=>u+d.length,0),a=new Uint8Array(o);let l=0;for(const u of s)a.set(u,l),l+=u.length;return a}(r)}function iz(t){const e=typeof t.data=="string"?Jy(t.data):t.data;return[Un({type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),e]}const sz={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function rC(t){return sz[t]}function vx(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function oz(t,e,n,r){const i=vx(n),s=t.type&&t.type!=="replay_event"?t.type:"event";(function(a,l){l&&(a.sdk=a.sdk||{},a.sdk.name=a.sdk.name||l.name,a.sdk.version=a.sdk.version||l.version,a.sdk.integrations=[...a.sdk.integrations||[],...l.integrations||[]],a.sdk.packages=[...a.sdk.packages||[],...l.packages||[]])})(t,n&&n.sdk);const o=function(a,l,u,d){const f=a.sdkProcessingMetadata&&a.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:a.event_id,sent_at:new Date().toISOString(),...l&&{sdk:l},...!!u&&d&&{dsn:uf(d)},...f&&{trace:Un({...f})}}}(t,i,r,e);return delete t.sdkProcessingMetadata,tu(o,[[{type:s},t]])}function Yy(t,e,n,r=0){return new Dn((i,s)=>{const o=t[r];if(e===null||typeof o!="function")i(e);else{const a=o({...e},n);je&&o.id&&a===null&&ue.log(`Event processor "${o.id}" dropped event`),Ep(a)?a.then(l=>Yy(t,l,n,r+1).then(i)).then(null,s):Yy(t,a,n,r+1).then(i).then(null,s)}})}let fd,iC,Fm;function az(t,e){const{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:s}=e;(function(o,a){const{extra:l,tags:u,user:d,contexts:f,level:m,transactionName:w}=a,E=Un(l);E&&Object.keys(E).length&&(o.extra={...E,...o.extra});const v=Un(u);v&&Object.keys(v).length&&(o.tags={...v,...o.tags});const b=Un(d);b&&Object.keys(b).length&&(o.user={...b,...o.user});const S=Un(f);S&&Object.keys(S).length&&(o.contexts={...S,...o.contexts}),m&&(o.level=m),w&&o.type!=="transaction"&&(o.transaction=w)})(t,e),r&&function(o,a){o.contexts={trace:JB(a),...o.contexts},o.sdkProcessingMetadata={dynamicSamplingContext:ZB(a),...o.sdkProcessingMetadata};const l=gx(a),u=Ww(l).description;u&&!o.transaction&&o.type==="transaction"&&(o.transaction=u)}(t,r),function(o,a){o.fingerprint=o.fingerprint?Array.isArray(o.fingerprint)?o.fingerprint:[o.fingerprint]:[],a&&(o.fingerprint=o.fingerprint.concat(a)),o.fingerprint&&!o.fingerprint.length&&delete o.fingerprint}(t,n),function(o,a){const l=[...o.breadcrumbs||[],...a];o.breadcrumbs=l.length?l:void 0}(t,i),function(o,a){o.sdkProcessingMetadata={...o.sdkProcessingMetadata,...a}}(t,s)}function sC(t,e){const{extra:n,tags:r,user:i,contexts:s,level:o,sdkProcessingMetadata:a,breadcrumbs:l,fingerprint:u,eventProcessors:d,attachments:f,propagationContext:m,transactionName:w,span:E}=e;pd(t,"extra",n),pd(t,"tags",r),pd(t,"user",i),pd(t,"contexts",s),t.sdkProcessingMetadata=Sp(t.sdkProcessingMetadata,a,2),o&&(t.level=o),w&&(t.transactionName=w),E&&(t.span=E),l.length&&(t.breadcrumbs=[...t.breadcrumbs,...l]),u.length&&(t.fingerprint=[...t.fingerprint,...u]),d.length&&(t.eventProcessors=[...t.eventProcessors,...d]),f.length&&(t.attachments=[...t.attachments,...f]),t.propagationContext={...t.propagationContext,...m}}function pd(t,e,n){t[e]=Sp(t[e],n,1)}function lz(t,e,n,r,i,s){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,l={...e,event_id:e.event_id||n.event_id||Wn(),timestamp:e.timestamp||Tu()},u=n.integrations||t.integrations.map(E=>E.name);(function(E,v){const{environment:b,release:S,dist:T,maxValueLength:k=250}=v;E.environment=E.environment||b||qw,!E.release&&S&&(E.release=S),!E.dist&&T&&(E.dist=T),E.message&&(E.message=va(E.message,k));const L=E.exception&&E.exception.values&&E.exception.values[0];L&&L.value&&(L.value=va(L.value,k));const U=E.request;U&&U.url&&(U.url=va(U.url,k))})(l,t),function(E,v){v.length>0&&(E.sdk=E.sdk||{},E.sdk.integrations=[...E.sdk.integrations||[],...v])}(l,u),i&&i.emit("applyFrameMetadata",e),e.type===void 0&&function(E,v){const b=function(S){const T=Ae._sentryDebugIds;if(!T)return{};const k=Object.keys(T);return Fm&&k.length===iC||(iC=k.length,Fm=k.reduce((L,U)=>{fd||(fd={});const z=fd[U];if(z)L[z[0]]=z[1];else{const A=S(U);for(let C=A.length-1;C>=0;C--){const R=A[C],x=R&&R.filename,O=T[U];if(x&&O){L[x]=O,fd[U]=[x,O];break}}}return L},{})),Fm}(v);try{E.exception.values.forEach(S=>{S.stacktrace.frames.forEach(T=>{b&&T.filename&&(T.debug_id=b[T.filename])})})}catch{}}(l,t.stackParser);const d=function(E,v){if(!v)return E;const b=E?E.clone():new hs;return b.update(v),b}(r,n.captureContext);n.mechanism&&Ua(l,n.mechanism);const f=i?i.getEventProcessors():[],m=af("globalScope",()=>new hs).getScopeData();s&&sC(m,s.getScopeData()),d&&sC(m,d.getScopeData());const w=[...n.attachments||[],...m.attachments];return w.length&&(n.attachments=w),az(l,m),Yy([...f,...m.eventProcessors],l,n).then(E=>(E&&function(v){const b={};try{v.exception.values.forEach(T=>{T.stacktrace.frames.forEach(k=>{k.debug_id&&(k.abs_path?b[k.abs_path]=k.debug_id:k.filename&&(b[k.filename]=k.debug_id),delete k.debug_id)})})}catch{}if(Object.keys(b).length===0)return;v.debug_meta=v.debug_meta||{},v.debug_meta.images=v.debug_meta.images||[];const S=v.debug_meta.images;Object.entries(b).forEach(([T,k])=>{S.push({type:"sourcemap",code_file:T,debug_id:k})})}(E),typeof o=="number"&&o>0?function(v,b,S){if(!v)return null;const T={...v,...v.breadcrumbs&&{breadcrumbs:v.breadcrumbs.map(k=>({...k,...k.data&&{data:Ur(k.data,b,S)}}))},...v.user&&{user:Ur(v.user,b,S)},...v.contexts&&{contexts:Ur(v.contexts,b,S)},...v.extra&&{extra:Ur(v.extra,b,S)}};return v.contexts&&v.contexts.trace&&T.contexts&&(T.contexts.trace=v.contexts.trace,v.contexts.trace.data&&(T.contexts.trace.data=Ur(v.contexts.trace.data,b,S))),v.spans&&(T.spans=v.spans.map(k=>({...k,...k.data&&{data:Ur(k.data,b,S)}}))),v.contexts&&v.contexts.flags&&T.contexts&&(T.contexts.flags=Ur(v.contexts.flags,3,S)),T}(E,o,a):E))}function oC(t,e){return Mo().captureEvent(t,e)}function aC(t){const e=zt(),n=Iu(),r=Mo(),{release:i,environment:s=qw}=e&&e.getOptions()||{},{userAgent:o}=Ae.navigator||{},a=BB({release:i,environment:s,user:r.getUser()||n.getUser(),...o&&{userAgent:o},...t}),l=n.getSession();return l&&l.status==="ok"&&$a(l,{status:"exited"}),wx(),n.setSession(a),r.setSession(a),a}function wx(){const t=Iu(),e=Mo(),n=e.getSession()||t.getSession();n&&function(r,i){let s={};r.status==="ok"&&(s={status:"exited"}),$a(r,s)}(n),Ex(),t.setSession(),e.setSession()}function Ex(){const t=Iu(),e=Mo(),n=zt(),r=e.getSession()||t.getSession();r&&n&&n.captureSession(r)}function lC(t=!1){t?wx():Ex()}function cz(t,e,n){return e||`${function(r){return`${function(i){const s=i.protocol?`${i.protocol}:`:"",o=i.port?`:${i.port}`:"";return`${s}//${i.host}${o}${i.path?`/${i.path}`:""}/api/`}(r)}${r.projectId}/envelope/`}(t)}?${function(r,i){const s={sentry_version:"7"};return r.publicKey&&(s.sentry_key=r.publicKey),i&&(s.sentry_client=`${i.name}/${i.version}`),new URLSearchParams(s).toString()}(t,n)}`}const cC=[];function uC(t,e){for(const n of e)n&&n.afterAllSetup&&n.afterAllSetup(t)}function dC(t,e,n){if(n[e.name])je&&ue.log(`Integration skipped because it was already installed: ${e.name}`);else{if(n[e.name]=e,cC.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),cC.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(i,s)=>r(i,s,t))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),i=Object.assign((s,o)=>r(s,o,t),{id:e.name});t.addEventProcessor(i)}je&&ue.log(`Integration installed: ${e.name}`)}}class Yn extends Error{constructor(e,n="warn"){super(e),this.message=e,this.logLevel=n}}const hC="Not capturing exception because it's already been captured.";class uz{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=tz(e.dsn):je&&ue.warn("No DSN provided, client will not send events."),this._dsn){const r=cz(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:r})}const n=["enableTracing","tracesSampleRate","tracesSampler"].find(r=>r in e&&e[r]==null);n&&Su(()=>{console.warn(`[Sentry] Deprecation warning: \`${n}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)})}captureException(e,n,r){const i=Wn();if(HI(e))return je&&ue.log(hC),i;const s={event_id:i,...n};return this._process(this.eventFromException(e,s).then(o=>this._captureEvent(o,s,r))),s.event_id}captureMessage(e,n,r,i){const s={event_id:Wn(),...r},o=jw(e)?e:String(e),a=Wy(e)?this.eventFromMessage(o,n,s):this.eventFromException(e,s);return this._process(a.then(l=>this._captureEvent(l,s,i))),s.event_id}captureEvent(e,n,r){const i=Wn();if(n&&n.originalException&&HI(n.originalException))return je&&ue.log(hC),i;const s={event_id:i,...n},o=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,s,o||r)),s.event_id}captureSession(e){typeof e.release!="string"?je&&ue.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),$a(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(e).then(r=>n.flush(e).then(i=>r&&i))):_o(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const n=this._integrations[e.name];dC(this,e,this._integrations),n||uC(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=oz(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=nz(r,iz(s));const i=this.sendEnvelope(r);i&&i.then(s=>this.emit("afterSendEvent",e,s),null)}sendSession(e){const n=function(r,i,s,o){const a=vx(s);return tu({sent_at:new Date().toISOString(),...a&&{sdk:a},...!!o&&i&&{dsn:uf(i)}},["aggregates"in r?[{type:"sessions"},r]:[{type:"session"},r.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(n)}recordDroppedEvent(e,n,r){if(this._options.sendClientReports){const i=typeof r=="number"?r:1,s=`${e}:${n}`;je&&ue.log(`Recording outcome: "${s}"${i>1?` (${i} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+i}}on(e,n){const r=this._hooks[e]=this._hooks[e]||[];return r.push(n),()=>{const i=r.indexOf(n);i>-1&&r.splice(i,1)}}emit(e,...n){const r=this._hooks[e];r&&r.forEach(i=>i(...n))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,n=>(je&&ue.error("Error while sending envelope:",n),n)):(je&&ue.error("Transport disabled"),_o({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(n,r){const i={};return r.forEach(s=>{s&&dC(n,s,i)}),i}(this,e),uC(this,e)}_updateSessionFromEvent(e,n){let r=n.level==="fatal",i=!1;const s=n.exception&&n.exception.values;if(s){i=!0;for(const a of s){const l=a.mechanism;if(l&&l.handled===!1){r=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&($a(e,{...r&&{status:"crashed"},errors:e.errors||Number(i||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Dn(n=>{let r=0;const i=setInterval(()=>{this._numProcessing==0?(clearInterval(i),n(!0)):(r+=1,e&&r>=e&&(clearInterval(i),n(!1)))},1)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r=Mo(),i=Iu()){const s=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&o.length>0&&(n.integrations=o),this.emit("preprocessEvent",e,n),e.type||i.setLastEventId(e.event_id||n.event_id),lz(s,e,n,r,this,i).then(a=>{if(a===null)return a;a.contexts={trace:HB(r),...a.contexts};const l=function(u,d){const f=d.getPropagationContext();return f.dsc||yx(f.traceId,u)}(this,r);return a.sdkProcessingMetadata={dynamicSamplingContext:l,...a.sdkProcessingMetadata},a})}_captureEvent(e,n={},r){return this._processEvent(e,n,r).then(i=>i.event_id,i=>{je&&(i instanceof Yn&&i.logLevel==="log"?ue.log(i.message):ue.warn(i))})}_processEvent(e,n,r){const i=this.getOptions(),{sampleRate:s}=i,o=pC(e),a=fC(e),l=e.type||"error",u=`before send for type \`${l}\``,d=s===void 0?void 0:function(w){if(typeof w=="boolean")return Number(w);const E=typeof w=="string"?parseFloat(w):w;if(!(typeof E!="number"||isNaN(E)||E<0||E>1))return E;je&&ue.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(w)} of type ${JSON.stringify(typeof w)}.`)}(s);if(a&&typeof d=="number"&&Math.random()>d)return this.recordDroppedEvent("sample_rate","error",e),cf(new Yn(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const f=l==="replay_event"?"replay":l,m=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,n,r,m).then(w=>{if(w===null)throw this.recordDroppedEvent("event_processor",f,e),new Yn("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return w;const E=function(v,b,S,T){const{beforeSend:k,beforeSendTransaction:L,beforeSendSpan:U}=b;if(fC(S)&&k)return k(S,T);if(pC(S)){if(S.spans&&U){const z=[];for(const A of S.spans){const C=U(A);C?z.push(C):(XB(),v.recordDroppedEvent("before_send","span"))}S.spans=z}if(L){if(S.spans){const z=S.spans.length;S.sdkProcessingMetadata={...S.sdkProcessingMetadata,spanCountBeforeProcessing:z}}return L(S,T)}}return S}(this,i,w,n);return function(v,b){const S=`${b} must return \`null\` or a valid event.`;if(Ep(v))return v.then(T=>{if(!ja(T)&&T!==null)throw new Yn(S);return T},T=>{throw new Yn(`${b} rejected with ${T}`)});if(!ja(v)&&v!==null)throw new Yn(S);return v}(E,u)}).then(w=>{if(w===null){if(this.recordDroppedEvent("before_send",f,e),o){const b=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",b)}throw new Yn(`${u} returned \`null\`, will not send event.`,"log")}const E=r&&r.getSession();if(!o&&E&&this._updateSessionFromEvent(E,w),o){const b=(w.sdkProcessingMetadata&&w.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(w.spans?w.spans.length:0);b>0&&this.recordDroppedEvent("before_send","span",b)}const v=w.transaction_info;if(o&&v&&w.transaction!==e.transaction){const b="custom";w.transaction_info={...v,source:b}}return this.sendEvent(w,n),w}).then(null,w=>{throw w instanceof Yn?w:(this.captureException(w,{data:{__sentry__:!0},originalException:w}),new Yn(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${w}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([n,r])=>{const[i,s]=n.split(":");return{reason:i,category:s,quantity:r}})}_flushOutcomes(){je&&ue.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0)return void(je&&ue.log("No outcomes to send"));if(!this._dsn)return void(je&&ue.log("No dsn provided, will not send outcomes"));je&&ue.log("Sending outcomes:",e);const n=(r=e,tu((i=this._options.tunnel&&uf(this._dsn))?{dsn:i}:{},[[{type:"client_report"},{timestamp:s||Tu(),discarded_events:r}]]));var r,i,s;this.sendEnvelope(n)}}function fC(t){return t.type===void 0}function pC(t){return t.type==="transaction"}function dz(t){const e=[];function n(r){return e.splice(e.indexOf(r),1)[0]||Promise.resolve(void 0)}return{$:e,add:function(r){if(!(t===void 0||e.length<t))return cf(new Yn("Not adding Promise because buffer limit was reached."));const i=r();return e.indexOf(i)===-1&&e.push(i),i.then(()=>n(i)).then(null,()=>n(i).then(null,()=>{})),i},drain:function(r){return new Dn((i,s)=>{let o=e.length;if(!o)return i(!0);const a=setTimeout(()=>{r&&r>0&&i(!1)},r);e.forEach(l=>{_o(l).then(()=>{--o||(clearTimeout(a),i(!0))},s)})})}}}function hz(t,{statusCode:e,headers:n},r=Date.now()){const i={...t},s=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(s)for(const a of s.trim().split(",")){const[l,u,,,d]=a.split(":",5),f=parseInt(l,10),m=1e3*(isNaN(f)?60:f);if(u)for(const w of u.split(";"))w==="metric_bucket"&&d&&!d.split(";").includes("custom")||(i[w]=r+m);else i.all=r+m}else o?i.all=r+function(a,l=Date.now()){const u=parseInt(`${a}`,10);if(!isNaN(u))return 1e3*u;const d=Date.parse(`${a}`);return isNaN(d)?6e4:d-l}(o,r):e===429&&(i.all=r+6e4);return i}function fz(t,e,n=dz(t.bufferSize||64)){let r={};return{send:function(i){const s=[];if(nC(i,(l,u)=>{const d=rC(u);if(function(f,m,w=Date.now()){return function(E,v){return E[v]||E.all||0}(f,m)>w}(r,d)){const f=mC(l,u);t.recordDroppedEvent("ratelimit_backoff",d,f)}else s.push(l)}),s.length===0)return _o({});const o=tu(i[0],s),a=l=>{nC(o,(u,d)=>{const f=mC(u,d);t.recordDroppedEvent(l,rC(d),f)})};return n.add(()=>e({body:rz(o)}).then(l=>(l.statusCode!==void 0&&(l.statusCode<200||l.statusCode>=300)&&je&&ue.warn(`Sentry responded with status code ${l.statusCode} to sent event.`),r=hz(r,l),l),l=>{throw a("network_error"),l})).then(l=>l,l=>{if(l instanceof Yn)return je&&ue.error("Skipped sending event because buffer is full."),a("queue_overflow"),_o({});throw l})},flush:i=>n.drain(i)}}function mC(t,e){if(e==="event"||e==="transaction")return Array.isArray(t)?t[1]:void 0}const pz=100;function Ns(t,e){const n=zt(),r=Iu();if(!n)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:s=pz}=n.getOptions();if(s<=0)return;const o={timestamp:Tu(),...t},a=i?Su(()=>i(o,e)):o;a!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",a,e),r.addBreadcrumb(a,s))}let gC;const yC=new WeakMap,mz=()=>({name:"FunctionToString",setupOnce(){gC=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=$w(this),n=yC.has(zt())&&e!==void 0?e:this;return gC.apply(n,t)}}catch{}},setup(t){yC.set(t,!0)}}),gz=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],yz=(t={})=>({name:"InboundFilters",processEvent(e,n,r){const i=r.getOptions(),s=function(o={},a={}){return{allowUrls:[...o.allowUrls||[],...a.allowUrls||[]],denyUrls:[...o.denyUrls||[],...a.denyUrls||[]],ignoreErrors:[...o.ignoreErrors||[],...a.ignoreErrors||[],...o.disableErrorDefaults?[]:gz],ignoreTransactions:[...o.ignoreTransactions||[],...a.ignoreTransactions||[]],ignoreInternal:o.ignoreInternal===void 0||o.ignoreInternal}}(t,i);return function(o,a){return a.ignoreInternal&&function(l){try{return l.exception.values[0].type==="SentryError"}catch{}return!1}(o)?(je&&ue.warn(`Event dropped due to being internal Sentry Error.
Event: ${Ai(o)}`),!0):function(l,u){return l.type||!u||!u.length?!1:function(d){const f=[];d.message&&f.push(d.message);let m;try{m=d.exception.values[d.exception.values.length-1]}catch{}return m&&m.value&&(f.push(m.value),m.type&&f.push(`${m.type}: ${m.value}`)),f}(l).some(d=>hd(d,u))}(o,a.ignoreErrors)?(je&&ue.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Ai(o)}`),!0):function(l){return l.type||!l.exception||!l.exception.values||l.exception.values.length===0?!1:!l.message&&!l.exception.values.some(u=>u.stacktrace||u.type&&u.type!=="Error"||u.value)}(o)?(je&&ue.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Ai(o)}`),!0):function(l,u){if(l.type!=="transaction"||!u||!u.length)return!1;const d=l.transaction;return!!d&&hd(d,u)}(o,a.ignoreTransactions)?(je&&ue.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Ai(o)}`),!0):function(l,u){if(!u||!u.length)return!1;const d=md(l);return!!d&&hd(d,u)}(o,a.denyUrls)?(je&&ue.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Ai(o)}.
Url: ${md(o)}`),!0):function(l,u){if(!u||!u.length)return!0;const d=md(l);return!d||hd(d,u)}(o,a.allowUrls)?!1:(je&&ue.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Ai(o)}.
Url: ${md(o)}`),!0)}(e,s)?null:e}});function md(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?function(n=[]){for(let r=n.length-1;r>=0;r--){const i=n[r];if(i&&i.filename!=="<anonymous>"&&i.filename!=="[native code]")return i.filename||null}return null}(e):null}catch{return je&&ue.error(`Cannot extract url for event ${Ai(t)}`),null}}function _z(t,e,n=250,r,i,s,o){if(!(s.exception&&s.exception.values&&o&&go(o.originalException,Error)))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;var l,u;a&&(s.exception.values=(l=Xy(t,e,i,o.originalException,r,s.exception.values,a,0),u=n,l.map(d=>(d.value&&(d.value=va(d.value,u)),d))))}function Xy(t,e,n,r,i,s,o,a){if(s.length>=n+1)return s;let l=[...s];if(go(r[i],Error)){_C(o,a);const u=t(e,r[i]),d=l.length;vC(u,i,d,a),l=Xy(t,e,n,r[i],i,[u,...l],u,d)}return Array.isArray(r.errors)&&r.errors.forEach((u,d)=>{if(go(u,Error)){_C(o,a);const f=t(e,u),m=l.length;vC(f,`errors[${d}]`,m,a),l=Xy(t,e,n,u,i,[f,...l],f,m)}}),l}function _C(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,...t.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function vC(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function jm(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}function vz(){"console"in Ae&&zy.forEach(function(t){t in Ae.console&&In(Ae.console,t,function(e){return lf[t]=e,function(...n){ar("console",{args:n,level:t});const r=lf[t];r&&r.apply(Ae.console,n)}})})}function wz(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const Ez=()=>{let t;return{name:"Dedupe",processEvent(e){if(e.type)return e;try{if(function(n,r){return r?!!(function(i,s){const o=i.message,a=s.message;return!(!o&&!a||o&&!a||!o&&a||o!==a||!EC(i,s)||!wC(i,s))}(n,r)||function(i,s){const o=SC(s),a=SC(i);return!(!o||!a||o.type!==a.type||o.value!==a.value||!EC(i,s)||!wC(i,s))}(n,r)):!1}(e,t))return je&&ue.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}};function wC(t,e){let n=UI(t),r=UI(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||r.length!==n.length)return!1;for(let i=0;i<r.length;i++){const s=r[i],o=n[i];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function EC(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return n.join("")===r.join("")}catch{return!1}}function SC(t){return t.exception&&t.exception.values&&t.exception.values[0]}function TC(t){return t===void 0?void 0:t>=400&&t<500?"warning":t>=500?"error":void 0}const Um=Ae;function Zy(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function Sz(){if(typeof EdgeRuntime=="string")return!0;if(!function(){if(!("fetch"in Um))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}())return!1;if(Zy(Um.fetch))return!0;let t=!1;const e=Um.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=Zy(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){xo&&ue.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function Tz(t,e){const n="fetch";Zs(n,t),eo(n,()=>function(r,i=!1){i&&!Sz()||In(Ae,"fetch",function(s){return function(...o){const a=new Error,{method:l,url:u}=function(f){if(f.length===0)return{method:"GET",url:""};if(f.length===2){const[w,E]=f;return{url:IC(w),method:e_(E,"method")?String(E.method).toUpperCase():"GET"}}const m=f[0];return{url:IC(m),method:e_(m,"method")?String(m.method).toUpperCase():"GET"}}(o),d={args:o,fetchData:{method:l,url:u},startTimestamp:1e3*Zr(),virtualError:a};return r||ar("fetch",{...d}),s.apply(Ae,o).then(async f=>(r?r(f):ar("fetch",{...d,endTimestamp:1e3*Zr(),response:f}),f),f=>{throw ar("fetch",{...d,endTimestamp:1e3*Zr(),error:f}),Fw(f)&&f.stack===void 0&&(f.stack=a.stack,yo(f,"framesToPop",1)),f})}})}(void 0,e))}function e_(t,e){return!!t&&typeof t=="object"&&!!t[e]}function IC(t){return typeof t=="string"?t:t?e_(t,"url")?t.url:t.toString?t.toString():"":""}const gd=Ae,kt=Ae;let t_=0;function CC(){return t_>0}function za(t,e={}){if(!function(r){return typeof r=="function"}(t))return t;try{const r=t.__sentry_wrapped__;if(r)return typeof r=="function"?r:t;if($w(t))return t}catch{return t}const n=function(...r){try{const i=r.map(s=>za(s,e));return t.apply(this,i)}catch(i){throw t_++,setTimeout(()=>{t_--}),function(...s){const o=zw(vp());if(s.length===2){const[a,l]=s;return a?o.withSetScope(a,l):o.withScope(l)}o.withScope(s[0])}(s=>{var o;s.addEventProcessor(a=>(e.mechanism&&(Hy(a,void 0),Ua(a,e.mechanism)),a.extra={...a.extra,arguments:r},a)),o=i,Mo().captureException(o,void 0)}),i}};try{for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}catch{}fx(n,t),yo(t,"__sentry_wrapped__",n);try{Object.getOwnPropertyDescriptor(n,"name").configurable&&Object.defineProperty(n,"name",{get:()=>t.name})}catch{}return n}const Tp=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function Hw(t,e){const n=Gw(t,e),r={type:kz(e),value:bz(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function Iz(t,e,n,r){const i=zt(),s=i&&i.getOptions().normalizeDepth,o=function(u){for(const d in u)if(Object.prototype.hasOwnProperty.call(u,d)){const f=u[d];if(f instanceof Error)return f}}(e),a={__serialized__:_x(e,s)};if(o)return{exception:{values:[Hw(t,o)]},extra:a};const l={exception:{values:[{type:wp(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:Az(e,{isUnhandledRejection:r})}]},extra:a};if(n){const u=Gw(t,n);u.length&&(l.exception.values[0].stacktrace={frames:u})}return l}function $m(t,e){return{exception:{values:[Hw(t,e)]}}}function Gw(t,e){const n=e.stacktrace||e.stack||"",r=function(s){return s&&Cz.test(s.message)?1:0}(e),i=function(s){return typeof s.framesToPop=="number"?s.framesToPop:0}(e);try{return t(n,r,i)}catch{}return[]}const Cz=/Minified React error #\d+;/i;function Sx(t){return typeof WebAssembly<"u"&&WebAssembly.Exception!==void 0&&t instanceof WebAssembly.Exception}function kz(t){const e=t&&t.name;return!e&&Sx(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function bz(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:Sx(t)&&Array.isArray(t.message)&&t.message.length==2?t.message[1]:e:"No error message"}function n_(t,e,n,r,i){let s;if(ux(e)&&e.error)return $m(t,e.error);if(BI(e)||al(e,"DOMException")){const o=e;if("stack"in e)s=$m(t,e);else{const a=o.name||(BI(o)?"DOMError":"DOMException"),l=o.message?`${a}: ${o.message}`:a;s=r_(t,l,n,r),Hy(s,l)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}return Fw(e)?$m(t,e):ja(e)||wp(e)?(s=Iz(t,e,n,i),Ua(s,{synthetic:!0}),s):(s=r_(t,e,n,r),Hy(s,`${e}`),Ua(s,{synthetic:!0}),s)}function r_(t,e,n,r){const i={};if(r&&n){const s=Gw(t,n);s.length&&(i.exception={values:[{value:e,stacktrace:{frames:s}}]}),Ua(i,{synthetic:!0})}if(jw(e)){const{__sentry_template_string__:s,__sentry_template_values__:o}=e;return i.logentry={message:s,params:o},i}return i.message=e,i}function Az(t,{isUnhandledRejection:e}){const n=function(i,s=40){const o=Object.keys(px(i));o.sort();const a=o[0];if(!a)return"[object has no keys]";if(a.length>=s)return va(a,s);for(let l=o.length;l>0;l--){const u=o.slice(0,l).join(", ");if(!(u.length>s))return l===o.length?u:va(u,s)}return""}(t),r=e?"promise rejection":"exception";return ux(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:wp(t)?`Event \`${function(i){try{const s=Object.getPrototypeOf(i);return s?s.constructor.name:void 0}catch{}}(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}class Pz extends uz{constructor(e){const n={parentSpanIsAlwaysRootSpan:!0,...e};(function(r,i,s=[i],o="npm"){const a=r._metadata||{};a.sdk||(a.sdk={name:`sentry.javascript.${i}`,packages:s.map(l=>({name:`${o}:@sentry/${l}`,version:Xs})),version:Xs}),r._metadata=a})(n,"browser",["browser"],kt.SENTRY_SDK_SOURCE||"npm"),super(n),n.sendClientReports&&kt.document&&kt.document.addEventListener("visibilitychange",()=>{kt.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,n){return function(r,i,s,o){const a=n_(r,i,s&&s.syntheticException||void 0,o);return Ua(a),a.level="error",s&&s.event_id&&(a.event_id=s.event_id),_o(a)}(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return function(i,s,o="info",a,l){const u=r_(i,s,a&&a.syntheticException||void 0,l);return u.level=o,a&&a.event_id&&(u.event_id=a.event_id),_o(u)}(this._options.stackParser,e,n,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(Tp&&ue.warn("SDK not enabled, will not capture user feedback."));const n=function(r,{metadata:i,tunnel:s,dsn:o}){const a={event_id:r.event_id,sent_at:new Date().toISOString(),...i&&i.sdk&&{sdk:{name:i.sdk.name,version:i.sdk.version}},...!!s&&!!o&&{dsn:uf(o)}};return tu(a,[function(u){return[{type:"user_report"},u]}(r)])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(n)}_prepareEvent(e,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r)}}const Rz=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Zt=Ae;let kC,Bm,zm,yd;function Nz(){if(!Zt.document)return;const t=ar.bind(null,"dom"),e=bC(t,!0);Zt.document.addEventListener("click",e,!1),Zt.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{const r=Zt[n],i=r&&r.prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(In(i,"addEventListener",function(s){return function(o,a,l){if(o==="click"||o=="keypress")try{const u=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},d=u[o]=u[o]||{refCount:0};if(!d.handler){const f=bC(t);d.handler=f,s.call(this,o,f,l)}d.refCount++}catch{}return s.call(this,o,a,l)}}),In(i,"removeEventListener",function(s){return function(o,a,l){if(o==="click"||o=="keypress")try{const u=this.__sentry_instrumentation_handlers__||{},d=u[o];d&&(d.refCount--,d.refCount<=0&&(s.call(this,o,d.handler,l),d.handler=void 0,delete u[o]),Object.keys(u).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return s.call(this,o,a,l)}}))})}function bC(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=function(s){try{return s.target}catch{return null}}(n);if(function(s,o){return s==="keypress"&&(!o||!o.tagName||o.tagName!=="INPUT"&&o.tagName!=="TEXTAREA"&&!o.isContentEditable)}(n.type,r))return;yo(n,"_sentryCaptured",!0),r&&!r._sentryId&&yo(r,"_sentryId",Wn());const i=n.type==="keypress"?"input":n.type;(function(s){if(s.type!==Bm)return!1;try{if(!s.target||s.target._sentryId!==zm)return!1}catch{}return!0})(n)||(t({event:n,name:i,global:e}),Bm=n.type,zm=r?r._sentryId:void 0),clearTimeout(kC),kC=Zt.setTimeout(()=>{zm=void 0,Bm=void 0},1e3)}}function Tx(t){const e="history";Zs(e,t),eo(e,xz)}function xz(){if(!function(){const n=gd.chrome,r=n&&n.app&&n.app.runtime,i="history"in gd&&!!gd.history.pushState&&!!gd.history.replaceState;return!r&&i}())return;const t=Zt.onpopstate;function e(n){return function(...r){const i=r.length>2?r[2]:void 0;if(i){const s=yd,o=String(i);yd=o,ar("history",{from:s,to:o})}return n.apply(this,r)}}Zt.onpopstate=function(...n){const r=Zt.location.href,i=yd;if(yd=r,ar("history",{from:i,to:r}),t)try{return t.apply(this,n)}catch{}},In(Zt.history,"pushState",e),In(Zt.history,"replaceState",e)}const Qd={};function AC(t){Qd[t]=void 0}const Ql="__sentry_xhr_v3__";function Mz(){if(!Zt.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,n,r){const i=new Error,s=1e3*Zr(),o=Kr(r[0])?r[0].toUpperCase():void 0,a=function(u){if(Kr(u))return u;try{return u.toString()}catch{}}(r[1]);if(!o||!a)return e.apply(n,r);n[Ql]={method:o,url:a,request_headers:{}},o==="POST"&&a.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const l=()=>{const u=n[Ql];if(u&&n.readyState===4){try{u.status_code=n.status}catch{}ar("xhr",{endTimestamp:1e3*Zr(),startTimestamp:s,xhr:n,virtualError:i})}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply:(u,d,f)=>(l(),u.apply(d,f))}):n.addEventListener("readystatechange",l),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(u,d,f){const[m,w]=f,E=d[Ql];return E&&Kr(m)&&Kr(w)&&(E.request_headers[m.toLowerCase()]=w),u.apply(d,f)}}),e.apply(n,r)}}),t.send=new Proxy(t.send,{apply(e,n,r){const i=n[Ql];return i?(r[0]!==void 0&&(i.body=r[0]),ar("xhr",{startTimestamp:1e3*Zr(),xhr:n}),e.apply(n,r)):e.apply(n,r)}})}function Oz(t,e=function(n){const r=Qd[n];if(r)return r;let i=Zt[n];if(Zy(i))return Qd[n]=i.bind(Zt);const s=Zt.document;if(s&&typeof s.createElement=="function")try{const o=s.createElement("iframe");o.hidden=!0,s.head.appendChild(o);const a=o.contentWindow;a&&a[n]&&(i=a[n]),s.head.removeChild(o)}catch(o){Rz&&ue.warn(`Could not create sandbox iframe for ${n} check, bailing to window.${n}: `,o)}return i&&(Qd[n]=i.bind(Zt))}("fetch")){let n=0,r=0;return fz(t,function(i){const s=i.body.length;n+=s,r++;const o={body:i.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};if(!e)return AC("fetch"),cf("No fetch implementation available");try{return e(t.url,o).then(a=>(n-=s,r--,{statusCode:a.status,headers:{"x-sentry-rate-limits":a.headers.get("X-Sentry-Rate-Limits"),"retry-after":a.headers.get("Retry-After")}}))}catch(a){return AC("fetch"),n-=s,r--,cf(a)}})}function Wm(t,e,n,r){const i={filename:t,function:e==="<anonymous>"?Ks:e,in_app:!0};return n!==void 0&&(i.lineno=n),r!==void 0&&(i.colno=r),i}const Dz=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Lz=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Vz=/\((\S*)(?::(\d+))(?::(\d+))\)/,Fz=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,jz=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Uz=function(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0,i=0)=>{const s=[],o=n.split(`
`);for(let a=r;a<o.length;a++){const l=o[a];if(l.length>1024)continue;const u=VI.test(l)?l.replace(VI,"$1"):l;if(!u.match(/\S*Error: /)){for(const d of e){const f=d(u);if(f){s.push(f);break}}if(s.length>=50+i)break}}return function(a){if(!a.length)return[];const l=Array.from(a);return/sentryWrapped/.test(dd(l).function||"")&&l.pop(),l.reverse(),FI.test(dd(l).function||"")&&(l.pop(),FI.test(dd(l).function||"")&&l.pop()),l.slice(0,50).map(u=>({...u,filename:u.filename||dd(l).filename,function:u.function||Ks}))}(s.slice(i))}}([30,t=>{const e=Dz.exec(t);if(e){const[,r,i,s]=e;return Wm(r,Ks,+i,+s)}const n=Lz.exec(t);if(n){if(n[2]&&n[2].indexOf("eval")===0){const s=Vz.exec(n[2]);s&&(n[2]=s[1],n[3]=s[2],n[4]=s[3])}const[r,i]=PC(n[1]||Ks,n[2]);return Wm(i,r,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}}],[50,t=>{const e=Fz.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const i=jz.exec(e[3]);i&&(e[1]=e[1]||"eval",e[3]=i[1],e[4]=i[2],e[5]="")}let n=e[3],r=e[1]||Ks;return[r,n]=PC(r,n),Wm(n,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]),PC=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:Ks,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},RC=1024,$z=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:"Breadcrumbs",setup(n){var r;e.console&&function(i){const s="console";Zs(s,i),eo(s,vz)}(function(i){return function(s){if(zt()!==i)return;const o={category:"console",data:{arguments:s.args,logger:"console"},level:wz(s.level),message:zI(s.args," ")};if(s.level==="assert"){if(s.args[0]!==!1)return;o.message=`Assertion failed: ${zI(s.args.slice(1)," ")||"console.assert"}`,o.data.arguments=s.args.slice(1)}Ns(o,{input:s.args,level:s.level})}}(n)),e.dom&&(r=function(i,s){return function(o){if(zt()!==i)return;let a,l,u=typeof s=="object"?s.serializeAttribute:void 0,d=typeof s=="object"&&typeof s.maxStringLength=="number"?s.maxStringLength:void 0;d&&d>RC&&(Tp&&ue.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${d} was configured. Sentry will use 1024 instead.`),d=RC),typeof u=="string"&&(u=[u]);try{const m=o.event,w=function(E){return!!E&&!!E.target}(m)?m.target:m;a=hx(w,{keyAttrs:u,maxStringLength:d}),l=function(E){if(!Uw.HTMLElement)return null;let v=E;for(let b=0;b<5;b++){if(!v)return null;if(v instanceof HTMLElement){if(v.dataset.sentryComponent)return v.dataset.sentryComponent;if(v.dataset.sentryElement)return v.dataset.sentryElement}v=v.parentNode}return null}(w)}catch{a="<unknown>"}if(a.length===0)return;const f={category:`ui.${o.name}`,message:a};l&&(f.data={"ui.component_name":l}),Ns(f,{event:o.event,name:o.name,global:o.global})}}(n,e.dom),Zs("dom",r),eo("dom",Nz)),e.xhr&&function(i){Zs("xhr",i),eo("xhr",Mz)}(function(i){return function(s){if(zt()!==i)return;const{startTimestamp:o,endTimestamp:a}=s,l=s.xhr[Ql];if(!o||!a||!l)return;const{method:u,url:d,status_code:f,body:m}=l,w={method:u,url:d,status_code:f},E={xhr:s.xhr,input:m,startTimestamp:o,endTimestamp:a};Ns({category:"xhr",data:w,type:"http",level:TC(f)},E)}}(n)),e.fetch&&Tz(function(i){return function(s){if(zt()!==i)return;const{startTimestamp:o,endTimestamp:a}=s;if(a&&(!s.fetchData.url.match(/sentry_key/)||s.fetchData.method!=="POST"))if(s.error)Ns({category:"fetch",data:s.fetchData,level:"error",type:"http"},{data:s.error,input:s.args,startTimestamp:o,endTimestamp:a});else{const l=s.response,u={...s.fetchData,status_code:l&&l.status},d={input:s.args,response:l,startTimestamp:o,endTimestamp:a};Ns({category:"fetch",data:u,type:"http",level:TC(u.status_code)},d)}}}(n)),e.history&&Tx(function(i){return function(s){if(zt()!==i)return;let o=s.from,a=s.to;const l=jm(kt.location.href);let u=o?jm(o):void 0;const d=jm(a);u&&u.path||(u=l),l.protocol===d.protocol&&l.host===d.host&&(a=d.relative),l.protocol===u.protocol&&l.host===u.host&&(o=u.relative),Ns({category:"navigation",data:{from:o,to:a}})}}(n)),e.sentry&&n.on("beforeSendEvent",function(i){return function(s){zt()===i&&Ns({category:"sentry."+(s.type==="transaction"?"transaction":"event"),event_id:s.event_id,level:s.level,message:Ai(s)},{event:s})}}(n))}}},Bz=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],zz=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:"BrowserApiErrors",setupOnce(){e.setTimeout&&In(kt,"setTimeout",NC),e.setInterval&&In(kt,"setInterval",NC),e.requestAnimationFrame&&In(kt,"requestAnimationFrame",Wz),e.XMLHttpRequest&&"XMLHttpRequest"in kt&&In(XMLHttpRequest.prototype,"send",qz);const n=e.eventTarget;n&&(Array.isArray(n)?n:Bz).forEach(Hz)}}};function NC(t){return function(...e){const n=e[0];return e[0]=za(n,{mechanism:{data:{function:ds(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function Wz(t){return function(e){return t.apply(this,[za(e,{mechanism:{data:{function:"requestAnimationFrame",handler:ds(t)},handled:!1,type:"instrument"}})])}}function qz(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(r=>{r in n&&typeof n[r]=="function"&&In(n,r,function(i){const s={mechanism:{data:{function:r,handler:ds(i)},handled:!1,type:"instrument"}},o=$w(i);return o&&(s.mechanism.data.handler=ds(o)),za(i,s)})}),t.apply(this,e)}}function Hz(t){const e=kt[t],n=e&&e.prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(In(n,"addEventListener",function(r){return function(i,s,o){try{typeof s.handleEvent=="function"&&(s.handleEvent=za(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:ds(s),target:t},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[i,za(s,{mechanism:{data:{function:"addEventListener",handler:ds(s),target:t},handled:!1,type:"instrument"}}),o])}}),In(n,"removeEventListener",function(r){return function(i,s,o){try{const a=s.__sentry_wrapped__;a&&r.call(this,i,a,o)}catch{}return r.call(this,i,s,o)}}))}const Gz=()=>({name:"BrowserSession",setupOnce(){kt.document!==void 0?(aC({ignoreDuration:!0}),lC(),Tx(({from:t,to:e})=>{t!==void 0&&t!==e&&(aC({ignoreDuration:!0}),lC())})):Tp&&ue.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}}),Kz=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(function(r){(function(i){const s="error";Zs(s,i),eo(s,FB)})(i=>{const{stackParser:s,attachStacktrace:o}=MC();if(zt()!==r||CC())return;const{msg:a,url:l,line:u,column:d,error:f}=i,m=function(w,E,v,b){const S=w.exception=w.exception||{},T=S.values=S.values||[],k=T[0]=T[0]||{},L=k.stacktrace=k.stacktrace||{},U=L.frames=L.frames||[],z=b,A=v,C=Kr(E)&&E.length>0?E:function(){try{return Uw.document.location.href}catch{return""}}();return U.length===0&&U.push({colno:z,filename:C,function:Ks,in_app:!0,lineno:A}),w}(n_(s,f||a,void 0,o,!1),l,u,d);m.level="error",oC(m,{originalException:f,mechanism:{handled:!1,type:"onerror"}})})}(n),xC("onerror")),e.onunhandledrejection&&(function(r){(function(i){const s="unhandledrejection";Zs(s,i),eo(s,jB)})(i=>{const{stackParser:s,attachStacktrace:o}=MC();if(zt()!==r||CC())return;const a=function(u){if(Wy(u))return u;try{if("reason"in u)return u.reason;if("detail"in u&&"reason"in u.detail)return u.detail.reason}catch{}return u}(i),l=Wy(a)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(a)}`}]}}:n_(s,a,void 0,o,!0);l.level="error",oC(l,{originalException:a,mechanism:{handled:!1,type:"onunhandledrejection"}})})}(n),xC("onunhandledrejection"))}}};function xC(t){Tp&&ue.log(`Global Handler attached: ${t}`)}function MC(){const t=zt();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Qz=()=>({name:"HttpContext",preprocessEvent(t){if(!kt.navigator&&!kt.location&&!kt.document)return;const e=t.request&&t.request.url||kt.location&&kt.location.href,{referrer:n}=kt.document||{},{userAgent:r}=kt.navigator||{},i={...t.request&&t.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...t.request,...e&&{url:e},headers:i};t.request=s}}),Jz=(t={})=>{const e=t.limit||5,n=t.key||"cause";return{name:"LinkedErrors",preprocessEvent(r,i,s){const o=s.getOptions();_z(Hw,o.stackParser,o.maxValueLength,n,e,r,i)}}};var OC="new",DC="loading",LC="loaded",i_="joining-meeting",js="joined-meeting",xs="left-meeting",Ti="error",Yz="playable",qm="unknown",Xz="full",Zz="base",VC="no-room",e8="end-of-life",t8="connection-error",n8="iframe-ready-for-launch-config",r8="iframe-launch-config",i8="theme-updated",s8="loading",o8="load-attempt-failed",FC="loaded",a8="started-camera",l8="camera-error",c8="joining-meeting",u8="joined-meeting",d8="left-meeting",h8="participant-joined",f8="participant-updated",p8="participant-left",m8="participant-counts-updated",g8="access-state-updated",y8="meeting-session-summary-updated",_8="meeting-session-state-updated",v8="waiting-participant-added",w8="waiting-participant-updated",E8="waiting-participant-removed",S8="track-started",T8="track-stopped",I8="transcription-started",C8="transcription-stopped",k8="transcription-error",jC="recording-started",UC="recording-stopped",b8="recording-stats",A8="recording-error",P8="recording-upload-completed",R8="recording-data",N8="app-message",x8="transcription-message",M8="remote-media-player-started",O8="remote-media-player-updated",D8="remote-media-player-stopped",L8="local-screen-share-started",V8="local-screen-share-stopped",F8="local-screen-share-canceled",j8="active-speaker-change",U8="active-speaker-mode-change",$8="network-quality-change",B8="network-connection",z8="cpu-load-change",W8="face-counts-updated",_d="fullscreen",vd="exited-fullscreen",q8="live-streaming-started",H8="live-streaming-updated",G8="live-streaming-stopped",K8="live-streaming-error",Q8="lang-updated",J8="receive-settings-updated",$C="input-settings-updated",BC="nonfatal-error",zC="error",Hm=4096,WC=102400,Gm="iframe-call-message",qC="local-screen-start",HC="daily-method-update-live-streaming-endpoints",wd="transmit-log",Qr="daily-custom-track",Jd={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image",FACE_DETECTION:"face-detection"},Ix={NONE:"none",NOISE_CANCELLATION:"noise-cancellation"},s_={PLAY:"play",PAUSE:"pause"},Km=["jpg","png","jpeg"],Y8="add-endpoints",X8="remove-endpoints",GC="sip-call-transfer";function Kn(){return!Te()&&typeof window<"u"&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function Te(){return typeof navigator<"u"&&navigator.product&&navigator.product==="ReactNative"}function Cx(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function Z8(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&(function(t,e){if(!t||!e)return!0;switch(t){case"Chrome":return e.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&!(e.major===13&&e.minor===0&&e.point===0);case"Firefox":return e.major>=67}return!0}(vo(),df())||Te())}function KC(){if(Te()||!document)return!1;var t=document.createElement("iframe");return!!t.requestFullscreen||!!t.webkitRequestFullscreen}var o_="none",e7="software",t7="hardware",n7=function(){try{var t,e=document.createElement("canvas"),n=!1;(t=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0}))||(n=!0,t=e.getContext("webgl2"));var r=t!=null;return e.remove(),r?n?e7:t7:o_}catch{return o_}}();function kx(){var t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!Te()&&n7!==o_&&(t?function(){return QC()?!1:["Chrome","Firefox"].includes(vo())}():function(){if(QC())return!1;var e=vo();if(e==="Safari"){var n=Qw();if(n.major<15||n.major===15&&n.minor<4)return!1}return e==="Chrome"?Kw().major>=77:e==="Firefox"?Jw().major>=97:["Chrome","Firefox","Safari"].includes(e)}())}function bx(){if(Te()||Ax()||typeof AudioWorkletNode>"u")return!1;switch(vo()){case"Chrome":case"Firefox":return!0;case"Safari":var t=df();return t.major>17||t.major===17&&t.minor>=4}return!1}function Qm(){return Cx()&&typeof MediaStreamTrack<"u"&&!function(){var t,e=vo();if(!Kn())return!0;switch(e){case"Chrome":return(t=Kw()).major&&t.major>0&&t.major<75;case"Firefox":return(t=Jw()).major<91;case"Safari":return(t=Qw()).major<13||t.major===13&&t.minor<1;default:return!0}}()}function Ax(){return Kn().match(/Linux; Android/)}function QC(){var t,e=Kn(),n=e.match(/Mac/)&&(!Te()&&typeof window<"u"&&(t=window)!==null&&t!==void 0&&(t=t.navigator)!==null&&t!==void 0&&t.maxTouchPoints?window.navigator.maxTouchPoints:0)>=5;return!!(e.match(/Mobi/)||e.match(/Android/)||n)||!!Kn().match(/DailyAnd\//)||void 0}function vo(){if(typeof window<"u"){var t=Kn();return Px()?"Safari":t.indexOf("Edge")>-1?"Edge":t.match(/Chrome\//)?"Chrome":t.indexOf("Safari")>-1||Rx()?"Safari":t.indexOf("Firefox")>-1?"Firefox":t.indexOf("MSIE")>-1||t.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function df(){switch(vo()){case"Chrome":return Kw();case"Safari":return Qw();case"Firefox":return Jw();case"Edge":return function(){var t=0,e=0;if(typeof window<"u"){var n=Kn().match(/Edge\/(\d+).(\d+)/);if(n)try{t=parseInt(n[1]),e=parseInt(n[2])}catch{}}return{major:t,minor:e}}()}}function Kw(){var t=0,e=0,n=0,r=0,i=!1;if(typeof window<"u"){var s=Kn(),o=s.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(o)try{t=parseInt(o[1]),e=parseInt(o[2]),n=parseInt(o[3]),r=parseInt(o[4]),i=s.indexOf("OPR/")>-1}catch{}}return{major:t,minor:e,build:n,patch:r,opera:i}}function Px(){return!!Kn().match(/iPad|iPhone|iPod/i)&&Cx()}function Rx(){return Kn().indexOf("AppleWebKit/605.1.15")>-1}function Qw(){var t=0,e=0,n=0;if(typeof window<"u"){var r=Kn().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(r)try{t=parseInt(r[1]),e=parseInt(r[2]),n=parseInt(r[4])}catch{}else(Px()||Rx())&&(t=14,e=0,n=3)}return{major:t,minor:e,point:n}}function Jw(){var t=0,e=0;if(typeof window<"u"){var n=Kn().match(/Firefox\/(\d+).(\d+)/);if(n)try{t=parseInt(n[1]),e=parseInt(n[2])}catch{}}return{major:t,minor:e}}var Nx=function(){return Nn(function t(){Rn(this,t)},[{key:"addListenerForMessagesFromCallMachine",value:function(t,e,n){Dl()}},{key:"addListenerForMessagesFromDailyJs",value:function(t,e,n){Dl()}},{key:"sendMessageToCallMachine",value:function(t,e,n,r){Dl()}},{key:"sendMessageToDailyJs",value:function(t,e){Dl()}},{key:"removeListener",value:function(t){Dl()}}])}();function JC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Jm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?JC(Object(n),!0).forEach(function(r){Er(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):JC(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function xx(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xx=function(){return!!t})()}var r7=function(){function t(){var e,n,r,i;return Rn(this,t),n=this,r=hr(r=t),(e=gp(n,xx()?Reflect.construct(r,[],hr(n).constructor):r.apply(n,i)))._wrappedListeners={},e._messageCallbacks={},e}return yp(t,Nx),Nn(t,[{key:"addListenerForMessagesFromCallMachine",value:function(e,n,r){var i=this,s=function(o){if(o.data&&o.data.what==="iframe-call-message"&&(!o.data.callClientId||o.data.callClientId===n)&&(!o.data.from||o.data.from!=="module")){var a=Jm({},o.data);if(delete a.from,a.callbackStamp&&i._messageCallbacks[a.callbackStamp]){var l=a.callbackStamp;i._messageCallbacks[l].call(r,a),delete i._messageCallbacks[l]}delete a.what,delete a.callbackStamp,e.call(r,a)}};this._wrappedListeners[e]=s,window.addEventListener("message",s)}},{key:"addListenerForMessagesFromDailyJs",value:function(e,n,r){var i=function(s){var o;if(!(!s.data||s.data.what!==Gm||!s.data.action||s.data.from&&s.data.from!=="module"||s.data.callClientId&&n&&s.data.callClientId!==n||s!=null&&(o=s.data)!==null&&o!==void 0&&o.callFrameId)){var a=s.data;e.call(r,a)}};this._wrappedListeners[e]=i,window.addEventListener("message",i)}},{key:"sendMessageToCallMachine",value:function(e,n,r,i){if(!r)throw new Error("undefined callClientId. Are you trying to use a DailyCall instance previously destroyed?");var s=Jm({},e);if(s.what=Gm,s.from="module",s.callClientId=r,n){var o=_p();this._messageCallbacks[o]=n,s.callbackStamp=o}var a=i?i.contentWindow:window,l=this._callMachineTargetOrigin(i);l&&a.postMessage(s,l)}},{key:"sendMessageToDailyJs",value:function(e,n){e.what=Gm,e.callClientId=n,e.from="embedded",window.postMessage(e,this._targetOriginFromWindowLocation())}},{key:"removeListener",value:function(e){var n=this._wrappedListeners[e];n&&(window.removeEventListener("message",n),delete this._wrappedListeners[e])}},{key:"forwardPackagedMessageToCallMachine",value:function(e,n,r){var i=Jm({},e);i.callClientId=r;var s=n?n.contentWindow:window,o=this._callMachineTargetOrigin(n);o&&s.postMessage(i,o)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e,n){var r=function(i){if(i.data&&i.data.what==="iframe-call-message"&&(!i.data.callClientId||i.data.callClientId===n)&&(!i.data.from||i.data.from!=="module")){var s=i.data;e(s)}};return this._wrappedListeners[e]=r,window.addEventListener("message",r),e}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){var n=this._wrappedListeners[e];n&&(window.removeEventListener("message",n),delete this._wrappedListeners[e])}},{key:"_callMachineTargetOrigin",value:function(e){return e?e.src?new URL(e.src).origin:void 0:this._targetOriginFromWindowLocation()}},{key:"_targetOriginFromWindowLocation",value:function(){return window.location.protocol==="file:"?"*":window.location.origin}}])}();function YC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Mx(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mx=function(){return!!t})()}var i7=function(){function t(){var e,n,r,i;return Rn(this,t),n=this,r=hr(r=t),e=gp(n,Mx()?Reflect.construct(r,[],hr(n).constructor):r.apply(n,i)),global.callMachineToDailyJsEmitter=global.callMachineToDailyJsEmitter||new By.EventEmitter,global.dailyJsToCallMachineEmitter=global.dailyJsToCallMachineEmitter||new By.EventEmitter,e._wrappedListeners={},e._messageCallbacks={},e}return yp(t,Nx),Nn(t,[{key:"addListenerForMessagesFromCallMachine",value:function(e,n,r){this._addListener(e,global.callMachineToDailyJsEmitter,n,r,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(e,n,r){this._addListener(e,global.dailyJsToCallMachineEmitter,n,r,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(e,n,r){this._sendMessage(e,global.dailyJsToCallMachineEmitter,r,n,"sending message to call machine")}},{key:"sendMessageToDailyJs",value:function(e,n){this._sendMessage(e,global.callMachineToDailyJsEmitter,n,null,"sending message to daily-js")}},{key:"removeListener",value:function(e){var n=this._wrappedListeners[e];n&&(global.callMachineToDailyJsEmitter.removeListener("message",n),global.dailyJsToCallMachineEmitter.removeListener("message",n),delete this._wrappedListeners[e])}},{key:"_addListener",value:function(e,n,r,i,s){var o=this,a=function(l){if(l.callClientId===r){if(l.callbackStamp&&o._messageCallbacks[l.callbackStamp]){var u=l.callbackStamp;o._messageCallbacks[u].call(i,l),delete o._messageCallbacks[u]}e.call(i,l)}};this._wrappedListeners[e]=a,n.addListener("message",a)}},{key:"_sendMessage",value:function(e,n,r,i,s){var o=function(l){for(var u=1;u<arguments.length;u++){var d=arguments[u]!=null?arguments[u]:{};u%2?YC(Object(d),!0).forEach(function(f){Er(l,f,d[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(d)):YC(Object(d)).forEach(function(f){Object.defineProperty(l,f,Object.getOwnPropertyDescriptor(d,f))})}return l}({},e);if(o.callClientId=r,i){var a=_p();this._messageCallbacks[a]=i,o.callbackStamp=a}n.emit("message",o)}}])}(),a_="replace",l_="shallow-merge",XC=[a_,l_],s7=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data,r=e.mergeStrategy,i=r===void 0?a_:r;Rn(this,t),t._validateMergeStrategy(i),t._validateData(n,i),this.mergeStrategy=i,this.data=n}return Nn(t,[{key:"isNoOp",value:function(){return t.isNoOpUpdate(this.data,this.mergeStrategy)}}],[{key:"isNoOpUpdate",value:function(e,n){return Object.keys(e).length===0&&n===l_}},{key:"_validateMergeStrategy",value:function(e){if(!XC.includes(e))throw Error("Unrecognized mergeStrategy provided. Options are: [".concat(XC,"]"))}},{key:"_validateData",value:function(e,n){if(!function(a){if(a==null||ke(a)!=="object")return!1;var l=Object.getPrototypeOf(a);return l==null||l===Object.prototype}(e))throw Error("Meeting session data must be a plain (map-like) object");var r;try{if(r=JSON.stringify(e),n===a_){var i=JSON.parse(r);Yt(i,e)||console.warn("The meeting session data provided will be modified when serialized.",i,e)}else if(n===l_){for(var s in e)if(Object.hasOwnProperty.call(e,s)&&e[s]!==void 0){var o=JSON.parse(JSON.stringify(e[s]));Yt(e[s],o)||console.warn("At least one key in the meeting session data provided will be modified when serialized.",o,e[s])}}}catch(a){throw Error("Meeting session data must be serializable to JSON: ".concat(a))}if(r.length>WC)throw Error("Meeting session data is too large (".concat(r.length," characters). Maximum size suppported is ").concat(WC,"."))}}])}();function Ox(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ox=function(){return!!t})()}function c_(t){var e=typeof Map=="function"?new Map:void 0;return c_=function(n){if(n===null||!function(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(n))return e.get(n);e.set(n,r)}function r(){return function(i,s,o){if(Ox())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,s);var l=new(i.bind.apply(i,a));return o&&eu(l,o.prototype),l}(n,arguments,hr(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),eu(r,n)},c_(t)}function Dx(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dx=function(){return!!t})()}function ZC(t){var e,n=(e=window._daily)===null||e===void 0?void 0:e.pendings;if(n){var r=n.indexOf(t);r!==-1&&n.splice(r,1)}}var o7=function(){return Nn(function t(e){Rn(this,t),this._currentLoad=null,this._callClientId=e},[{key:"load",value:function(){var t,e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(this.loaded)return window._daily.instances[this._callClientId].callMachine.reset(),void r(!0);t=this._callClientId,window._daily.pendings.push(t),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new a7(n,function(){r(!1)},function(s,o){o||ZC(e._callClientId),i(s,o)}),this._currentLoad.start()}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel(),ZC(this._callClientId)}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}])}(),a7=function(){return Nn(function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;Rn(this,t),this._attemptsRemaining=3,this._currentAttempt=null,this._dailyConfig=e,this._successCallback=n,this._failureCallback=r},[{key:"start",value:function(){var t=this;if(!this._currentAttempt){var e=function(n){t._currentAttempt.cancelled||(t._attemptsRemaining--,t._failureCallback(n,t._attemptsRemaining>0),t._attemptsRemaining<=0||setTimeout(function(){t._currentAttempt.cancelled||(t._currentAttempt=new ek(t._dailyConfig,t._successCallback,e),t._currentAttempt.start())},3e3))};this._currentAttempt=new ek(this._dailyConfig,this._successCallback,e),this._currentAttempt.start()}}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}])}(),Ym=function(){function t(){return Rn(this,t),e=this,r=arguments,n=hr(n=t),gp(e,Dx()?Reflect.construct(n,r||[],hr(e).constructor):n.apply(e,r));var e,n,r}return yp(t,c_(Error)),Nn(t)}(),hf=2e4,ek=function(){return Nn(function e(n,r,i){Rn(this,e),this._loadAttemptImpl=Te()||!n.avoidEval?new l7(n,r,i):new c7(n,r,i)},[{key:"start",value:(t=le(function*(){return this._loadAttemptImpl.start()}),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]);var t}(),l7=function(){return Nn(function i(s,o,a){Rn(this,i),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache=typeof iOSCallObjectBundleCache<"u"&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._dailyConfig=s,this._successCallback=o,this._failureCallback=a},[{key:"start",value:(r=le(function*(){var i=sf(this._dailyConfig);!(yield this._tryLoadFromIOSCache(i))&&this._loadFromNetwork(i)}),function(){return r.apply(this,arguments)})},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:(n=le(function*(i){if(!this._iosCache)return!1;try{var s=yield this._iosCache.get(i);return!!this.cancelled||!!s&&(s.code?(Function('"use strict";'+s.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=s.refetchHeaders,!1))}catch{return!1}}),function(i){return n.apply(this,arguments)})},{key:"_loadFromNetwork",value:(e=le(function*(i){var s=this;this._networkTimeout=setTimeout(function(){s._networkTimedOut=!0,s._failureCallback({msg:"Timed out (>".concat(hf," ms) when loading call object bundle ").concat(i),type:"timeout"})},hf);try{var o=this._refetchHeaders?{headers:this._refetchHeaders}:{},a=yield fetch(i,o);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new Ym;var l=yield this._getBundleCodeFromResponse(i,a);if(this.cancelled)throw new Ym;Function('"use strict";'+l)(),this._iosCache&&this._iosCache.set(i,l,a.headers),this.succeeded=!0,this._successCallback()}catch(u){if(clearTimeout(this._networkTimeout),u instanceof Ym||this.cancelled||this._networkTimedOut)return;this._failureCallback({msg:"Failed to load call object bundle ".concat(i,": ").concat(u),type:u.message})}}),function(i){return e.apply(this,arguments)})},{key:"_getBundleCodeFromResponse",value:(t=le(function*(i,s){if(s.ok)return yield s.text();if(this._iosCache&&s.status===304)return(yield this._iosCache.renew(i,s.headers)).code;throw new Error("Received ".concat(s.status," response"))}),function(i,s){return t.apply(this,arguments)})}]);var t,e,n,r}(),c7=function(){return Nn(function t(e,n,r){Rn(this,t),this.cancelled=!1,this.succeeded=!1,this._dailyConfig=e,this._successCallback=n,this._failureCallback=r,this._attemptId=_p(),this._networkTimeout=null,this._scriptElement=null},[{key:"start",value:function(){window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);var t=sf(this._dailyConfig);(typeof document>"u"?"undefined":ke(document))==="object"?this._startLoading(t):this._failureCallback({msg:"Call object bundle must be loaded in a DOM/web context",type:"missing context"})}},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(t){var e=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout(function(){e._stopLoading(),e._failureCallback({msg:"Timed out (>".concat(hf," ms) when loading call object bundle ").concat(t),type:"timeout"})},hf);var n=document.getElementsByTagName("head")[0],r=document.createElement("script");this._scriptElement=r,r.onload=function(){e._stopLoading(),e.succeeded=!0,e._successCallback()},r.onerror=function(i){e._stopLoading(),e._failureCallback({msg:"Failed to load call object bundle ".concat(i.target.src),type:i.message})},r.src=t,n.appendChild(r)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}])}(),Ed=function(t,e,n){return d7(t.local,e,n)===!0},u7=function(t,e,n){return t.local.streams&&t.local.streams[e]&&t.local.streams[e].stream&&t.local.streams[e].stream["get".concat(n==="video"?"Video":"Audio","Tracks")]()[0]},ia=function(t,e,n,r){var i=h7(t,e,n,r);return i&&i.pendingTrack},d7=function(t,e,n){if(!t)return!1;var r=function(s){switch(s){case"avatar":return!0;case"staged":return s;default:return!!s}},i=t.public.subscribedTracks;return i&&i[e]?["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(n)===-1&&i[e].custom?[!0,"staged"].includes(i[e].custom)?r(i[e].custom):r(i[e].custom[n]):r(i[e][n]):!i||r(i.ALL)},h7=function(t,e,n,r){var i=Object.values(t.streams||{}).filter(function(s){return s.participantId===e&&s.type===n&&s.pendingTrack&&s.pendingTrack.kind===r}).sort(function(s,o){return new Date(o.starttime)-new Date(s.starttime)});return i&&i[0]},f7=function(t,e){var n=t.local.public.customTracks;if(n&&n[e])return n[e].track};function tk(t,e){for(var n=e.getState(),r=0,i=["cam","screen"];r<i.length;r++)for(var s=i[r],o=0,a=["video","audio"];o<a.length;o++){var l=a[o],u=s==="cam"?l:"screen".concat(l.charAt(0).toUpperCase()+l.slice(1)),d=t.tracks[u];if(d){var f=t.local?u7(n,s,l):ia(n,t.session_id,s,l);d.state==="playable"&&(d.track=f),d.persistentTrack=f}}}function nk(t,e){try{var n=e.getState();for(var r in t.tracks)if(!p7(r)){var i=t.tracks[r].kind;if(i){var s=t.tracks[r];if(s){var o=t.local?f7(n,r):ia(n,t.session_id,r,i);s.state==="playable"&&(t.tracks[r].track=o),s.persistentTrack=o}}else console.error("unknown type for custom track")}}catch(a){console.error(a)}}function p7(t){return["video","audio","screenVideo","screenAudio"].includes(t)}function rk(t,e,n){var r=n.getState();if(t.local){if(t.audio)try{t.audioTrack=r.local.streams.cam.stream.getAudioTracks()[0],t.audioTrack||(t.audio=!1)}catch{}if(t.video)try{t.videoTrack=r.local.streams.cam.stream.getVideoTracks()[0],t.videoTrack||(t.video=!1)}catch{}if(t.screen)try{t.screenVideoTrack=r.local.streams.screen.stream.getVideoTracks()[0],t.screenAudioTrack=r.local.streams.screen.stream.getAudioTracks()[0],t.screenVideoTrack||t.screenAudioTrack||(t.screen=!1)}catch{}}else{var i=!0;try{var s=r.participants[t.session_id];s&&s.public&&s.public.rtcType&&s.public.rtcType.impl==="peer-to-peer"&&s.private&&!["connected","completed"].includes(s.private.peeringState)&&(i=!1)}catch(d){console.error(d)}if(!i)return t.audio=!1,t.audioTrack=!1,t.video=!1,t.videoTrack=!1,t.screen=!1,void(t.screenTrack=!1);try{if(r.streams,t.audio&&Ed(r,t.session_id,"cam-audio")){var o=ia(r,t.session_id,"cam","audio");o&&(e&&e.audioTrack&&e.audioTrack.id===o.id?t.audioTrack=o:o.muted||(t.audioTrack=o)),t.audioTrack||(t.audio=!1)}if(t.video&&Ed(r,t.session_id,"cam-video")){var a=ia(r,t.session_id,"cam","video");a&&(e&&e.videoTrack&&e.videoTrack.id===a.id?t.videoTrack=a:a.muted||(t.videoTrack=a)),t.videoTrack||(t.video=!1)}if(t.screen&&Ed(r,t.session_id,"screen-audio")){var l=ia(r,t.session_id,"screen","audio");l&&(e&&e.screenAudioTrack&&e.screenAudioTrack.id===l.id?t.screenAudioTrack=l:l.muted||(t.screenAudioTrack=l))}if(t.screen&&Ed(r,t.session_id,"screen-video")){var u=ia(r,t.session_id,"screen","video");u&&(e&&e.screenVideoTrack&&e.screenVideoTrack.id===u.id?t.screenVideoTrack=u:u.muted||(t.screenVideoTrack=u))}t.screenVideoTrack||t.screenAudioTrack||(t.screen=!1)}catch(d){console.error("unexpected error matching up tracks",d)}}}function m7(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(l,u){if(l){if(typeof l=="string")return ik(l,u);var d={}.toString.call(l).slice(8,-1);return d==="Object"&&l.constructor&&(d=l.constructor.name),d==="Map"||d==="Set"?Array.from(l):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?ik(l,u):void 0}}(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||n.return==null||n.return()}finally{if(a)throw s}}}}function ik(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var vr=new Map,wa=null;function g7(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(l,u){if(l){if(typeof l=="string")return sk(l,u);var d={}.toString.call(l).slice(8,-1);return d==="Object"&&l.constructor&&(d=l.constructor.name),d==="Map"||d==="Set"?Array.from(l):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?sk(l,u):void 0}}(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||n.return==null||n.return()}finally{if(a)throw s}}}}function sk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var wr=new Map,yc=null;function y7(t){Lx()?function(e){vr.has(e)||(vr.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(n){vr.has(e)&&(vr.get(e).lastDevicesString=JSON.stringify(n),wa||(wa=function(){var r=le(function*(){var i,s=yield navigator.mediaDevices.enumerateDevices(),o=m7(vr.keys());try{for(o.s();!(i=o.n()).done;){var a=i.value,l=JSON.stringify(s);l!==vr.get(a).lastDevicesString&&(vr.get(a).lastDevicesString=l,a(s))}}catch(u){o.e(u)}finally{o.f()}});return function(){return r.apply(this,arguments)}}(),navigator.mediaDevices.addEventListener("devicechange",wa)))}).catch(function(){}))}(t):function(e){wr.has(e)||(wr.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(n){wr.has(e)&&(wr.get(e).lastDevicesString=JSON.stringify(n),yc||(yc=setInterval(le(function*(){var r,i=yield navigator.mediaDevices.enumerateDevices(),s=g7(wr.keys());try{for(s.s();!(r=s.n()).done;){var o=r.value,a=JSON.stringify(i);a!==wr.get(o).lastDevicesString&&(wr.get(o).lastDevicesString=a,o(i))}}catch(l){s.e(l)}finally{s.f()}}),3e3)))}))}(t)}function _7(t){Lx()?function(e){vr.has(e)&&(vr.delete(e),vr.size===0&&wa&&(navigator.mediaDevices.removeEventListener("devicechange",wa),wa=null))}(t):function(e){wr.has(e)&&(wr.delete(e),wr.size===0&&yc&&(clearInterval(yc),yc=null))}(t)}function Lx(){var t;return Te()||((t=navigator.mediaDevices)===null||t===void 0?void 0:t.ondevicechange)!==void 0}var v7=new Set;function w7(t,e){return t&&t.readyState==="live"&&!function(n,r){return n.muted&&!v7.has(n.id)}(t)}function ok(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ii(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ok(Object(n),!0).forEach(function(r){Er(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ok(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Jl=Object.freeze({VIDEO:"video",AUDIO:"audio",SCREEN_VIDEO:"screenVideo",SCREEN_AUDIO:"screenAudio",CUSTOM_VIDEO:"customVideo",CUSTOM_AUDIO:"customAudio"}),E7=Object.freeze({PARTICIPANTS:"participants",STREAMING:"streaming",TRANSCRIPTION:"transcription"}),_c=Object.values(Jl),ak=["v","a","sv","sa","cv","ca"];Object.freeze(_c.reduce(function(t,e,n){return t[e]=ak[n],t},{})),Object.freeze(ak.reduce(function(t,e,n){return t[e]=_c[n],t},{}));var S7=[Jl.VIDEO,Jl.AUDIO,Jl.SCREEN_VIDEO,Jl.SCREEN_AUDIO],lk=Object.values(E7),ck=["p","s","t"];Object.freeze(lk.reduce(function(t,e,n){return t[e]=ck[n],t},{})),Object.freeze(ck.reduce(function(t,e,n){return t[e]=lk[n],t},{}));var Vx=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.base,r=e.byUserId,i=e.byParticipantId;Rn(this,t),this.base=n,this.byUserId=r,this.byParticipantId=i}return Nn(t,[{key:"clone",value:function(){var e=new t;if(this.base instanceof At?e.base=this.base.clone():e.base=this.base,this.byUserId!==void 0)for(var n in e.byUserId={},this.byUserId){var r=this.byUserId[n];e.byUserId[n]=r instanceof At?r.clone():r}if(this.byParticipantId!==void 0)for(var i in e.byParticipantId={},this.byParticipantId){var s=this.byParticipantId[i];e.byParticipantId[i]=s instanceof At?s.clone():s}return e}},{key:"toJSONObject",value:function(){var e={};if(typeof this.base=="boolean"?e.base=this.base:this.base instanceof At&&(e.base=this.base.toJSONObject()),this.byUserId!==void 0)for(var n in e.byUserId={},this.byUserId){var r=this.byUserId[n];e.byUserId[n]=r instanceof At?r.toJSONObject():r}if(this.byParticipantId!==void 0)for(var i in e.byParticipantId={},this.byParticipantId){var s=this.byParticipantId[i];e.byParticipantId[i]=s instanceof At?s.toJSONObject():s}return e}},{key:"toMinifiedJSONObject",value:function(){var e={};if(this.base!==void 0&&(typeof this.base=="boolean"?e.b=this.base:e.b=this.base.toMinifiedJSONObject()),this.byUserId!==void 0)for(var n in e.u={},this.byUserId){var r=this.byUserId[n];e.u[n]=typeof r=="boolean"?r:r.toMinifiedJSONObject()}if(this.byParticipantId!==void 0)for(var i in e.p={},this.byParticipantId){var s=this.byParticipantId[i];e.p[i]=typeof s=="boolean"?s:s.toMinifiedJSONObject()}return e}},{key:"normalize",value:function(){return this.base instanceof At&&(this.base=this.base.normalize()),this.byUserId&&(this.byUserId=Object.fromEntries(Object.entries(this.byUserId).map(function(e){var n=Wt(e,2),r=n[0],i=n[1];return[r,i instanceof At?i.normalize():i]}))),this.byParticipantId&&(this.byParticipantId=Object.fromEntries(Object.entries(this.byParticipantId).map(function(e){var n=Wt(e,2),r=n[0],i=n[1];return[r,i instanceof At?i.normalize():i]}))),this}}],[{key:"fromJSONObject",value:function(e){var n,r,i;if(e.base!==void 0&&(n=typeof e.base=="boolean"?e.base:At.fromJSONObject(e.base)),e.byUserId!==void 0)for(var s in r={},e.byUserId){var o=e.byUserId[s];r[s]=typeof o=="boolean"?o:At.fromJSONObject(o)}if(e.byParticipantId!==void 0)for(var a in i={},e.byParticipantId){var l=e.byParticipantId[a];i[a]=typeof l=="boolean"?l:At.fromJSONObject(l)}return new t({base:n,byUserId:r,byParticipantId:i})}},{key:"fromMinifiedJSONObject",value:function(e){var n,r,i;if(e.b!==void 0&&(n=typeof e.b=="boolean"?e.b:At.fromMinifiedJSONObject(e.b)),e.u!==void 0)for(var s in r={},e.u){var o=e.u[s];r[s]=typeof o=="boolean"?o:At.fromMinifiedJSONObject(o)}if(e.p!==void 0)for(var a in i={},e.p){var l=e.p[a];i[a]=typeof l=="boolean"?l:At.fromMinifiedJSONObject(l)}return new t({base:n,byUserId:r,byParticipantId:i})}},{key:"validateJSONObject",value:function(e){if(ke(e)!=="object")return[!1,"canReceive must be an object"];for(var n=["base","byUserId","byParticipantId"],r=0,i=Object.keys(e);r<i.length;r++){var s=i[r];if(!n.includes(s))return[!1,"canReceive can only contain keys (".concat(n.join(", "),")")];if(s==="base"){var o=Wt(At.validateJSONObject(e.base,!0),2),a=o[0],l=o[1];if(!a)return[!1,l]}else{if(ke(e[s])!=="object")return[!1,"invalid (non-object) value for field '".concat(s,"' in canReceive")];for(var u=0,d=Object.values(e[s]);u<d.length;u++){var f=d[u],m=Wt(At.validateJSONObject(f),2),w=m[0],E=m[1];if(!w)return[!1,E]}}}return[!0]}}])}(),At=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.video,r=e.audio,i=e.screenVideo,s=e.screenAudio,o=e.customVideo,a=e.customAudio;Rn(this,t),this.video=n,this.audio=r,this.screenVideo=i,this.screenAudio=s,this.customVideo=o,this.customAudio=a}return Nn(t,[{key:"clone",value:function(){var e=new t;return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=Ii({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=Ii({},this.customAudio)),e}},{key:"toJSONObject",value:function(){var e={};return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=Ii({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=Ii({},this.customAudio)),e}},{key:"toMinifiedJSONObject",value:function(){var e={};return this.video!==void 0&&(e.v=this.video),this.audio!==void 0&&(e.a=this.audio),this.screenVideo!==void 0&&(e.sv=this.screenVideo),this.screenAudio!==void 0&&(e.sa=this.screenAudio),this.customVideo!==void 0&&(e.cv=Ii({},this.customVideo)),this.customAudio!==void 0&&(e.ca=Ii({},this.customAudio)),e}},{key:"normalize",value:function(){function e(n,r){return n&&Object.keys(n).length===1&&n["*"]===r}return!(this.video!==!0||this.audio!==!0||this.screenVideo!==!0||this.screenAudio!==!0||!e(this.customVideo,!0)||!e(this.customAudio,!0))||(this.video!==!1||this.audio!==!1||this.screenVideo!==!1||this.screenAudio!==!1||!e(this.customVideo,!1)||!e(this.customAudio,!1))&&this}}],[{key:"fromBoolean",value:function(e){return new t({video:e,audio:e,screenVideo:e,screenAudio:e,customVideo:{"*":e},customAudio:{"*":e}})}},{key:"fromJSONObject",value:function(e){return new t({video:e.video,audio:e.audio,screenVideo:e.screenVideo,screenAudio:e.screenAudio,customVideo:e.customVideo!==void 0?Ii({},e.customVideo):void 0,customAudio:e.customAudio!==void 0?Ii({},e.customAudio):void 0})}},{key:"fromMinifiedJSONObject",value:function(e){return new t({video:e.v,audio:e.a,screenVideo:e.sv,screenAudio:e.sa,customVideo:e.cv,customAudio:e.ca})}},{key:"validateJSONObject",value:function(e,n){if(typeof e=="boolean")return[!0];if(ke(e)!=="object")return[!1,"invalid (non-object, non-boolean) value in canReceive"];for(var r=Object.keys(e),i=0,s=r;i<s.length;i++){var o=s[i];if(!_c.includes(o))return[!1,"invalid media type '".concat(o,"' in canReceive")];if(S7.includes(o)){if(typeof e[o]!="boolean")return[!1,"invalid (non-boolean) value for media type '".concat(o,"' in canReceive")]}else{if(ke(e[o])!=="object")return[!1,"invalid (non-object) value for media type '".concat(o,"' in canReceive")];for(var a=0,l=Object.values(e[o]);a<l.length;a++)if(typeof l[a]!="boolean")return[!1,"invalid (non-boolean) value for entry within '".concat(o,"' in canReceive")];if(n&&e[o]["*"]===void 0)return[!1,`canReceive "base" permission must specify "*" as an entry within '`.concat(o,"'")]}}return n&&r.length!==_c.length?[!1,'canReceive "base" permission must specify all media types: '.concat(_c.join(", ")," (or be set to a boolean shorthand)")]:[!0]}}])}(),T7=["result"],I7=["preserveIframe"];function uk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function re(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?uk(Object(n),!0).forEach(function(r){Er(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uk(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Fx(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fx=function(){return!!t})()}function dk(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(l,u){if(l){if(typeof l=="string")return hk(l,u);var d={}.toString.call(l).slice(8,-1);return d==="Object"&&l.constructor&&(d=l.constructor.name),d==="Map"||d==="Set"?Array.from(l):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?hk(l,u):void 0}}(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||n.return==null||n.return()}finally{if(a)throw s}}}}function hk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Ms={},fk="video",C7="voice",pk=Te()?{data:{}}:{data:{},topology:"none"},mk={present:0,hidden:0},jx={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},Xm=Object.keys(jx),gk=["state","volume","simulcastEncodings"],yk={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},ff={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string",visualState:"'default' | 'sidebar-open' | 'active'"}},u_={id:{allow:"string",controlledBy:"'*' | 'owners' | string[]",csp:"string",iconURL:"string",label:"string",loading:"'eager' | 'lazy'",location:"'main' | 'sidebar'",name:"string",referrerPolicy:"string",sandbox:"string",src:"string",srcdoc:"string",shared:"string[] | 'owners' | boolean"}},Os={customIntegrations:{validate:Gx,help:qx()},customTrayButtons:{validate:Hx,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(ff))},url:{validate:function(t){return typeof t=="string"},help:"url should be a string"},baseUrl:{validate:function(t){return typeof t=="string"},help:"baseUrl should be a string"},token:{validate:function(t){return typeof t=="string"},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(t,e){try{return e.validateDailyConfig(t),!0}catch(n){console.error("Failed to validate dailyConfig",n)}return!1},help:"Unsupported dailyConfig. Check error logs for detailed info."},reactNativeConfig:{validate:function(t){return Kx(t,yk)},help:"reactNativeConfig should look like ".concat(JSON.stringify(yk),", all fields optional")},lang:{validate:function(t){return["da","de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","pt-BR","ru","sv","tr","user"].includes(t)},help:"language not supported. Options are: da, de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, pt-BR, ru, sv, tr, user"},userName:!0,userData:{validate:function(t){try{return Ux(t),!0}catch(e){return console.error(e),!1}},help:"invalid userData type provided"},startVideoOff:!0,startAudioOff:!0,allowLocalVideo:!0,allowLocalAudio:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,showUserNameChangeUI:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(t,e){if(typeof t=="boolean")return e._preloadCache.allowLocalVideo=t,!0;var n;if(t instanceof MediaStreamTrack)e._sharedTracks.videoTrack=t,n={customTrack:Qr};else{if(delete e._sharedTracks.videoTrack,typeof t!="string")return console.error("videoSource must be a MediaStreamTrack, boolean, or a string"),!1;n={deviceId:t}}return e._updatePreloadCacheInputSettings({video:{settings:n}},!1),!0}},audioSource:{validate:function(t,e){if(typeof t=="boolean")return e._preloadCache.allowLocalAudio=t,!0;var n;if(t instanceof MediaStreamTrack)e._sharedTracks.audioTrack=t,n={customTrack:Qr};else{if(delete e._sharedTracks.audioTrack,typeof t!="string")return console.error("audioSource must be a MediaStreamTrack, boolean, or a string"),!1;n={deviceId:t}}return e._updatePreloadCacheInputSettings({audio:{settings:n}},!1),!0}},subscribeToTracksAutomatically:{validate:function(t,e){return e._preloadCache.subscribeToTracksAutomatically=t,!0}},theme:{validate:function(t){var e=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],n=function(r){for(var i=0,s=Object.keys(r);i<s.length;i++){var o=s[i];if(!e.includes(o))return console.error('unsupported color "'.concat(o,'". Valid colors: ').concat(e.join(", "))),!1;if(!r[o].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(o,' theme color should be provided in valid hex color format. Received: "').concat(r[o],'"')),!1}return!0};return ke(t)==="object"&&("light"in t&&"dark"in t||"colors"in t)?"light"in t&&"dark"in t?"colors"in t.light?"colors"in t.dark?n(t.light.colors)&&n(t.dark.colors):(console.error('Dark theme is missing "colors" property.',t),!1):(console.error('Light theme is missing "colors" property.',t),!1):n(t.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',t),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(t){if("grid"in t){var e=t.grid;if("maxTilesPerPage"in e){if(!Number.isInteger(e.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(e.maxTilesPerPage,".")),!1;if(e.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in e){if(!Number.isInteger(e.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(e.minTilesPerPage,".")),!1;if(e.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in e&&e.minTilesPerPage>e.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(t){return $x(t,{allowAllParticipantsKey:!1})},help:Wx({allowAllParticipantsKey:!1})},sendSettings:{validate:function(t,e){return!!function(n,r){try{return r.validateUpdateSendSettings(n),!0}catch(i){return console.error("Failed to validate send settings",i),!1}}(t,e)&&(e._preloadCache.sendSettings=t,!0)},help:"Invalid sendSettings provided. Check error logs for detailed info."},inputSettings:{validate:function(t,e){var n;return!!Bx(t)&&(e._inputSettings||(e._inputSettings={}),zx(t,(n=e.properties)===null||n===void 0?void 0:n.dailyConfig,e._sharedTracks),e._updatePreloadCacheInputSettings(t,!0),!0)},help:d_()},layout:{validate:function(t){return t==="custom-v1"||t==="browser"||t==="none"},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"},proxy:{queryString:"proxy"},strictMode:!0,allowMultipleCallInstances:!0},Sd={styles:{validate:function(t){for(var e in t)if(e!=="cam"&&e!=="screen")return!1;if(t.cam){for(var n in t.cam)if(n!=="div"&&n!=="video")return!1}if(t.screen){for(var r in t.screen)if(r!=="div"&&r!=="video")return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(t,e){if(e._preloadCache.subscribeToTracksAutomatically)return!1;var n=[!0,!1,"staged"];if(n.includes(t)||!Te()&&t==="avatar")return!0;var r=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"],i=function(s){var o=arguments.length>1&&arguments[1]!==void 0&&arguments[1];for(var a in s)if(a==="custom"){if(!n.includes(s[a])&&!i(s[a],!0))return!1}else{var l=!o&&!r.includes(a),u=!n.includes(s[a]);if(l||u)return!1}return!0};return i(t)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(Te()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,setScreenShare:{validate:function(t){return t===!1},help:"setScreenShare must be false, as it's only meant for stopping remote participants' screen shares"},eject:!0,updatePermissions:{validate:function(t){for(var e=0,n=Object.entries(t);e<n.length;e++){var r=Wt(n[e],2),i=r[0],s=r[1];switch(i){case"hasPresence":if(typeof s!="boolean")return!1;break;case"canSend":if(s instanceof Set||s instanceof Array||Array.isArray(s)){var o,a=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],l=dk(s);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(!a.includes(u))return!1}}catch(S){l.e(S)}finally{l.f()}}else if(typeof s!="boolean")return!1;(s instanceof Array||Array.isArray(s))&&(t.canSend=new Set(s));break;case"canReceive":var d=Wt(Vx.validateJSONObject(s),2),f=d[0],m=d[1];if(!f)return console.error(m),!1;break;case"canAdmin":if(s instanceof Set||s instanceof Array||Array.isArray(s)){var w,E=["participants","streaming","transcription"],v=dk(s);try{for(v.s();!(w=v.n()).done;){var b=w.value;if(!E.includes(b))return!1}}catch(S){v.e(S)}finally{v.f()}}else if(typeof s!="boolean")return!1;(s instanceof Array||Array.isArray(s))&&(t.canAdmin=new Set(s));break;default:return!1}}return!0},help:"updatePermissions can take hasPresence, canSend, canReceive, and canAdmin permissions. hasPresence must be a boolean. canSend can be a boolean or an Array or Set of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio). canReceive must be an object specifying base, byUserId, and/or byParticipantId fields (see documentation for more details). canAdmin can be a boolean or an Array or Set of admin types (participants, streaming, transcription)."}};Promise.any||(Promise.any=function(){var t=le(function*(e){return new Promise(function(n,r){var i=[];e.forEach(function(s){return Promise.resolve(s).then(function(o){n(o)}).catch(function(o){i.push(o),i.length===e.length&&r(i)})})})});return function(e){return t.apply(this,arguments)}}());var k7=function(){function t(h){var _,y,P,M,$,G,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Rn(this,t),P=this,M=hr(M=t),Er(y=gp(P,Fx()?Reflect.construct(M,[],hr(P).constructor):M.apply(P,$)),"startListeningForDeviceChanges",function(){y7(y.handleDeviceChange)}),Er(y,"stopListeningForDeviceChanges",function(){_7(y.handleDeviceChange)}),Er(y,"handleDeviceChange",function(fe){fe=fe.map(function(me){return JSON.parse(JSON.stringify(me))}),y.emitDailyJSEvent({action:"available-devices-updated",availableDevices:fe})}),Er(y,"handleNativeAppStateChange",function(){var fe=le(function*(me){if(me==="destroyed")return console.warn("App has been destroyed before leaving the meeting. Cleaning up all the resources!"),void(yield y.destroy());var yn=me==="active";y.disableReactNativeAutoDeviceManagement("video")||(yn?y.camUnmutedBeforeLosingNativeActiveState&&y.setLocalVideo(!0):(y.camUnmutedBeforeLosingNativeActiveState=y.localVideo(),y.camUnmutedBeforeLosingNativeActiveState&&y.setLocalVideo(!1)))});return function(me){return fe.apply(this,arguments)}}()),Er(y,"handleNativeAudioFocusChange",function(fe){y.disableReactNativeAutoDeviceManagement("audio")||(y._hasNativeAudioFocus=fe,y.toggleParticipantAudioBasedOnNativeAudioFocus(),y._hasNativeAudioFocus?y.micUnmutedBeforeLosingNativeAudioFocus&&y.setLocalAudio(!0):(y.micUnmutedBeforeLosingNativeAudioFocus=y.localAudio(),y.setLocalAudio(!1)))}),Er(y,"handleNativeSystemScreenCaptureStop",function(){y.stopScreenShare()}),!Qm()&&!Te())throw new Error("WebRTC not supported or suppressed");if(y.strictMode=K.strictMode===void 0||K.strictMode,y.allowMultipleCallInstances=(_=K.allowMultipleCallInstances)!==null&&_!==void 0&&_,Object.keys(Ms).length&&(y._logDuplicateInstanceAttempt(),!y.allowMultipleCallInstances)){if(y.strictMode)throw new Error("Duplicate DailyIframe instances are not allowed");console.warn("Using strictMode: false to allow multiple call instances is now deprecated. Set `allowMultipleCallInstances: true`")}if(window._daily||(window._daily={pendings:[],instances:{}}),y.callClientId=_p(),Ms[(G=y).callClientId]=G,window._daily.instances[y.callClientId]={},y._sharedTracks={},window._daily.instances[y.callClientId].tracks=y._sharedTracks,K.dailyJsVersion=t.version(),y._iframe=h,y._callObjectMode=K.layout==="none"&&!y._iframe,y._preloadCache={subscribeToTracksAutomatically:!0,outputDeviceId:null,inputSettings:null,sendSettings:null,videoTrackForNetworkConnectivityTest:null,videoTrackForConnectionQualityTest:null},K.showLocalVideo!==void 0?y._callObjectMode?console.error("showLocalVideo is not available in call object mode"):y._showLocalVideo=!!K.showLocalVideo:y._showLocalVideo=!0,K.showParticipantsBar!==void 0?y._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):y._showParticipantsBar=!!K.showParticipantsBar:y._showParticipantsBar=!0,K.customIntegrations!==void 0?y._callObjectMode?console.error("customIntegrations is not available in call object mode"):y._customIntegrations=K.customIntegrations:y._customIntegrations={},K.customTrayButtons!==void 0?y._callObjectMode?console.error("customTrayButtons is not available in call object mode"):y._customTrayButtons=K.customTrayButtons:y._customTrayButtons={},K.activeSpeakerMode!==void 0?y._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):y._activeSpeakerMode=!!K.activeSpeakerMode:y._activeSpeakerMode=!1,K.receiveSettings?y._callObjectMode?y._receiveSettings=K.receiveSettings:console.error("receiveSettings is only available in call object mode"):y._receiveSettings={},y.validateProperties(K),y.properties=re({},K),y._inputSettings||(y._inputSettings={}),y._callObjectLoader=y._callObjectMode?new o7(y.callClientId):null,y._callState=OC,y._isPreparingToJoin=!1,y._accessState={access:qm},y._meetingSessionSummary={},y._finalSummaryOfPrevSession={},y._meetingSessionState=tg(pk,y._callObjectMode),y._nativeInCallAudioMode=fk,y._participants={},y._isScreenSharing=!1,y._participantCounts=mk,y._rmpPlayerState={},y._waitingParticipants={},y._network={threshold:"good",quality:100,networkState:"unknown",stats:{}},y._activeSpeaker={},y._localAudioLevel=0,y._isLocalAudioLevelObserverRunning=!1,y._remoteParticipantsAudioLevel={},y._isRemoteParticipantsAudioLevelObserverRunning=!1,y._maxAppMessageSize=Hm,y._messageChannel=Te()?new i7:new r7,y._iframe&&(y._iframe.requestFullscreen?y._iframe.addEventListener("fullscreenchange",function(){document.fullscreenElement===y._iframe?(y.emitDailyJSEvent({action:_d}),y.sendMessageToCallMachine({action:_d})):(y.emitDailyJSEvent({action:vd}),y.sendMessageToCallMachine({action:vd}))}):y._iframe.webkitRequestFullscreen&&y._iframe.addEventListener("webkitfullscreenchange",function(){document.webkitFullscreenElement===y._iframe?(y.emitDailyJSEvent({action:_d}),y.sendMessageToCallMachine({action:_d})):(y.emitDailyJSEvent({action:vd}),y.sendMessageToCallMachine({action:vd}))})),Te()){var te=y.nativeUtils();te.addAudioFocusChangeListener&&te.removeAudioFocusChangeListener&&te.addAppStateChangeListener&&te.removeAppStateChangeListener&&te.addSystemScreenCaptureStopListener&&te.removeSystemScreenCaptureStopListener||console.warn("expected (add|remove)(AudioFocusChange|AppActiveStateChange|SystemScreenCaptureStop)Listener to be available in React Native"),y._hasNativeAudioFocus=!0,te.addAudioFocusChangeListener(y.handleNativeAudioFocusChange),te.addAppStateChangeListener(y.handleNativeAppStateChange),te.addSystemScreenCaptureStopListener(y.handleNativeSystemScreenCaptureStop)}return y._callObjectMode&&y.startListeningForDeviceChanges(),y._messageChannel.addListenerForMessagesFromCallMachine(y.handleMessageFromCallMachine,y.callClientId,y),y}return yp(t,ud),Nn(t,[{key:"destroy",value:(Ke=le(function*(){var h;try{yield this.leave()}catch{}var _=this._iframe;if(_){var y=_.parentElement;y&&y.removeChild(_)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),Te()){var P=this.nativeUtils();P.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),P.removeAppStateChangeListener(this.handleNativeAppStateChange),P.removeSystemScreenCaptureStopListener(this.handleNativeSystemScreenCaptureStop)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars(),this._destroyed=!0,this.emitDailyJSEvent({action:"call-instance-destroyed"}),delete Ms[this.callClientId],!((h=window)===null||h===void 0||(h=h._daily)===null||h===void 0)&&h.instances&&delete window._daily.instances[this.callClientId],this.strictMode&&(this.callClientId=void 0)}),function(){return Ke.apply(this,arguments)})},{key:"isDestroyed",value:function(){return!!this._destroyed}},{key:"loadCss",value:function(h){var _=h.bodyClass,y=h.cssFile,P=h.cssText;return Se(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(y),bodyClass:_,cssText:P}),this}},{key:"iframe",value:function(){return Se(),this._iframe}},{key:"meetingState",value:function(){return this._callState}},{key:"accessState",value:function(){return Jn(this._callObjectMode,"accessState()"),this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){return Jn(this._callObjectMode,"waitingParticipants()"),this._waitingParticipants}},{key:"validateParticipantProperties",value:function(h,_){for(var y in _){if(!Sd[y])throw new Error("unrecognized updateParticipant property ".concat(y));if(Sd[y].validate&&!Sd[y].validate(_[y],this,this._participants[h]))throw new Error(Sd[y].help)}}},{key:"updateParticipant",value:function(h,_){return this._participants.local&&this._participants.local.session_id===h&&(h="local"),h&&_&&(this.validateParticipantProperties(h,_),this.sendMessageToCallMachine({action:"update-participant",id:h,properties:_})),this}},{key:"updateParticipants",value:function(h){var _=this._participants.local&&this._participants.local.session_id;for(var y in h)y===_&&(y="local"),y&&h[y]&&this.validateParticipantProperties(y,h[y]);return this.sendMessageToCallMachine({action:"update-participants",participants:h}),this}},{key:"updateWaitingParticipant",value:(Oe=le(function*(){var h=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Jn(this._callObjectMode,"updateWaitingParticipant()"),Ve(this._callState,"updateWaitingParticipant()"),typeof _!="string"||ke(y)!=="object")throw new Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise(function(P,M){h.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:_,updates:y},function($){$.error&&M($.error),$.id||M(new Error("unknown error in updateWaitingParticipant()")),P({id:$.id})})})}),function(){return Oe.apply(this,arguments)})},{key:"updateWaitingParticipants",value:(he=le(function*(){var h=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Jn(this._callObjectMode,"updateWaitingParticipants()"),Ve(this._callState,"updateWaitingParticipants()"),ke(_)!=="object")throw new Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise(function(y,P){h.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:_},function(M){M.error&&P(M.error),M.ids||P(new Error("unknown error in updateWaitingParticipants()")),y({ids:M.ids})})})}),function(){return he.apply(this,arguments)})},{key:"requestAccess",value:(se=le(function*(){var h=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=_.access,P=y===void 0?{level:Xz}:y,M=_.name,$=M===void 0?"":M;return Jn(this._callObjectMode,"requestAccess()"),Ve(this._callState,"requestAccess()"),new Promise(function(G,K){h.sendMessageToCallMachine({action:"daily-method-request-access",access:P,name:$},function(te){te.error&&K(te.error),te.access||K(new Error("unknown error in requestAccess()")),G({access:te.access,granted:te.granted})})})}),function(){return se.apply(this,arguments)})},{key:"localAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.audio.state):null}},{key:"localVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.video.state):null}},{key:"setLocalAudio",value:function(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"forceDiscardTrack"in _&&(Te()?(console.warn("forceDiscardTrack option not supported in React Native; ignoring"),_={}):h&&(console.warn("forceDiscardTrack option only supported when calling setLocalAudio(false); ignoring"),_={})),this.sendMessageToCallMachine({action:"local-audio",state:h,options:_}),this}},{key:"localScreenAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenAudio.state):null}},{key:"localScreenVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenVideo.state):null}},{key:"updateScreenShare",value:function(h){if(this._isScreenSharing)return this.sendMessageToCallMachine({action:"local-screen-update",options:h}),this;console.warn("There is no screen share in progress. Try calling startScreenShare first.")}},{key:"setLocalVideo",value:function(h){return this.sendMessageToCallMachine({action:"local-video",state:h}),this}},{key:"_setAllowLocalAudio",value:function(h){if(this._preloadCache.allowLocalAudio=h,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-audio",state:h}),this}},{key:"_setAllowLocalVideo",value:function(h){if(this._preloadCache.allowLocalVideo=h,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-video",state:h}),this}},{key:"getReceiveSettings",value:(X=le(function*(h){var _=this,y=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).showInheritedValues,P=y!==void 0&&y;if(Jn(this._callObjectMode,"getReceiveSettings()"),!this._callMachineInitialized)return this._receiveSettings;switch(ke(h)){case"string":return new Promise(function(M){_.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:h,showInheritedValues:P},function($){M($.receiveSettings)})});case"undefined":return this._receiveSettings;default:throw new Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}}),function(h){return X.apply(this,arguments)})},{key:"updateReceiveSettings",value:(fi=le(function*(h){var _=this;if(Jn(this._callObjectMode,"updateReceiveSettings()"),!$x(h,{allowAllParticipantsKey:!0}))throw new Error(Wx({allowAllParticipantsKey:!0}));return Ve(this._callState,"updateReceiveSettings()","To specify receive settings earlier, use the receiveSettings config property."),new Promise(function(y){_.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:h},function(P){y({receiveSettings:P.receiveSettings})})})}),function(h){return fi.apply(this,arguments)})},{key:"_prepInputSettingsForSharing",value:function(h,_){if(h){var y={};if(h.audio){var P,M,$;h.audio.settings&&(!Object.keys(h.audio.settings).length&&_||(y.audio={settings:re({},h.audio.settings)})),_&&(P=y.audio)!==null&&P!==void 0&&(P=P.settings)!==null&&P!==void 0&&P.customTrack&&(y.audio.settings={customTrack:this._sharedTracks.audioTrack});var G=((M=h.audio.processor)===null||M===void 0?void 0:M.type)==="none"&&(($=h.audio.processor)===null||$===void 0?void 0:$._isDefaultWhenNone);if(h.audio.processor&&!G){var K=re({},h.audio.processor);delete K._isDefaultWhenNone,y.audio=re(re({},y.audio),{},{processor:K})}}if(h.video){var te,fe,me;h.video.settings&&(!Object.keys(h.video.settings).length&&_||(y.video={settings:re({},h.video.settings)})),_&&(te=y.video)!==null&&te!==void 0&&(te=te.settings)!==null&&te!==void 0&&te.customTrack&&(y.video.settings={customTrack:this._sharedTracks.videoTrack});var yn=((fe=h.video.processor)===null||fe===void 0?void 0:fe.type)==="none"&&((me=h.video.processor)===null||me===void 0?void 0:me._isDefaultWhenNone);if(h.video.processor&&!yn){var Or=re({},h.video.processor);delete Or._isDefaultWhenNone,y.video=re(re({},y.video),{},{processor:Or})}}return y}}},{key:"getInputSettings",value:function(){var h=this;return Se(),new Promise(function(_){_(h._getInputSettings())})}},{key:"_getInputSettings",value:function(){var h,_,y,P,M,$,G={processor:{type:"none",_isDefaultWhenNone:!0}};this._inputSettings?(h=((y=this._inputSettings)===null||y===void 0?void 0:y.video)||G,_=((P=this._inputSettings)===null||P===void 0?void 0:P.audio)||G):(h=((M=this._preloadCache)===null||M===void 0||(M=M.inputSettings)===null||M===void 0?void 0:M.video)||G,_=(($=this._preloadCache)===null||$===void 0||($=$.inputSettings)===null||$===void 0?void 0:$.audio)||G);var K={audio:_,video:h};return this._prepInputSettingsForSharing(K,!0)}},{key:"_updatePreloadCacheInputSettings",value:function(h,_){var y=this._inputSettings||{},P={};if(h.video){var M,$,G;P.video={},h.video.settings?(P.video.settings={},_||h.video.settings.customTrack||(G=y.video)===null||G===void 0||!G.settings?P.video.settings=h.video.settings:P.video.settings=re(re({},y.video.settings),h.video.settings),Object.keys(P.video.settings).length||delete P.video.settings):(M=y.video)!==null&&M!==void 0&&M.settings&&(P.video.settings=y.video.settings),h.video.processor?P.video.processor=h.video.processor:($=y.video)!==null&&$!==void 0&&$.processor&&(P.video.processor=y.video.processor)}else y.video&&(P.video=y.video);if(h.audio){var K,te,fe;P.audio={},h.audio.settings?(P.audio.settings={},_||h.audio.settings.customTrack||(fe=y.audio)===null||fe===void 0||!fe.settings?P.audio.settings=h.audio.settings:P.audio.settings=re(re({},y.audio.settings),h.audio.settings),Object.keys(P.audio.settings).length||delete P.audio.settings):(K=y.audio)!==null&&K!==void 0&&K.settings&&(P.audio.settings=y.audio.settings),h.audio.processor?P.audio.processor=h.audio.processor:(te=y.audio)!==null&&te!==void 0&&te.processor&&(P.audio.processor=y.audio.processor)}else y.audio&&(P.audio=y.audio);this._maybeUpdateInputSettings(P)}},{key:"_devicesFromInputSettings",value:function(h){var _,y,P=(h==null||(_=h.video)===null||_===void 0||(_=_.settings)===null||_===void 0?void 0:_.deviceId)||null,M=(h==null||(y=h.audio)===null||y===void 0||(y=y.settings)===null||y===void 0?void 0:y.deviceId)||null,$=this._preloadCache.outputDeviceId||null;return{camera:P?{deviceId:P}:{},mic:M?{deviceId:M}:{},speaker:$?{deviceId:$}:{}}}},{key:"updateInputSettings",value:(hi=le(function*(h){var _=this;return Se(),Bx(h)?h.video||h.audio?(zx(h,this.properties.dailyConfig,this._sharedTracks),this._callObjectMode&&!this._callMachineInitialized?(this._updatePreloadCacheInputSettings(h,!0),this._getInputSettings()):new Promise(function(y,P){_.sendMessageToCallMachine({action:"update-input-settings",inputSettings:h},function(M){if(M.error)P(M.error);else{if(M.returnPreloadCache)return _._updatePreloadCacheInputSettings(h,!0),void y(_._getInputSettings());_._maybeUpdateInputSettings(M.inputSettings),y(_._prepInputSettingsForSharing(M.inputSettings,!0))}})})):this._getInputSettings():(console.error(d_()),Promise.reject(d_()))}),function(h){return hi.apply(this,arguments)})},{key:"setBandwidth",value:function(h){var _=h.kbs,y=h.trackConstraints;if(Se(),this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-bandwidth",kbs:_,trackConstraints:y}),this}},{key:"getDailyLang",value:function(){var h=this;if(Se(),this._callMachineInitialized)return new Promise(function(_){h.sendMessageToCallMachine({action:"get-daily-lang"},function(y){delete y.action,delete y.callbackStamp,_(y)})})}},{key:"setDailyLang",value:function(h){return Se(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:h}),this}},{key:"setProxyUrl",value:function(h){return this.sendMessageToCallMachine({action:"set-proxy-url",proxyUrl:h}),this}},{key:"setIceConfig",value:function(h){return this.sendMessageToCallMachine({action:"set-ice-config",iceConfig:h}),this}},{key:"meetingSessionSummary",value:function(){return[xs,Ti].includes(this._callState)?this._finalSummaryOfPrevSession:this._meetingSessionSummary}},{key:"getMeetingSession",value:(xn=le(function*(){var h=this;return console.warn("getMeetingSession() is deprecated: use meetingSessionSummary(), which will return immediately"),Ve(this._callState,"getMeetingSession()"),new Promise(function(_){h.sendMessageToCallMachine({action:"get-meeting-session"},function(y){delete y.action,delete y.callbackStamp,_(y)})})}),function(){return xn.apply(this,arguments)})},{key:"meetingSessionState",value:function(){return Ve(this._callState,"meetingSessionState"),this._meetingSessionState}},{key:"setMeetingSessionData",value:function(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"replace";Jn(this._callObjectMode,"setMeetingSessionData()"),Ve(this._callState,"setMeetingSessionData");try{(function(y,P){new s7({data:y,mergeStrategy:P})})(h,_)}catch(y){throw console.error(y),y}try{this.sendMessageToCallMachine({action:"set-session-data",data:h,mergeStrategy:_})}catch(y){throw new Error("Error setting meeting session data: ".concat(y))}}},{key:"setUserName",value:function(h,_){var y=this;return this.properties.userName=h,new Promise(function(P){y.sendMessageToCallMachine({action:"set-user-name",name:h??"",thisMeetingOnly:Te()||!!_&&!!_.thisMeetingOnly},function(M){delete M.action,delete M.callbackStamp,P(M)})})}},{key:"setUserData",value:(ut=le(function*(h){var _=this;try{Ux(h)}catch(y){throw console.error(y),y}if(this.properties.userData=h,this._callMachineInitialized)return new Promise(function(y){try{_.sendMessageToCallMachine({action:"set-user-data",userData:h},function(P){delete P.action,delete P.callbackStamp,y(P)})}catch(P){throw new Error("Error setting user data: ".concat(P))}})}),function(h){return ut.apply(this,arguments)})},{key:"validateAudioLevelInterval",value:function(h){if(h&&(h<100||typeof h!="number"))throw new Error("The interval must be a number greater than or equal to 100 milliseconds.")}},{key:"startLocalAudioLevelObserver",value:function(h){var _=this;if(typeof AudioWorkletNode>"u"&&!Te())throw new Error("startLocalAudioLevelObserver() is not supported on this browser");if(this.validateAudioLevelInterval(h),this._callMachineInitialized)return this._isLocalAudioLevelObserverRunning=!0,new Promise(function(y,P){_.sendMessageToCallMachine({action:"start-local-audio-level-observer",interval:h},function(M){_._isLocalAudioLevelObserverRunning=!M.error,M.error?P({error:M.error}):y()})});this._preloadCache.localAudioLevelObserver={enabled:!0,interval:h}}},{key:"isLocalAudioLevelObserverRunning",value:function(){return this._isLocalAudioLevelObserverRunning}},{key:"stopLocalAudioLevelObserver",value:function(){this._preloadCache.localAudioLevelObserver=null,this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-local-audio-level-observer"})}},{key:"startRemoteParticipantsAudioLevelObserver",value:function(h){var _=this;if(this.validateAudioLevelInterval(h),this._callMachineInitialized)return this._isRemoteParticipantsAudioLevelObserverRunning=!0,new Promise(function(y,P){_.sendMessageToCallMachine({action:"start-remote-participants-audio-level-observer",interval:h},function(M){_._isRemoteParticipantsAudioLevelObserverRunning=!M.error,M.error?P({error:M.error}):y()})});this._preloadCache.remoteParticipantsAudioLevelObserver={enabled:!0,interval:h}}},{key:"isRemoteParticipantsAudioLevelObserverRunning",value:function(){return this._isRemoteParticipantsAudioLevelObserverRunning}},{key:"stopRemoteParticipantsAudioLevelObserver",value:function(){this._preloadCache.remoteParticipantsAudioLevelObserver=null,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-remote-participants-audio-level-observer"})}},{key:"startCamera",value:(N=le(function*(){var h=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Jn(this._callObjectMode,"startCamera()"),Zm(this._callState,this._isPreparingToJoin,"startCamera()","Did you mean to use setLocalAudio() and/or setLocalVideo() instead?"),this.needsLoad())try{yield this.load(_)}catch(y){return Promise.reject(y)}else{if(this._didPreAuth){if(_.url&&_.url!==this.properties.url)return console.error("url in startCamera() is different than the one used in preAuth()"),Promise.reject();if(_.token&&_.token!==this.properties.token)return console.error("token in startCamera() is different than the one used in preAuth()"),Promise.reject()}this.validateProperties(_),this.properties=re(re({},this.properties),_)}return new Promise(function(y){h._preloadCache.inputSettings=h._prepInputSettingsForSharing(h._inputSettings,!1),h.sendMessageToCallMachine({action:"start-camera",properties:jo(h.properties,h.callClientId),preloadCache:jo(h._preloadCache,h.callClientId)},function(P){y({camera:P.camera,mic:P.mic,speaker:P.speaker})})})}),function(){return N.apply(this,arguments)})},{key:"validateCustomTrack",value:function(h,_,y){if(y&&y.length>50)throw new Error("Custom track `trackName` must not be more than 50 characters");if(_&&_!=="music"&&_!=="speech"&&!(_ instanceof Object))throw new Error("Custom track `mode` must be either `music` | `speech` | `DailyMicAudioModeSettings` or `undefined`");if(y&&["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo","customVideoDefaults"].includes(y))throw new Error("Custom track `trackName` must not match a track name already used by daily: cam-audio, cam-video, customVideoDefaults, screen-video, screen-audio, rmpAudio, rmpVideo");if(!(h instanceof MediaStreamTrack))throw new Error("Custom tracks provided must be instances of MediaStreamTrack")}},{key:"startCustomTrack",value:function(){var h=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{track,mode,trackName,ignoreAudioLevel};return Se(),Ve(this._callState,"startCustomTrack()"),this.validateCustomTrack(_.track,_.mode,_.trackName),new Promise(function(y,P){h._sharedTracks.customTrack=_.track,_.track=Qr,h.sendMessageToCallMachine({action:"start-custom-track",properties:_},function(M){M.error?P({error:M.error}):y(M.mediaTag)})})}},{key:"stopCustomTrack",value:function(h){var _=this;return Se(),Ve(this._callState,"stopCustomTrack()"),new Promise(function(y){_.sendMessageToCallMachine({action:"stop-custom-track",mediaTag:h},function(P){y(P.mediaTag)})})}},{key:"setCamera",value:function(h){var _=this;return Ll(),Td(this._callMachineInitialized,"setCamera()"),new Promise(function(y){_.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:h},function(P){y({device:P.device})})})}},{key:"setAudioDevice",value:(V=le(function*(h){return Ll(),this.nativeUtils().setAudioDevice(h),{deviceId:yield this.nativeUtils().getAudioDevice()}}),function(h){return V.apply(this,arguments)})},{key:"cycleCamera",value:function(){var h=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(y){h.sendMessageToCallMachine({action:"cycle-camera",properties:_},function(P){y({device:P.device})})})}},{key:"cycleMic",value:function(){var h=this;return Se(),new Promise(function(_){h.sendMessageToCallMachine({action:"cycle-mic"},function(y){_({device:y.device})})})}},{key:"getCameraFacingMode",value:function(){var h=this;return Ll(),new Promise(function(_){h.sendMessageToCallMachine({action:"get-camera-facing-mode"},function(y){_(y.facingMode)})})}},{key:"setInputDevicesAsync",value:(O=le(function*(h){var _=this,y=h.audioDeviceId,P=h.videoDeviceId,M=h.audioSource,$=h.videoSource;if(Se(),M!==void 0&&(y=M),$!==void 0&&(P=$),typeof y=="boolean"&&(this._setAllowLocalAudio(y),y=void 0),typeof P=="boolean"&&(this._setAllowLocalVideo(P),P=void 0),!y&&!P)return yield this.getInputDevices();var G={};return y&&(y instanceof MediaStreamTrack?(this._sharedTracks.audioTrack=y,y=Qr,G.audio={settings:{customTrack:y}}):(delete this._sharedTracks.audioTrack,G.audio={settings:{deviceId:y}})),P&&(P instanceof MediaStreamTrack?(this._sharedTracks.videoTrack=P,P=Qr,G.video={settings:{customTrack:P}}):(delete this._sharedTracks.videoTrack,G.video={settings:{deviceId:P}})),this._callObjectMode&&this.needsLoad()?(this._updatePreloadCacheInputSettings(G,!1),this._devicesFromInputSettings(this._inputSettings)):new Promise(function(K){_.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:y,videoDeviceId:P},function(te){if(delete te.action,delete te.callbackStamp,te.returnPreloadCache)return _._updatePreloadCacheInputSettings(G,!1),void K(_._devicesFromInputSettings(_._inputSettings));K(te)})})}),function(h){return O.apply(this,arguments)})},{key:"setOutputDeviceAsync",value:(x=le(function*(h){var _=this,y=h.outputDeviceId;if(Se(),!y||typeof y!="string")throw new Error("outputDeviceId must be provided and must be a valid device id");return this._preloadCache.outputDeviceId=y,this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(P,M){_.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:y},function($){if(delete $.action,delete $.callbackStamp,$.error){var G=new Error($.error.message);return G.type=$.error.type,void M(G)}$.returnPreloadCache?P(_._devicesFromInputSettings(_._inputSettings)):P($)})})}),function(h){return x.apply(this,arguments)})},{key:"getInputDevices",value:(R=le(function*(){var h=this;return this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(_){h.sendMessageToCallMachine({action:"get-input-devices"},function(y){y.returnPreloadCache?_(h._devicesFromInputSettings(h._inputSettings)):_({camera:y.camera,mic:y.mic,speaker:y.speaker})})})}),function(){return R.apply(this,arguments)})},{key:"nativeInCallAudioMode",value:function(){return Ll(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(h){if(Ll(),[fk,C7].includes(h)){if(h!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=h,!this.disableReactNativeAutoDeviceManagement("audio")&&Yd(this._callState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",h)}},{key:"preAuth",value:(C=le(function*(){var h=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Jn(this._callObjectMode,"preAuth()"),Zm(this._callState,this._isPreparingToJoin,"preAuth()"),this.needsLoad()&&(yield this.load(_)),!_.url)throw new Error("preAuth() requires at least a url to be provided");return this.validateProperties(_),this.properties=re(re({},this.properties),_),new Promise(function(y,P){h._preloadCache.inputSettings=h._prepInputSettingsForSharing(h._inputSettings,!1),h.sendMessageToCallMachine({action:"daily-method-preauth",properties:jo(h.properties,h.callClientId),preloadCache:jo(h._preloadCache,h.callClientId)},function(M){return M.error?P(M.error):M.access?(h._didPreAuth=!0,void y({access:M.access})):P(new Error("unknown error in preAuth()"))})})}),function(){return C.apply(this,arguments)})},{key:"load",value:(A=le(function*(h){var _=this;if(this.needsLoad()){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");if(h&&(this.validateProperties(h),this.properties=re(re({},this.properties),h)),!this._callObjectMode&&!this.properties.url)throw new Error("can't load iframe meeting because url property isn't set");return this._updateCallState(DC),this.emitDailyJSEvent({action:s8}),this._callObjectMode?new Promise(function(y,P){_._callObjectLoader.cancel();var M=Date.now();_._callObjectLoader.load(_.properties.dailyConfig,function($){_._bundleLoadTime=$?"no-op":Date.now()-M,_._updateCallState(LC),$&&_.emitDailyJSEvent({action:FC}),y()},function($,G){if(_.emitDailyJSEvent({action:o8}),!G){_._updateCallState(Ti),_.resetMeetingDependentVars();var K={action:zC,errorMsg:$.msg,error:{type:"connection-error",msg:"Failed to load call object bundle.",details:{on:"load",sourceError:$,bundleUrl:sf(_.properties.dailyConfig)}}};_._maybeSendToSentry(K),_.emitDailyJSEvent(K),P($.msg)}})}):(this._iframe.src=lx(this.assembleMeetingUrl(),this.properties.dailyConfig),new Promise(function(y,P){_._loadedCallback=function(M){_._callState!==Ti?(_._updateCallState(LC),(_.properties.cssFile||_.properties.cssText)&&_.loadCss(_.properties),y()):P(M)}}))}}),function(h){return A.apply(this,arguments)})},{key:"join",value:(z=le(function*(){var h=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._testCallInProgress&&this.stopTestCallQuality();var y=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(_)}catch(P){return this.updateIsPreparingToJoin(!1),Promise.reject(P)}}else{if(y=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(_.url&&_.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(_.token&&_.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(_.url&&!this._callObjectMode&&_.url&&_.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(_.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(_),this.properties=re(re({},this.properties),_)}return _.showLocalVideo!==void 0&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!_.showLocalVideo),_.showParticipantsBar!==void 0&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!_.showParticipantsBar),this._callState===js||this._callState===i_?(console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1)):(this._updateCallState(i_,!1),this.emitDailyJSEvent({action:c8}),this._preloadCache.inputSettings=this._prepInputSettingsForSharing(this._inputSettings||{},!1),this.sendMessageToCallMachine({action:"join-meeting",properties:jo(this.properties,this.callClientId),preloadCache:jo(this._preloadCache,this.callClientId)}),new Promise(function(P,M){h._joinedCallback=function($,G){if(h._callState!==Ti){if(h._updateCallState(js),$)for(var K in $){if(h._callObjectMode){var te=h._callMachine().store;tk($[K],te),nk($[K],te),rk($[K],h._participants[K],te)}h._participants[K]=re({},$[K]),h.toggleParticipantAudioBasedOnNativeAudioFocus()}y&&h.loadCss(h.properties),P($)}else M(G)}}))}),function(){return z.apply(this,arguments)})},{key:"leave",value:(U=le(function*(){var h=this;return this._testCallInProgress&&this.stopTestCallQuality(),new Promise(function(_){h._callState===xs||h._callState===Ti?_():h._callObjectLoader&&!h._callObjectLoader.loaded?(h._callObjectLoader.cancel(),h._updateCallState(xs),h.resetMeetingDependentVars(),h.emitDailyJSEvent({action:xs}),_()):(h._resolveLeave=_,h.sendMessageToCallMachine({action:"leave-meeting"}))})}),function(){return U.apply(this,arguments)})},{key:"startScreenShare",value:(L=le(function*(){var h=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Td(this._callMachineInitialized,"startScreenShare()"),_.screenVideoSendSettings&&this._validateVideoSendSettings("screenVideo",_.screenVideoSendSettings),_.mediaStream&&(this._sharedTracks.screenMediaStream=_.mediaStream,_.mediaStream=Qr),typeof DailyNativeUtils<"u"&&DailyNativeUtils.isIOS!==void 0&&DailyNativeUtils.isIOS){var y=this.nativeUtils();if(yield y.isScreenBeingCaptured())return void this.emitDailyJSEvent({action:BC,type:"screen-share-error",errorMsg:"Could not start the screen sharing. The screen is already been captured!"});y.setSystemScreenCaptureStartCallback(function(){y.setSystemScreenCaptureStartCallback(null),h.sendMessageToCallMachine({action:qC,captureOptions:_})}),y.presentSystemScreenCapturePrompt()}else this.sendMessageToCallMachine({action:qC,captureOptions:_})}),function(){return L.apply(this,arguments)})},{key:"stopScreenShare",value:function(){Td(this._callMachineInitialized,"stopScreenShare()"),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=h.type;if(_&&_!=="cloud"&&_!=="raw-tracks"&&_!=="local")throw new Error("invalid type: ".concat(_,", allowed values 'cloud', 'raw-tracks', or 'local'"));this.sendMessageToCallMachine(re({action:"local-recording-start"},h))}},{key:"updateRecording",value:function(h){var _=h.layout,y=_===void 0?{preset:"default"}:_,P=h.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:y,instanceId:P})}},{key:"stopRecording",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(re({action:"local-recording-stop"},h))}},{key:"startLiveStreaming",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(re({action:"daily-method-start-live-streaming"},h))}},{key:"updateLiveStreaming",value:function(h){var _=h.layout,y=_===void 0?{preset:"default"}:_,P=h.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:y,instanceId:P})}},{key:"addLiveStreamingEndpoints",value:function(h){var _=h.endpoints,y=h.instanceId;this.sendMessageToCallMachine({action:HC,endpointsOp:Y8,endpoints:_,instanceId:y})}},{key:"removeLiveStreamingEndpoints",value:function(h){var _=h.endpoints,y=h.instanceId;this.sendMessageToCallMachine({action:HC,endpointsOp:X8,endpoints:_,instanceId:y})}},{key:"stopLiveStreaming",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(re({action:"daily-method-stop-live-streaming"},h))}},{key:"validateDailyConfig",value:function(h){h.camSimulcastEncodings&&(console.warn("camSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide camera simulcast settings."),this.validateSimulcastEncodings(h.camSimulcastEncodings)),h.screenSimulcastEncodings&&console.warn("screenSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide screen simulcast settings."),Ax()&&h.noAutoDefaultDeviceChange&&console.warn("noAutoDefaultDeviceChange is not supported on Android, and will be ignored.")}},{key:"validateSimulcastEncodings",value:function(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(h){if(!(h instanceof Array||Array.isArray(h)))throw new Error("encodings must be an Array");if(!Sk(h.length,1,3))throw new Error("encodings must be an Array with between 1 to ".concat(3," layers"));for(var P=0;P<h.length;P++){var M=h[P];for(var $ in this._validateEncodingLayerHasValidProperties(M),M)if(Xm.includes($)){if(typeof M[$]!="number")throw new Error("".concat($," must be a number"));if(_){var G=_[$],K=G.min,te=G.max;if(!Sk(M[$],K,te))throw new Error("".concat($," value not in range. valid range: ").concat(K," to ").concat(te))}}else if(!["active","scalabilityMode"].includes($))throw new Error("Invalid key ".concat($,", valid keys are:")+Object.values(Xm));if(y&&!M.hasOwnProperty("maxBitrate"))throw new Error("maxBitrate is not specified")}}}},{key:"startRemoteMediaPlayer",value:(k=le(function*(h){var _=this,y=h.url,P=h.settings,M=P===void 0?{state:s_.PLAY}:P;try{(function($){if(typeof $!="string")throw new Error('url parameter must be "string" type')})(y),Ek(M),function($){for(var G in $)if(!gk.includes(G))throw new Error("Invalid key ".concat(G,", valid keys are: ").concat(gk));$.simulcastEncodings&&this.validateSimulcastEncodings($.simulcastEncodings,jx,!0)}(M)}catch($){throw console.error("invalid argument Error: ".concat($)),console.error(`startRemoteMediaPlayer arguments must be of the form:
  { url: "playback url",
  settings?:
  {state: "play"|"pause", simulcastEncodings?: [{}] } }`),$}return new Promise(function($,G){_.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:y,settings:M},function(K){K.error?G({error:K.error,errorMsg:K.errorMsg}):$({session_id:K.session_id,remoteMediaPlayerState:{state:K.state,settings:K.settings}})})})}),function(h){return k.apply(this,arguments)})},{key:"stopRemoteMediaPlayer",value:(T=le(function*(h){var _=this;if(typeof h!="string")throw new Error(" remotePlayerID must be of type string");return new Promise(function(y,P){_.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:h},function(M){M.error?P({error:M.error,errorMsg:M.errorMsg}):y()})})}),function(h){return T.apply(this,arguments)})},{key:"updateRemoteMediaPlayer",value:(S=le(function*(h){var _=this,y=h.session_id,P=h.settings;try{Ek(P)}catch(M){throw console.error("invalid argument Error: ".concat(M)),console.error(`updateRemoteMediaPlayer arguments must be of the form:
  session_id: "participant session",
  { settings?: {state: "play"|"pause"} }`),M}return new Promise(function(M,$){_.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:y,settings:P},function(G){G.error?$({error:G.error,errorMsg:G.errorMsg}):M({session_id:G.session_id,remoteMediaPlayerState:{state:G.state,settings:G.settings}})})})}),function(h){return S.apply(this,arguments)})},{key:"startTranscription",value:function(h){Ve(this._callState,"startTranscription()"),this.sendMessageToCallMachine(re({action:"daily-method-start-transcription"},h))}},{key:"updateTranscription",value:function(h){if(Ve(this._callState,"updateTranscription()"),!h)throw new Error("updateTranscription Error: options is mandatory");if(ke(h)!=="object")throw new Error("updateTranscription Error: options must be object type");if(h.participants&&!Array.isArray(h.participants))throw new Error("updateTranscription Error: participants must be an array");this.sendMessageToCallMachine(re({action:"daily-method-update-transcription"},h))}},{key:"stopTranscription",value:function(h){if(Ve(this._callState,"stopTranscription()"),h&&ke(h)!=="object")throw new Error("stopTranscription Error: options must be object type");if(h&&!h.instanceId)throw new Error('"instanceId" not provided');this.sendMessageToCallMachine(re({action:"daily-method-stop-transcription"},h))}},{key:"startDialOut",value:(b=le(function*(h){var _=this;Ve(this._callState,"startDialOut()");var y=function(G){if(G){if(!Array.isArray(G))throw new Error("Error starting dial out: audio codec must be an array");if(G.length<=0)throw new Error("Error starting dial out: audio codec array specified but empty");G.forEach(function(K){if(typeof K!="string")throw new Error("Error starting dial out: audio codec must be a string");if(K!=="OPUS"&&K!=="PCMU"&&K!=="PCMA"&&K!=="G722")throw new Error("Error starting dial out: audio codec must be one of OPUS, PCMU, PCMA, G722")})}};if(!h.sipUri&&!h.phoneNumber)throw new Error("Error starting dial out: either a sip uri or phone number must be provided");if(h.sipUri&&h.phoneNumber)throw new Error("Error starting dial out: only one of sip uri or phone number must be provided");if(h.sipUri){if(typeof h.sipUri!="string")throw new Error("Error starting dial out: sipUri must be a string");if(!h.sipUri.startsWith("sip:"))throw new Error("Error starting dial out: Invalid SIP URI, must start with 'sip:'");if(h.video&&typeof h.video!="boolean")throw new Error("Error starting dial out: video must be a boolean value");(function(G){if(G&&(y(G.audio),G.video)){if(!Array.isArray(G.video))throw new Error("Error starting dial out: video codec must be an array");if(G.video.length<=0)throw new Error("Error starting dial out: video codec array specified but empty");G.video.forEach(function(K){if(typeof K!="string")throw new Error("Error starting dial out: video codec must be a string");if(K!=="H264"&&K!=="VP8")throw new Error("Error starting dial out: video codec must be H264 or VP8")})}})(h.codecs)}if(h.phoneNumber){if(typeof h.phoneNumber!="string")throw new Error("Error starting dial out: phoneNumber must be a string");if(!/^\+\d{1,}$/.test(h.phoneNumber))throw new Error("Error starting dial out: Invalid phone number, must be valid phone number as per E.164");h.codecs&&y(h.codecs.audio)}if(h.callerId){if(typeof h.callerId!="string")throw new Error("Error starting dial out: callerId must be a string");if(h.sipUri)throw new Error("Error starting dial out: callerId not allowed with sipUri")}if(h.displayName){if(typeof h.displayName!="string")throw new Error("Error starting dial out: displayName must be a string");if(h.displayName.length>=200)throw new Error("Error starting dial out: displayName length must be less than 200")}if(h.userId){if(typeof h.userId!="string")throw new Error("Error starting dial out: userId must be a string");if(h.userId.length>36)throw new Error("Error starting dial out: userId length must be less than or equal to 36")}if(_k(h),h.permissions&&h.permissions.canReceive){var P=Wt(Vx.validateJSONObject(h.permissions.canReceive),2),M=P[0],$=P[1];if(!M)throw new Error($)}if(h.provider){if(h.provider!=="daily")throw new Error("Error: provider can be set only to 'daily', got: ".concat(h.provider));if(h.phoneNumber)throw new Error("Error starting dial out: provider valid only for sipUri, not phoneNumber");console.warn("(pre-beta) provider=daily is currently in pre-beta, things might break!")}return new Promise(function(G,K){_.sendMessageToCallMachine(re({action:"dialout-start"},h),function(te){te.error?K(te.error):G(te)})})}),function(h){return b.apply(this,arguments)})},{key:"stopDialOut",value:function(h){var _=this;return Ve(this._callState,"stopDialOut()"),new Promise(function(y,P){_.sendMessageToCallMachine(re({action:"dialout-stop"},h),function(M){M.error?P(M.error):y(M)})})}},{key:"sipCallTransfer",value:(v=le(function*(h){var _=this;if(Ve(this._callState,"sipCallTransfer()"),!h)throw new Error("sipCallTransfer() requires a sessionId and toEndPoint");return h.useSipRefer=!1,wk(h,"sipCallTransfer"),_k(h),new Promise(function(y,P){_.sendMessageToCallMachine(re({action:GC},h),function(M){M.error?P(M.error):y(M)})})}),function(h){return v.apply(this,arguments)})},{key:"sipRefer",value:(E=le(function*(h){var _=this;if(Ve(this._callState,"sipRefer()"),!h)throw new Error("sessionId and toEndPoint are mandatory parameter");return h.useSipRefer=!0,wk(h,"sipRefer"),new Promise(function(y,P){_.sendMessageToCallMachine(re({action:GC},h),function(M){M.error?P(M.error):y(M)})})}),function(h){return E.apply(this,arguments)})},{key:"sendDTMF",value:(w=le(function*(h){var _=this;return Ve(this._callState,"sendDTMF()"),function(y){var P=y.sessionId,M=y.tones;if(!P||!M)throw new Error("sessionId and tones are mandatory parameter");if(typeof P!="string"||typeof M!="string")throw new Error("sessionId and tones should be of string type");if(M.length>20)throw new Error("tones string must be upto 20 characters");var $=/[^0-9A-D*#]/g,G=M.match($);if(G&&G[0])throw new Error("".concat(G[0]," is not valid DTMF tone"))}(h),new Promise(function(y,P){_.sendMessageToCallMachine(re({action:"send-dtmf"},h),function(M){M.error?P(M.error):y(M)})})}),function(h){return w.apply(this,arguments)})},{key:"getNetworkStats",value:function(){var h=this;return this._callState!==js?Promise.resolve(re({stats:{latest:{}}},this._network)):new Promise(function(_){h.sendMessageToCallMachine({action:"get-calc-stats"},function(y){_(re(re({},h._network),{},{stats:y.stats}))})})}},{key:"testWebsocketConnectivity",value:(m=le(function*(){var h=this;if(eg(this._testCallInProgress,"testWebsocketConnectivity()"),this.needsLoad())try{yield this.load()}catch(_){return Promise.reject(_)}return new Promise(function(_,y){h.sendMessageToCallMachine({action:"test-websocket-connectivity"},function(P){P.error?y(P.error):_(P.results)})})}),function(){return m.apply(this,arguments)})},{key:"abortTestWebsocketConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-websocket-connectivity"})}},{key:"_validateVideoTrackForNetworkTests",value:function(h){return h?h instanceof MediaStreamTrack?!!w7(h)||(console.error("Video track is not playable. This test needs a live video track."),!1):(console.error("Video track needs to be of type `MediaStreamTrack`."),!1):(console.error("Missing video track. You must provide a video track in order to run this test."),!1)}},{key:"testCallQuality",value:(f=le(function*(){var h=this;Se(),Jn(this._callObjectMode,"testCallQuality()"),Td(this._callMachineInitialized,"testCallQuality()",null,!0),Zm(this._callState,this._isPreparingToJoin,"testCallQuality()");var _=this._testCallAlreadyInProgress,y=function(M){_||(h._testCallInProgress=M)};if(y(!0),this.needsLoad())try{var P=this._callState;yield this.load(),this._callState=P}catch(M){return y(!1),Promise.reject(M)}return new Promise(function(M){h.sendMessageToCallMachine({action:"test-call-quality",dailyJsVersion:h.properties.dailyJsVersion},function($){var G=$.results,K=G.result,te=PI(G,T7);if(K==="failed"){var fe,me=re({},te);(fe=te.error)!==null&&fe!==void 0&&fe.details?(te.error.details=JSON.parse(te.error.details),me.error=re(re({},me.error),{},{details:re({},me.error.details)}),me.error.details.duringTest="testCallQuality"):(me.error=me.error?re({},me.error):{},me.error.details={duringTest:"testCallQuality"}),h._maybeSendToSentry(me)}y(!1),M(re({result:K},te))})})}),function(){return f.apply(this,arguments)})},{key:"stopTestCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-call-quality"})}},{key:"testConnectionQuality",value:(d=le(function*(h){var _;Te()?(console.warn("testConnectionQuality() is deprecated: use testPeerToPeerCallQuality() instead"),_=yield this.testPeerToPeerCallQuality(h)):(console.warn("testConnectionQuality() is deprecated: use testCallQuality() instead"),_=yield this.testCallQuality());var y={result:_.result,secondsElapsed:_.secondsElapsed};return _.data&&(y.data={maxRTT:_.data.maxRoundTripTime,packetLoss:_.data.avgRecvPacketLoss}),y}),function(h){return d.apply(this,arguments)})},{key:"testPeerToPeerCallQuality",value:(u=le(function*(h){var _=this;if(eg(this._testCallInProgress,"testPeerToPeerCallQuality()"),this.needsLoad())try{yield this.load()}catch(M){return Promise.reject(M)}var y=h.videoTrack,P=h.duration;if(!this._validateVideoTrackForNetworkTests(y))throw new Error("Video track error");return this._sharedTracks.videoTrackForConnectionQualityTest=y,new Promise(function(M,$){_.sendMessageToCallMachine({action:"test-p2p-call-quality",duration:P},function(G){G.error?$(G.error):M(G.results)})})}),function(h){return u.apply(this,arguments)})},{key:"stopTestConnectionQuality",value:function(){Te()?(console.warn("stopTestConnectionQuality() is deprecated: use testPeerToPeerCallQuality() and stopTestPeerToPeerCallQuality() instead"),this.stopTestPeerToPeerCallQuality()):(console.warn("stopTestConnectionQuality() is deprecated: use testCallQuality() and stopTestCallQuality() instead"),this.stopTestCallQuality())}},{key:"stopTestPeerToPeerCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-p2p-call-quality"})}},{key:"testNetworkConnectivity",value:(l=le(function*(h){var _=this;if(eg(this._testCallInProgress,"testNetworkConnectivity()"),this.needsLoad())try{yield this.load()}catch(y){return Promise.reject(y)}if(!this._validateVideoTrackForNetworkTests(h))throw new Error("Video track error");return this._sharedTracks.videoTrackForNetworkConnectivityTest=h,new Promise(function(y,P){_.sendMessageToCallMachine({action:"test-network-connectivity"},function(M){M.error?P(M.error):y(M.results)})})}),function(h){return l.apply(this,arguments)})},{key:"abortTestNetworkConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-network-connectivity"})}},{key:"getCpuLoadStats",value:function(){var h=this;return new Promise(function(_){h._callState===js?h.sendMessageToCallMachine({action:"get-cpu-load-stats"},function(y){_(y.cpuStats)}):_({cpuLoadState:void 0,cpuLoadStateReason:void 0,stats:{}})})}},{key:"_validateEncodingLayerHasValidProperties",value:function(h){var _;if(!(((_=Object.keys(h))===null||_===void 0?void 0:_.length)>0))throw new Error("Empty encoding is not allowed. At least one of these valid keys should be specified:"+Object.values(Xm))}},{key:"_validateVideoSendSettings",value:function(h,_){var y=h==="screenVideo"?["default-screen-video","detail-optimized","motion-optimized","motion-and-detail-balanced"]:["default-video","bandwidth-optimized","bandwidth-and-quality-balanced","quality-optimized","adaptive-2-layers","adaptive-3-layers"],P="Video send settings should be either an object or one of the supported presets: ".concat(y.join());if(typeof _=="string"){if(!y.includes(_))throw new Error(P)}else{if(ke(_)!=="object")throw new Error(P);if(!_.maxQuality&&!_.encodings&&_.allowAdaptiveLayers===void 0)throw new Error("Video send settings must contain at least maxQuality, allowAdaptiveLayers or encodings attribute");if(_.maxQuality&&["low","medium","high"].indexOf(_.maxQuality)===-1)throw new Error("maxQuality must be either low, medium or high");if(_.encodings){var M=!1;switch(Object.keys(_.encodings).length){case 1:M=!_.encodings.low;break;case 2:M=!_.encodings.low||!_.encodings.medium;break;case 3:M=!_.encodings.low||!_.encodings.medium||!_.encodings.high;break;default:M=!0}if(M)throw new Error("Encodings must be defined as: low, low and medium, or low, medium and high.");_.encodings.low&&this._validateEncodingLayerHasValidProperties(_.encodings.low),_.encodings.medium&&this._validateEncodingLayerHasValidProperties(_.encodings.medium),_.encodings.high&&this._validateEncodingLayerHasValidProperties(_.encodings.high)}}}},{key:"validateUpdateSendSettings",value:function(h){var _=this;if(!h||Object.keys(h).length===0)throw new Error("Send settings must contain at least information for one track!");Object.entries(h).forEach(function(y){var P=Wt(y,2),M=P[0],$=P[1];_._validateVideoSendSettings(M,$)})}},{key:"updateSendSettings",value:function(h){var _=this;return this.validateUpdateSendSettings(h),this.needsLoad()?(this._preloadCache.sendSettings=h,{sendSettings:this._preloadCache.sendSettings}):new Promise(function(y,P){_.sendMessageToCallMachine({action:"update-send-settings",sendSettings:h},function(M){M.error?P(M.error):y(M.sendSettings)})})}},{key:"getSendSettings",value:function(){return this._sendSettings||this._preloadCache.sendSettings}},{key:"getLocalAudioLevel",value:function(){return this._localAudioLevel}},{key:"getRemoteParticipantsAudioLevel",value:function(){return this._remoteParticipantsAudioLevel}},{key:"getActiveSpeaker",value:function(){return Se(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(h){return Se(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:h}),this}},{key:"activeSpeakerMode",value:function(){return Se(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(h){return Ve(this._callState,"setSubscribeToTracksAutomatically()","Use the subscribeToTracksAutomatically configuration property."),this._preloadCache.subscribeToTracksAutomatically=h,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:h}),this}},{key:"enumerateDevices",value:(a=le(function*(){var h=this;if(this._callObjectMode){var _=yield navigator.mediaDevices.enumerateDevices();return vo()==="Firefox"&&df().major>115&&df().major<123&&(_=_.filter(function(y){return y.kind!=="audiooutput"})),{devices:_.map(function(y){var P=JSON.parse(JSON.stringify(y));if(!Te()&&y.kind==="videoinput"&&y.getCapabilities){var M,$=y.getCapabilities();P.facing=($==null||(M=$.facingMode)===null||M===void 0?void 0:M.length)>=1?$.facingMode[0]:void 0}return P})}}return new Promise(function(y){h.sendMessageToCallMachine({action:"enumerate-devices"},function(P){y({devices:P.devices})})})}),function(){return a.apply(this,arguments)})},{key:"sendAppMessage",value:function(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"*";if(Ve(this._callState,"sendAppMessage()"),JSON.stringify(h).length>this._maxAppMessageSize)throw new Error("Message data too large. Max size is "+this._maxAppMessageSize);return this.sendMessageToCallMachine({action:"app-msg",data:h,to:_}),this}},{key:"addFakeParticipant",value:function(h){return Se(),Ve(this._callState,"addFakeParticipant()"),this.sendMessageToCallMachine(re({action:"add-fake-participant"},h)),this}},{key:"setShowNamesMode",value:function(h){return vn(this._callObjectMode,"setShowNamesMode()"),Se(),h&&h!=="always"&&h!=="never"?(console.error('setShowNamesMode argument should be "always", "never", or false'),this):(this.sendMessageToCallMachine({action:"set-show-names",mode:h}),this)}},{key:"setShowLocalVideo",value:function(){var h=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return vn(this._callObjectMode,"setShowLocalVideo()"),Se(),Ve(this._callState,"setShowLocalVideo()"),typeof h!="boolean"?(console.error("setShowLocalVideo only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-local-video",show:h}),this._showLocalVideo=h,this)}},{key:"showLocalVideo",value:function(){return vn(this._callObjectMode,"showLocalVideo()"),Se(),this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var h=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return vn(this._callObjectMode,"setShowParticipantsBar()"),Se(),Ve(this._callState,"setShowParticipantsBar()"),typeof h!="boolean"?(console.error("setShowParticipantsBar only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:h}),this._showParticipantsBar=h,this)}},{key:"showParticipantsBar",value:function(){return vn(this._callObjectMode,"showParticipantsBar()"),Se(),this._showParticipantsBar}},{key:"customIntegrations",value:function(){return Se(),vn(this._callObjectMode,"customIntegrations()"),this._customIntegrations}},{key:"setCustomIntegrations",value:function(h){return Se(),vn(this._callObjectMode,"setCustomIntegrations()"),Ve(this._callState,"setCustomIntegrations()"),Gx(h)?(this.sendMessageToCallMachine({action:"set-custom-integrations",integrations:h}),this._customIntegrations=h,this):this}},{key:"startCustomIntegrations",value:function(h){var _=this;if(Se(),vn(this._callObjectMode,"startCustomIntegrations()"),Ve(this._callState,"startCustomIntegrations()"),Array.isArray(h)&&h.some(function(M){return typeof M!="string"})||!Array.isArray(h)&&typeof h!="string")return console.error("startCustomIntegrations() only accepts string | string[]"),this;var y=typeof h=="string"?[h]:h,P=y.filter(function(M){return!(M in _._customIntegrations)});return P.length?(console.error(`Can't find custom integration(s): "`.concat(P.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"start-custom-integrations",ids:y}),this)}},{key:"stopCustomIntegrations",value:function(h){var _=this;if(Se(),vn(this._callObjectMode,"stopCustomIntegrations()"),Ve(this._callState,"stopCustomIntegrations()"),Array.isArray(h)&&h.some(function(M){return typeof M!="string"})||!Array.isArray(h)&&typeof h!="string")return console.error("stopCustomIntegrations() only accepts string | string[]"),this;var y=typeof h=="string"?[h]:h,P=y.filter(function(M){return!(M in _._customIntegrations)});return P.length?(console.error(`Can't find custom integration(s): "`.concat(P.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"stop-custom-integrations",ids:y}),this)}},{key:"customTrayButtons",value:function(){return vn(this._callObjectMode,"customTrayButtons()"),Se(),this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(h){return vn(this._callObjectMode,"updateCustomTrayButtons()"),Se(),Ve(this._callState,"updateCustomTrayButtons()"),Hx(h)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:h}),this._customTrayButtons=h,this):(console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(ff))),this)}},{key:"theme",value:function(){return vn(this._callObjectMode,"theme()"),this.properties.theme}},{key:"setTheme",value:function(h){var _=this;return vn(this._callObjectMode,"setTheme()"),new Promise(function(y,P){try{_.validateProperties({theme:h}),_.properties.theme=re({},h),_.sendMessageToCallMachine({action:"set-theme",theme:_.properties.theme});try{_.emitDailyJSEvent({action:i8,theme:_.properties.theme})}catch(M){console.log("could not emit 'theme-updated'",M)}y(_.properties.theme)}catch(M){P(M)}})}},{key:"requestFullscreen",value:(o=le(function*(){if(Se(),this._iframe&&!document.fullscreenElement&&KC())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(h){console.log("could not make video call fullscreen",h)}}),function(){return o.apply(this,arguments)})},{key:"exitFullscreen",value:function(){Se(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"getSidebarView",value:(s=le(function*(){var h=this;return this._callObjectMode?(console.error("getSidebarView is not available in callObject mode"),Promise.resolve(null)):new Promise(function(_){h.sendMessageToCallMachine({action:"get-sidebar-view"},function(y){_(y.view)})})}),function(){return s.apply(this,arguments)})},{key:"setSidebarView",value:function(h){return this._callObjectMode?(console.error("setSidebarView is not available in callObject mode"),this):(this.sendMessageToCallMachine({action:"set-sidebar-view",view:h}),this)}},{key:"room",value:(i=le(function*(){var h=this,_=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).includeRoomConfigDefaults,y=_===void 0||_;return this._accessState.access===qm||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise(function(P){h.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:y},function(M){delete M.action,delete M.callbackStamp,P(M)})})}),function(){return i.apply(this,arguments)})},{key:"geo",value:(r=le(function*(){try{var h=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");return{current:(yield h.json()).geo}}catch(_){return console.error("geo lookup failed",_),{current:""}}}),function(){return r.apply(this,arguments)})},{key:"setNetworkTopology",value:(n=le(function*(h){var _=this;return Se(),Ve(this._callState,"setNetworkTopology()"),new Promise(function(y,P){_.sendMessageToCallMachine({action:"set-network-topology",opts:h},function(M){M.error?P({error:M.error}):y({workerId:M.workerId})})})}),function(h){return n.apply(this,arguments)})},{key:"getNetworkTopology",value:(e=le(function*(){var h=this;return new Promise(function(_,y){h.needsLoad()&&_({topology:"none"}),h.sendMessageToCallMachine({action:"get-network-topology"},function(P){P.error?y({error:P.error}):_({topology:P.topology})})})}),function(){return e.apply(this,arguments)})},{key:"setPlayNewParticipantSound",value:function(h){if(Se(),typeof h!="number"&&h!==!0&&h!==!1)throw new Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(h));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:h})}},{key:"on",value:function(h,_){return ud.prototype.on.call(this,h,_)}},{key:"once",value:function(h,_){return ud.prototype.once.call(this,h,_)}},{key:"off",value:function(h,_){return ud.prototype.off.call(this,h,_)}},{key:"validateProperties",value:function(h){var _,y;if(h!=null&&(_=h.dailyConfig)!==null&&_!==void 0&&_.userMediaAudioConstraints){var P,M;Te()||console.warn("userMediaAudioConstraints is deprecated. You can override constraints with inputSettings.audio.settings, found in DailyCallOptions.");var $=h.inputSettings||{};$.audio=((P=h.inputSettings)===null||P===void 0?void 0:P.audio)||{},$.audio.settings=((M=h.inputSettings)===null||M===void 0||(M=M.audio)===null||M===void 0?void 0:M.settings)||{},$.audio.settings=re(re({},$.audio.settings),h.dailyConfig.userMediaAudioConstraints),h.inputSettings=$,delete h.dailyConfig.userMediaAudioConstraints}if(h!=null&&(y=h.dailyConfig)!==null&&y!==void 0&&y.userMediaVideoConstraints){var G,K;Te()||console.warn("userMediaVideoConstraints is deprecated. You can override constraints with inputSettings.video.settings, found in DailyCallOptions.");var te=h.inputSettings||{};te.video=((G=h.inputSettings)===null||G===void 0?void 0:G.video)||{},te.video.settings=((K=h.inputSettings)===null||K===void 0||(K=K.video)===null||K===void 0?void 0:K.settings)||{},te.video.settings=re(re({},te.video.settings),h.dailyConfig.userMediaVideoConstraints),h.inputSettings=te,delete h.dailyConfig.userMediaVideoConstraints}for(var fe in h)if(Os[fe]){if(Os[fe].validate&&!Os[fe].validate(h[fe],this))throw new Error("property '".concat(fe,"': ").concat(Os[fe].help))}else console.warn("Ignoring unrecognized property '".concat(fe,"'")),delete h[fe]}},{key:"assembleMeetingUrl",value:function(){var h,_,y=re(re({},this.properties),{},{emb:this.callClientId,embHref:encodeURIComponent(window.location.href),proxy:(h=this.properties.dailyConfig)!==null&&h!==void 0&&h.proxyUrl?encodeURIComponent((_=this.properties.dailyConfig)===null||_===void 0?void 0:_.proxyUrl):void 0}),P=y.url.match(/\?/)?"&":"?";return y.url+P+Object.keys(Os).filter(function(M){return Os[M].queryString&&y[M]!==void 0}).map(function(M){return"".concat(Os[M].queryString,"=").concat(y[M])}).join("&")}},{key:"needsLoad",value:function(){return[OC,DC,xs,Ti].includes(this._callState)}},{key:"sendMessageToCallMachine",value:function(h,_){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");this._messageChannel.sendMessageToCallMachine(h,_,this.callClientId,this._iframe)}},{key:"forwardPackagedMessageToCallMachine",value:function(h){this._messageChannel.forwardPackagedMessageToCallMachine(h,this._iframe,this.callClientId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(h){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(h,this.callClientId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(h){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(h)}},{key:"handleMessageFromCallMachine",value:function(h){switch(h.action){case n8:this.sendMessageToCallMachine(re({action:r8},this.properties));break;case"call-machine-initialized":this._callMachineInitialized=!0;var _={action:wd,level:"log",code:1011,stats:{event:"bundle load",time:this._bundleLoadTime==="no-op"?0:this._bundleLoadTime,preLoaded:this._bundleLoadTime==="no-op",url:sf(this.properties.dailyConfig)}};this.sendMessageToCallMachine(_),this._delayDuplicateInstanceLog&&this._logDuplicateInstanceAttempt();break;case FC:this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null),this.emitDailyJSEvent(h);break;case u8:var y,P=re({},h);delete P.internal,this._maxAppMessageSize=((y=h.internal)===null||y===void 0?void 0:y._maxAppMessageSize)||Hm,this._joinedCallback&&(this._joinedCallback(h.participants),this._joinedCallback=null),this.emitDailyJSEvent(P);break;case h8:case f8:if(this._callState===xs)return;if(h.participant&&h.participant.session_id){var M=h.participant.local?"local":h.participant.session_id;if(this._callObjectMode){var $=this._callMachine().store;tk(h.participant,$),nk(h.participant,$),rk(h.participant,this._participants[M],$)}try{this.maybeParticipantTracksStopped(this._participants[M],h.participant),this.maybeParticipantTracksStarted(this._participants[M],h.participant),this.maybeEventRecordingStopped(this._participants[M],h.participant),this.maybeEventRecordingStarted(this._participants[M],h.participant)}catch(ku){console.error("track events error",ku)}this.compareEqualForParticipantUpdateEvent(h.participant,this._participants[M])||(this._participants[M]=re({},h.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus(),this.emitDailyJSEvent(h))}break;case p8:if(h.participant&&h.participant.session_id){var G=this._participants[h.participant.session_id];G&&this.maybeParticipantTracksStopped(G,null),delete this._participants[h.participant.session_id],this.emitDailyJSEvent(h)}break;case m8:Yt(this._participantCounts,h.participantCounts)||(this._participantCounts=h.participantCounts,this.emitDailyJSEvent(h));break;case g8:var K={access:h.access};h.awaitingAccess&&(K.awaitingAccess=h.awaitingAccess),Yt(this._accessState,K)||(this._accessState=K,this.emitDailyJSEvent(h));break;case y8:if(h.meetingSession){this._meetingSessionSummary=h.meetingSession,this.emitDailyJSEvent(h);var te=re(re({},h),{},{action:"meeting-session-updated"});this.emitDailyJSEvent(te)}break;case zC:var fe;this._iframe&&!h.preserveIframe&&(this._iframe.src=""),this._updateCallState(Ti),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(h.errorMsg),this._loadedCallback=null),h.preserveIframe;var me=PI(h,I7);me!=null&&(fe=me.error)!==null&&fe!==void 0&&fe.details&&(me.error.details=JSON.parse(me.error.details)),this._maybeSendToSentry(h),this._joinedCallback&&(this._joinedCallback(null,me),this._joinedCallback=null),this.emitDailyJSEvent(me);break;case d8:this._callState!==Ti&&this._updateCallState(xs),this.resetMeetingDependentVars(),this._resolveLeave&&(this._resolveLeave(),this._resolveLeave=null),this.emitDailyJSEvent(h);break;case"selected-devices-updated":h.devices&&this.emitDailyJSEvent(h);break;case $8:var yn=h.state,Or=h.threshold,Dr=h.quality,et=yn.state,Gt=yn.reasons;et===this._network.networkState&&Yt(Gt,this._network.networkStateReasons)&&Or===this._network.threshold&&Dr===this._network.quality||(this._network.networkState=et,this._network.networkStateReasons=Gt,this._network.quality=Dr,this._network.threshold=Or,h.networkState=et,Gt.length&&(h.networkStateReasons=Gt),delete h.state,this.emitDailyJSEvent(h));break;case z8:h&&h.cpuLoadState&&this.emitDailyJSEvent(h);break;case W8:h&&h.faceCounts!==void 0&&this.emitDailyJSEvent(h);break;case j8:var Qe=h.activeSpeaker;this._activeSpeaker.peerId!==Qe.peerId&&(this._activeSpeaker.peerId=Qe.peerId,this.emitDailyJSEvent({action:h.action,activeSpeaker:this._activeSpeaker}));break;case"show-local-video-changed":if(this._callObjectMode)return;var it=h.show;this._showLocalVideo=it,this.emitDailyJSEvent({action:h.action,show:it});break;case U8:var Lr=h.enabled;this._activeSpeakerMode!==Lr&&(this._activeSpeakerMode=Lr,this.emitDailyJSEvent({action:h.action,enabled:this._activeSpeakerMode}));break;case v8:case w8:case E8:this._waitingParticipants=h.allWaitingParticipants,this.emitDailyJSEvent({action:h.action,participant:h.participant});break;case J8:Yt(this._receiveSettings,h.receiveSettings)||(this._receiveSettings=h.receiveSettings,this.emitDailyJSEvent({action:h.action,receiveSettings:h.receiveSettings}));break;case $C:this._maybeUpdateInputSettings(h.inputSettings);break;case"send-settings-updated":Yt(this._sendSettings,h.sendSettings)||(this._sendSettings=h.sendSettings,this._preloadCache.sendSettings=null,this.emitDailyJSEvent({action:h.action,sendSettings:h.sendSettings}));break;case"local-audio-level":this._localAudioLevel=h.audioLevel,this._preloadCache.localAudioLevelObserver=null,this.emitDailyJSEvent(h);break;case"remote-participants-audio-level":this._remoteParticipantsAudioLevel=h.participantsAudioLevel,this._preloadCache.remoteParticipantsAudioLevelObserver=null,this.emitDailyJSEvent(h);break;case M8:var Is=h.session_id;this._rmpPlayerState[Is]=h.playerState,this.emitDailyJSEvent(h);break;case D8:delete this._rmpPlayerState[h.session_id],this.emitDailyJSEvent(h);break;case O8:var pi=h.session_id,Cu=this._rmpPlayerState[pi];Cu&&this.compareEqualForRMPUpdateEvent(Cu,h.remoteMediaPlayerState)||(this._rmpPlayerState[pi]=h.remoteMediaPlayerState,this.emitDailyJSEvent(h));break;case"custom-button-click":case"sidebar-view-changed":case"pip-started":case"pip-stopped":this.emitDailyJSEvent(h);break;case _8:var Cs=this._meetingSessionState.topology!==(h.meetingSessionState&&h.meetingSessionState.topology);this._meetingSessionState=tg(h.meetingSessionState,this._callObjectMode),(this._callObjectMode||Cs)&&this.emitDailyJSEvent(h);break;case L8:this._isScreenSharing=!0,this.emitDailyJSEvent(h);break;case V8:case F8:this._isScreenSharing=!1,this.emitDailyJSEvent(h);break;case jC:case UC:case b8:case A8:case P8:case I8:case C8:case k8:case a8:case l8:case N8:case x8:case"test-completed":case B8:case R8:case q8:case H8:case G8:case K8:case BC:case Q8:case"dialin-ready":case"dialin-connected":case"dialin-error":case"dialin-stopped":case"dialin-warning":case"dialout-connected":case"dialout-answered":case"dialout-error":case"dialout-stopped":case"dialout-warning":this.emitDailyJSEvent(h);break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(h,_){var y="record";h&&(_.local||_[y]!==!1||h[y]===_[y]||this.emitDailyJSEvent({action:UC}))}},{key:"maybeEventRecordingStarted",value:function(h,_){var y="record";h&&(_.local||_[y]!==!0||h[y]===_[y]||this.emitDailyJSEvent({action:jC}))}},{key:"_trackStatePlayable",value:function(h){return!(!h||h.state!==Yz)}},{key:"_trackChanged",value:function(h,_){return(h==null?void 0:h.id)!==(_==null?void 0:_.id)}},{key:"maybeEventTrackStopped",value:function(h,_,y){var P,M,$=(P=_==null?void 0:_.tracks[h])!==null&&P!==void 0?P:null,G=(M=y==null?void 0:y.tracks[h])!==null&&M!==void 0?M:null,K=$==null?void 0:$.track;if(K){var te=this._trackStatePlayable($),fe=this._trackStatePlayable(G),me=this._trackChanged(K,G==null?void 0:G.track);te&&(fe&&!me||this.emitDailyJSEvent({action:T8,track:K,participant:y??_,type:h}))}}},{key:"maybeEventTrackStarted",value:function(h,_,y){var P,M,$=(P=_==null?void 0:_.tracks[h])!==null&&P!==void 0?P:null,G=(M=y==null?void 0:y.tracks[h])!==null&&M!==void 0?M:null,K=G==null?void 0:G.track;if(K){var te=this._trackStatePlayable($),fe=this._trackStatePlayable(G),me=this._trackChanged($==null?void 0:$.track,K);fe&&(te&&!me||this.emitDailyJSEvent({action:S8,track:K,participant:y,type:h}))}}},{key:"maybeParticipantTracksStopped",value:function(h,_){if(h)for(var y in h.tracks)this.maybeEventTrackStopped(y,h,_)}},{key:"maybeParticipantTracksStarted",value:function(h,_){if(_)for(var y in _.tracks)this.maybeEventTrackStarted(y,h,_)}},{key:"compareEqualForRMPUpdateEvent",value:function(h,_){var y,P;return h.state===_.state&&((y=h.settings)===null||y===void 0?void 0:y.volume)===((P=_.settings)===null||P===void 0?void 0:P.volume)}},{key:"emitDailyJSEvent",value:function(h){try{h.callClientId=this.callClientId,this.emit(h.action,h)}catch(_){console.log("could not emit",h,_)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(h,_){return!!Yt(h,_)&&(!h.videoTrack||!_.videoTrack||h.videoTrack.id===_.videoTrack.id&&h.videoTrack.muted===_.videoTrack.muted&&h.videoTrack.enabled===_.videoTrack.enabled)&&(!h.audioTrack||!_.audioTrack||h.audioTrack.id===_.audioTrack.id&&h.audioTrack.muted===_.audioTrack.muted&&h.audioTrack.enabled===_.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return Te()?typeof DailyNativeUtils>"u"?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(h){this._updateCallState(this._callState,h)}},{key:"_updateCallState",value:function(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._isPreparingToJoin;if(h!==this._callState||_!==this._isPreparingToJoin){var y=this._callState,P=this._isPreparingToJoin;this._callState=h,this._isPreparingToJoin=_;var M=this._callState===js;this.updateShowAndroidOngoingMeetingNotification(M);var $=Yd(y,P),G=Yd(this._callState,this._isPreparingToJoin);$!==G&&(this.updateKeepDeviceAwake(G),this.updateDeviceAudioMode(G),this.updateNoOpRecordingEnsuringBackgroundContinuity(G))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=mk,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:qm},this._finalSummaryOfPrevSession=this._meetingSessionSummary,this._meetingSessionSummary={},this._meetingSessionState=tg(pk,this._callObjectMode),this._isScreenSharing=!1,this._receiveSettings={},this._inputSettings=void 0,this._sendSettings={},this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this._maxAppMessageSize=Hm,this._callMachineInitialized=!1,this._bundleLoadTime=void 0,this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(h){Te()&&this.nativeUtils().setKeepDeviceAwake(h,this.callClientId)}},{key:"updateDeviceAudioMode",value:function(h){if(Te()&&!this.disableReactNativeAutoDeviceManagement("audio")){var _=h?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(_)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(h){if(Te()&&this.nativeUtils().setShowOngoingMeetingNotification){var _,y,P,M;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var $=this.properties.reactNativeConfig.androidInCallNotification;_=$.title,y=$.subtitle,P=$.iconName,M=$.disableForCustomOverride}M&&(h=!1),this.nativeUtils().setShowOngoingMeetingNotification(h,_,y,P,this.callClientId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(h){Te()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(h)}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){var h;if(Te()){var _=(h=this._callMachine())===null||h===void 0||(h=h.store)===null||h===void 0?void 0:h.getState();for(var y in _==null?void 0:_.streams){var P=_.streams[y];P&&P.pendingTrack&&P.pendingTrack.kind==="audio"&&(P.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(h){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[h]}},{key:"absoluteUrl",value:function(h){if(h!==void 0){var _=document.createElement("a");return _.href=h,_.href}}},{key:"sayHello",value:function(){var h="hello, world.";return console.log(h),h}},{key:"_logUseAfterDestroy",value:function(){var h=Object.values(Ms)[0];if(this.needsLoad())if(h&&!h.needsLoad()){var _={action:wd,level:"error",code:this.strictMode?9995:9997};h.sendMessageToCallMachine(_)}else this.strictMode||console.error("You are are attempting to use a call instance that was previously destroyed, which is unsupported. Please remove `strictMode: false` from your constructor properties to enable strict mode to track down and fix this unsupported usage.");else{var y={action:wd,level:"error",code:this.strictMode?9995:9997};this._messageChannel.sendMessageToCallMachine(y,null,this.callClientId,this._iframe)}}},{key:"_logDuplicateInstanceAttempt",value:function(){for(var h=0,_=Object.values(Ms);h<_.length;h++){var y=_[h];y._callMachineInitialized?(y.sendMessageToCallMachine({action:wd,level:"warn",code:this.allowMultipleCallInstances?9993:9992}),y._delayDuplicateInstanceLog=!1):y._delayDuplicateInstanceLog=!0}}},{key:"_maybeSendToSentry",value:function(h){var _,y,P,M;if(!((_=h.error)!==null&&_!==void 0&&_.type&&(![t8,e8,VC].includes(h.error.type)||h.error.type===VC&&h.error.msg.includes("deleted")))){var $=(y=this.properties)!==null&&y!==void 0&&y.url?new URL(this.properties.url):void 0,G="production";$&&$.host.includes(".staging.daily")&&(G="staging");var K,te,fe,me,yn,Or=function(Is){const pi=[yz(),mz(),zz(),$z(),Kz(),Jz(),Ez(),Qz()];return Is.autoSessionTracking!==!1&&pi.push(Gz()),pi}({}).filter(function(Is){return!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(Is.name)}),Dr=new Pz({dsn:"https://f10f1c81e5d44a4098416c0867a8b740@o77906.ingest.sentry.io/168844",transport:Oz,stackParser:Uz,integrations:Or,environment:G}),et=new hs;if(et.setClient(Dr),Dr.init(),this.session_id&&et.setExtra("sessionId",this.session_id),this.properties){var Gt=re({},this.properties);Gt.userName=Gt.userName?"[Filtered]":void 0,Gt.userData=Gt.userData?"[Filtered]":void 0,Gt.token=Gt.token?"[Filtered]":void 0,et.setExtra("properties",Gt)}if($){var Qe=$.searchParams.get("domain");if(!Qe){var it=$.host.match(/(.*?)\./);Qe=it&&it[1]||""}Qe&&et.setTag("domain",Qe)}h.error&&(et.setTag("fatalErrorType",h.error.type),et.setExtra("errorDetails",h.error.details),!((K=h.error.details)===null||K===void 0)&&K.uri&&et.setTag("serverAddress",h.error.details.uri),!((te=h.error.details)===null||te===void 0)&&te.workerGroup&&et.setTag("workerGroup",h.error.details.workerGroup),!((fe=h.error.details)===null||fe===void 0)&&fe.geoGroup&&et.setTag("geoGroup",h.error.details.geoGroup),!((me=h.error.details)===null||me===void 0)&&me.on&&et.setTag("connectionAttempt",h.error.details.on),(yn=h.error.details)!==null&&yn!==void 0&&yn.bundleUrl&&(et.setTag("bundleUrl",h.error.details.bundleUrl),et.setTag("bundleError",h.error.details.sourceError.type))),et.setTags({callMode:this._callObjectMode?Te()?"reactNative":(P=this.properties)!==null&&P!==void 0&&(P=P.dailyConfig)!==null&&P!==void 0&&(P=P.callMode)!==null&&P!==void 0&&P.includes("prebuilt")?this.properties.dailyConfig.callMode:"custom":"prebuilt-frame",version:t.version()});var Lr=((M=h.error)===null||M===void 0?void 0:M.msg)||h.errorMsg;et.captureException(new Error(Lr))}}},{key:"_callMachine",value:function(){var h;return(h=window._daily)===null||h===void 0||(h=h.instances)===null||h===void 0||(h=h[this.callClientId])===null||h===void 0?void 0:h.callMachine}},{key:"_maybeUpdateInputSettings",value:function(h){if(!Yt(this._inputSettings,h)){var _=this._getInputSettings();this._inputSettings=h;var y=this._getInputSettings();Yt(_,y)||this.emitDailyJSEvent({action:$C,inputSettings:y})}}}],[{key:"supportedBrowser",value:function(){if(Te())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!0,supportsSfu:!0,supportsVideoProcessing:!1,supportsAudioProcessing:!1};var h=VB.getParser(Kn());return{supported:!!Qm(),mobile:h.getPlatformType()==="mobile",name:h.getBrowserName(),version:h.getBrowserVersion(),supportsFullscreen:!!KC(),supportsScreenShare:!!Z8(),supportsSfu:!!Qm(),supportsVideoProcessing:kx(),supportsAudioProcessing:bx()}}},{key:"version",value:function(){return"0.85.0"}},{key:"createCallObject",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return h.layout="none",new t(null,h)}},{key:"wrap",value:function(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Se(),!h||!h.contentWindow||typeof h.src!="string")throw new Error("DailyIframe::Wrap needs an iframe-like first argument");return _.layout||(_.customLayout?_.layout="custom-v1":_.layout="browser"),new t(h,_)}},{key:"createFrame",value:function(h,_){var y,P;Se(),h&&_?(y=h,P=_):h&&h.append?(y=h,P={}):(y=document.body,P=h||{});var M=P.iframeStyle;M||(M=y===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var $=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?$.allow="microphone, camera":$.allow="microphone; camera; autoplay; display-capture; screen-wake-lock",$.style.visibility="hidden",y.appendChild($),$.style.visibility=null,Object.keys(M).forEach(function(G){return $.style[G]=M[G]}),P.layout||(P.customLayout?P.layout="custom-v1":P.layout="browser");try{return new t($,P)}catch(G){throw y.removeChild($),G}}},{key:"createTransparentFrame",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Se();var _=document.createElement("iframe");return _.allow="microphone; camera; autoplay",_.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
      pointer-events: none;
    `,document.body.appendChild(_),h.layout||(h.layout="custom-v1"),t.wrap(_,h)}},{key:"getCallInstance",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;return h?Ms[h]:Object.values(Ms)[0]}}]);var e,n,r,i,s,o,a,l,u,d,f,m,w,E,v,b,S,T,k,L,U,z,A,C,R,x,O,V,N,ut,xn,hi,fi,X,se,he,Oe,Ke}();function _k(t){if(t.extension){if(typeof t.extension!="string")throw new Error("Error starting dial out: extension must be a string");if(t.extension.length>20)throw new Error("Error starting dial out: extension length must be less than or equal to 20")}if(t.waitBeforeExtensionDialSec){if(typeof t.waitBeforeExtensionDialSec!="number")throw new Error("Error starting dial out: waitBeforeExtensionDialSec must be a number");if(t.waitBeforeExtensionDialSec>60)throw new Error("Error starting dial out: waitBeforeExtensionDialSec must be less than or equal to 60");if(!t.extension)throw new Error("Error starting dial out: waitBeforeExtensionDialSec requires a phoneNumber and extension")}}function jo(t,e){var n={};for(var r in t)if(t[r]instanceof MediaStreamTrack)console.warn("MediaStreamTrack found in props or cache.",r),n[r]=Qr;else if(r==="dailyConfig"){if(t[r].modifyLocalSdpHook){var i=window._daily.instances[e].customCallbacks||{};i.modifyLocalSdpHook=t[r].modifyLocalSdpHook,window._daily.instances[e].customCallbacks=i,delete t[r].modifyLocalSdpHook}if(t[r].modifyRemoteSdpHook){var s=window._daily.instances[e].customCallbacks||{};s.modifyRemoteSdpHook=t[r].modifyRemoteSdpHook,window._daily.instances[e].customCallbacks=s,delete t[r].modifyRemoteSdpHook}n[r]=t[r]}else n[r]=t[r];return n}function Ve(t){var e=arguments.length>2?arguments[2]:void 0;if(t!==js){var n="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," only supported after join.");throw e&&(n+=" ".concat(e)),console.error(n),new Error(n)}}function Yd(t,e){return[i_,js].includes(t)||e}function Zm(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"This daily-js method",r=arguments.length>3?arguments[3]:void 0;if(Yd(t,e)){var i="".concat(n," not supported after joining a meeting.");throw r&&(i+=" ".concat(r)),console.error(i),new Error(i)}}function Td(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method",n=arguments.length>2?arguments[2]:void 0;if(!t){var r="".concat(e,arguments.length>3&&arguments[3]!==void 0&&arguments[3]?" requires preAuth() or startCamera() to initialize call state.":" requires preAuth(), startCamera(), or join() to initialize call state.");throw n&&(r+=" ".concat(n)),console.error(r),new Error(r)}}function eg(t){if(t){var e="A pre-call quality test is in progress. Please try ".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," again once testing has completed. Use stopTestCallQuality() to end it early.");throw console.error(e),new Error(e)}}function Jn(t){if(!t){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported on custom callObject instances");throw console.error(e),new Error(e)}}function vn(t){if(t){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported as part of Daily's Prebuilt");throw console.error(e),new Error(e)}}function Se(){if(Te())throw new Error("This daily-js method is not currently supported in React Native")}function Ll(){if(!Te())throw new Error("This daily-js method is only supported in React Native")}function Ux(t){if(t===void 0)return!0;var e;if(typeof t=="string")e=t;else try{e=JSON.stringify(t),Yt(JSON.parse(e),t)||console.warn("The userData provided will be modified when serialized.")}catch(n){throw Error("userData must be serializable to JSON: ".concat(n))}if(e.length>4096)throw Error("userData is too large (".concat(e.length," characters). Maximum size suppported is ").concat(4096,"."));return!0}function $x(t,e){for(var n=e.allowAllParticipantsKey,r=function(f){var m=["local"];return n||m.push("*"),f&&!m.includes(f)},i=function(f){return!!(f.layer===void 0||Number.isInteger(f.layer)&&f.layer>=0||f.layer==="inherit")},s=function(f){return!!f&&!(f.video&&!i(f.video))&&!(f.screenVideo&&!i(f.screenVideo))},o=0,a=Object.entries(t);o<a.length;o++){var l=Wt(a[o],2),u=l[0],d=l[1];if(!r(u)||!s(d))return!1}return!0}function Bx(t){if(ke(t)!=="object")return!1;for(var e=0,n=Object.entries(t);e<n.length;e++){var r=Wt(n[e],2),i=r[0],s=r[1];switch(i){case"video":if(ke(s)!=="object")return!1;for(var o=0,a=Object.entries(s);o<a.length;o++){var l=Wt(a[o],2),u=l[0],d=l[1];switch(u){case"processor":if(!A7(d))return!1;break;case"settings":if(!vk(d))return!1;break;default:return!1}}break;case"audio":if(ke(s)!=="object")return!1;for(var f=0,m=Object.entries(s);f<m.length;f++){var w=Wt(m[f],2),E=w[0],v=w[1];switch(E){case"processor":if(!b7(v))return!1;break;case"settings":if(!vk(v))return!1;break;default:return!1}}break;default:return!1}}return!0}function zx(t,e,n){var r,i=[];t.video&&t.video.processor&&(kx((r=e==null?void 0:e.useLegacyVideoProcessor)!==null&&r!==void 0&&r)||(t.video.settings?delete t.video.processor:delete t.video,i.push("video"))),t.audio&&t.audio.processor&&(bx()||(t.audio.settings?delete t.audio.processor:delete t.audio,i.push("audio"))),i.length>0&&console.error("Ignoring settings for browser- or platform-unsupported input processor(s): ".concat(i.join(", "))),t.audio&&t.audio.settings&&(t.audio.settings.customTrack?(n.audioTrack=t.audio.settings.customTrack,t.audio.settings={customTrack:Qr}):delete n.audioTrack),t.video&&t.video.settings&&(t.video.settings.customTrack?(n.videoTrack=t.video.settings.customTrack,t.video.settings={customTrack:Qr}):delete n.videoTrack)}function b7(t){if(Te())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type"];return!!t&&ke(t)==="object"&&(Object.keys(t).filter(function(n){return!e.includes(n)}).forEach(function(n){console.warn("invalid key inputSettings -> audio -> processor : ".concat(n)),delete t[n]}),!!function(n){return typeof n!="string"?!1:Object.values(Ix).includes(n)?!0:(console.error("inputSettings audio processor type invalid"),!1)}(t.type))}function A7(t){if(Te())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type","config"];return!t||ke(t)!=="object"||!function(n){return typeof n!="string"?!1:Object.values(Jd).includes(n)?!0:(console.error("inputSettings video processor type invalid"),!1)}(t.type)||t.config&&(ke(t.config)!=="object"||!function(n,r){var i=Object.keys(r);if(i.length===0)return!0;var s="invalid object in inputSettings -> video -> processor -> config";switch(n){case Jd.BGBLUR:return i.length>1||i[0]!=="strength"?(console.error(s),!1):!(typeof r.strength!="number"||r.strength<=0||r.strength>1||isNaN(r.strength))||(console.error("".concat(s,"; expected: {0 < strength <= 1}, got: ").concat(r.strength)),!1);case Jd.BGIMAGE:return!(r.source!==void 0&&!function(o){if(o.source==="default")return o.type="default",!0;if(o.source instanceof ArrayBuffer)return!0;if(of(o.source))return o.type="url",!!function(u){var d=new URL(u),f=d.pathname;if(d.protocol==="data:")try{var m=f.substring(f.indexOf(":")+1,f.indexOf(";")).split("/")[1];return Km.includes(m)}catch(E){return console.error("failed to deduce blob content type",E),!1}var w=f.split(".").at(-1).toLowerCase().trim();return Km.includes(w)}(o.source)||(console.error("invalid image type; supported types: [".concat(Km.join(", "),"]")),!1);return a=o.source,l=Number(a),isNaN(l)||!Number.isInteger(l)||l<=0||l>10?(console.error("invalid image selection; must be an int, > 0, <= ".concat(10)),!1):(o.type="daily-preselect",!0);var a,l}(r));default:return!0}}(t.type,t.config))?!1:(Object.keys(t).filter(function(n){return!e.includes(n)}).forEach(function(n){console.warn("invalid key inputSettings -> video -> processor : ".concat(n)),delete t[n]}),!0)}function vk(t){return ke(t)==="object"&&(!t.customTrack||t.customTrack instanceof MediaStreamTrack)}function d_(){var t=Object.values(Jd).join(" | "),e=Object.values(Ix).join(" | ");return"inputSettings must be of the form: { video?: { processor?: { type: [ ".concat(t," ], config?: {} } }, audio?: { processor: {type: [ ").concat(e," ] } } }")}function Wx(t){var e=t.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat(Zz).concat(e?' | "'.concat("*",'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function qx(){return"customIntegrations should be an object of type ".concat(JSON.stringify(u_),".")}function Hx(t){if(t&&ke(t)!=="object"||Array.isArray(t))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(ff),".")),!1;if(t)for(var e=0,n=Object.entries(t);e<n.length;e++)for(var r=Wt(n[e],1)[0],i=0,s=Object.entries(t[r]);i<s.length;i++){var o=Wt(s[i],2),a=o[0],l=o[1],u=ff.id[a];if(!u)return console.error("customTrayButton does not support key ".concat(a)),!1;switch(a){case"iconPath":case"iconPathDarkMode":if(!of(l))return console.error("customTrayButton ".concat(a," should be a url.")),!1;break;case"visualState":if(!["default","sidebar-open","active"].includes(l))return console.error("customTrayButton ".concat(a," should be ").concat(u,". Got: ").concat(l)),!1;break;default:if(ke(l)!==u)return console.error("customTrayButton ".concat(a," should be a ").concat(u,".")),!1}}return!0}function Gx(t){if(!t||t&&ke(t)!=="object"||Array.isArray(t))return console.error(qx()),!1;for(var e=function(f){return"".concat(f," should be ").concat(u_.id[f])},n=function(f,m){return console.error("customIntegration ".concat(f,": ").concat(m))},r=0,i=Object.entries(t);r<i.length;r++){var s=Wt(i[r],1)[0];if(!("label"in t[s]))return n(s,"label is required"),!1;if(!("location"in t[s]))return n(s,"location is required"),!1;if(!("src"in t[s])&&!("srcdoc"in t[s]))return n(s,"src or srcdoc is required"),!1;for(var o=0,a=Object.entries(t[s]);o<a.length;o++){var l=Wt(a[o],2),u=l[0],d=l[1];switch(u){case"allow":case"csp":case"name":case"referrerPolicy":case"sandbox":if(typeof d!="string")return n(s,e(u)),!1;break;case"iconURL":if(!of(d))return n(s,"".concat(u," should be a url")),!1;break;case"src":if("srcdoc"in t[s])return n(s,"cannot have both src and srcdoc"),!1;if(!of(d))return n(s,'src "'.concat(d,'" is not a valid URL')),!1;break;case"srcdoc":if("src"in t[s])return n(s,"cannot have both src and srcdoc"),!1;if(typeof d!="string")return n(s,e(u)),!1;break;case"location":if(!["main","sidebar"].includes(d))return n(s,e(u)),!1;break;case"controlledBy":if(d!=="*"&&d!=="owners"&&(!Array.isArray(d)||d.some(function(f){return typeof f!="string"})))return n(s,e(u)),!1;break;case"shared":if((!Array.isArray(d)||d.some(function(f){return typeof f!="string"}))&&d!=="owners"&&typeof d!="boolean")return n(s,e(u)),!1;break;default:if(!u_.id[u])return console.error("customIntegration does not support key ".concat(u)),!1}}}return!0}function Kx(t,e){if(e===void 0)return!1;switch(ke(e)){case"string":return ke(t)===e;case"object":if(ke(t)!=="object")return!1;for(var n in t)if(!Kx(t[n],e[n]))return!1;return!0;default:return!1}}function wk(t,e){var n=t.sessionId,r=t.toEndPoint,i=t.callerId,s=t.useSipRefer;if(!n||!r)throw new Error("".concat(e,"() requires a sessionId and toEndPoint"));if(typeof n!="string"||typeof r!="string")throw new Error("Invalid paramater: sessionId and toEndPoint must be of type string");if(s&&!r.startsWith("sip:"))throw new Error('"toEndPoint" must be a "sip" address');if(!r.startsWith("sip:")&&!r.startsWith("+"))throw new Error("toEndPoint: ".concat(r,' must starts with either "sip:" or "+"'));if(i&&typeof i!="string")throw new Error("callerId must be of type string");if(i&&!r.startsWith("+"))throw new Error("callerId is only valid when transferring to a PSTN number")}function Ek(t){if(ke(t)!=="object")throw new Error('RemoteMediaPlayerSettings: must be "object" type');if(t.state&&!Object.values(s_).includes(t.state))throw new Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(s_));if(t.volume){if(typeof t.volume!="number")throw new Error('RemoteMediaPlayerSettings.volume: must be "number" type');if(t.volume<0||t.volume>2)throw new Error("RemoteMediaPlayerSettings.volume: must be between 0.0 - 2.0")}}function Sk(t,e,n){return!(typeof t!="number"||t<e||t>n)}function tg(t,e){return t&&!e&&delete t.data,t}const Qx=q.createContext({callObject:null,createRoom:async()=>null,joinCall:()=>{},leaveCall:()=>{},isInCall:!1}),P7=()=>q.useContext(Qx),R7=({children:t})=>{const[e,n]=q.useState(null),[r,i]=q.useState(!1);q.useEffect(()=>{const l=k7.createCallObject();return n(l),l.on("joined-meeting",()=>i(!0)).on("left-meeting",()=>i(!1)).on("error",u=>console.error("Daily error:",u)),()=>{l.destroy()}},[]);const s=q.useCallback(async()=>(console.error("Daily API Key is missing!"),alert("Missing Daily API Key. Please add VITE_DAILY_API_KEY to your .env file."),null),[]),o=q.useCallback(l=>{e&&e.join({url:l})},[e]),a=q.useCallback(()=>{e&&e.leave()},[e]);return D.jsx(Qx.Provider,{value:{callObject:e,createRoom:s,joinCall:o,leaveCall:a,isInCall:r},children:t})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var N7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x7=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),gn=(t,e)=>{const n=q.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:a="",children:l,...u},d)=>q.createElement("svg",{ref:d,...N7,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:["lucide",`lucide-${x7(t)}`,a].join(" "),...u},[...e.map(([f,m])=>q.createElement(f,m)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M7=gn("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O7=gn("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D7=gn("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=gn("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L7=gn("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V7=gn("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F7=gn("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j7=gn("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U7=gn("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $7=gn("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B7=gn("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z7=gn("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h_=gn("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W7=gn("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),q7=()=>{const{currentUser:t,userProfile:e}=No(),{createRoom:n,joinCall:r,isInCall:i}=P7(),[s,o]=q.useState(null),[a,l]=q.useState(null);q.useEffect(()=>{if(!t)return;const m=qh(Jc(Xt,"calls"),hc("recipientId","==",t.uid),hc("status","==","ringing")),w=Hh(m,E=>{if(E.empty)o(null);else{const v=E.docs[0];o({id:v.id,...v.data()})}});return()=>w()},[t]),q.useEffect(()=>{if(!a)return;const m=Hh(rr(Xt,"calls",a.id),w=>{const E=w.data();(E==null?void 0:E.status)==="active"?(r(E.roomUrl),l(null)):((E==null?void 0:E.status)==="rejected"||(E==null?void 0:E.status)==="ended")&&(alert("Call was declined or ended."),l(null))});return()=>m()},[a,r]);const u=async()=>{s&&(await Hd(rr(Xt,"calls",s.id),{status:"active",answeredAt:Ws()}),r(s.roomUrl),o(null))},d=async()=>{s&&(await Hd(rr(Xt,"calls",s.id),{status:"rejected",endedAt:Ws()}),o(null))},f=async()=>{a&&(await Hd(rr(Xt,"calls",a.id),{status:"ended",endedAt:Ws()}),l(null))};return q.useEffect(()=>{const m=async w=>{const E=w.detail;console.log("Starting call to:",E.displayName);const v=await n();if(!v){alert("Failed to create video room.");return}const b=await l6(Jc(Xt,"calls"),{callerId:t==null?void 0:t.uid,callerName:e==null?void 0:e.displayName,recipientId:E.uid,recipientName:E.displayName,roomUrl:v,status:"ringing",createdAt:Ws()});l({id:b.id,recipient:E})};return window.addEventListener("initiate-call",m),()=>window.removeEventListener("initiate-call",m)},[n,t,e]),i?D.jsx("div",{className:"fixed bottom-4 right-4 z-50"}):s?D.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:D.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md w-full text-center shadow-xl animate-bounce-slight",children:[D.jsx("div",{className:"w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:D.jsx(h_,{className:"w-12 h-12 text-blue-600"})}),D.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Incoming Call"}),D.jsxs("p",{className:"text-gray-600 mb-8",children:["from ",s.callerName]}),D.jsxs("div",{className:"flex justify-center space-x-8",children:[D.jsxs("button",{onClick:d,className:"flex flex-col items-center text-red-500 hover:text-red-700 transition",children:[D.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-2",children:D.jsx(V7,{className:"w-8 h-8"})}),D.jsx("span",{children:"Decline"})]}),D.jsxs("button",{onClick:u,className:"flex flex-col items-center text-green-500 hover:text-green-700 transition",children:[D.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-2 animate-pulse",children:D.jsx(F7,{className:"w-8 h-8"})}),D.jsx("span",{children:"Accept"})]})]})]})}):a?D.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:D.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md w-full text-center shadow-xl",children:[D.jsxs("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:[D.jsx("div",{className:"animate-ping absolute inline-flex h-16 w-16 rounded-full bg-blue-400 opacity-75"}),D.jsx(h_,{className:"w-8 h-8 text-gray-600 relative"})]}),D.jsx("h3",{className:"text-xl font-bold mb-2",children:"Calling..."}),D.jsx("p",{className:"text-gray-600 mb-8",children:a.recipient.displayName}),D.jsx("button",{onClick:f,className:"w-full bg-red-100 text-red-600 py-3 rounded-lg font-medium hover:bg-red-200 transition",children:"Cancel Call"})]})}):null},H7=()=>{const[t,e]=q.useState(""),[n,r]=q.useState(""),[i,s]=q.useState(""),[o,a]=q.useState(!1),[l,u]=q.useState(""),[d,f]=q.useState(!1),m=Nf(),w=async E=>{E.preventDefault(),u(""),f(!0);try{if(o){const b=(await DA(rf,t,n)).user.uid;await sw(rr(Xt,"users",b),{uid:b,email:t,displayName:i||t.split("@")[0],role:"admin",status:"online",createdAt:Ws(),isActive:!0,notificationPreferences:{smsEnabled:!0,emailEnabled:!0,inAppSoundsEnabled:!0}}),console.log("Admin account created successfully"),m("/admin")}else await OF(rf,t,n),m("/dashboard")}catch(v){console.error(v),v.code==="auth/email-already-in-use"?u("That email is already in use. Please log in."):v.code==="auth/wrong-password"?u("Incorrect password."):v.code==="auth/user-not-found"?u("No account found with this email."):u(v.message||"Failed to authenticate.")}f(!1)};return D.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:D.jsxs("div",{className:"max-w-md w-full space-y-8",children:[D.jsxs("div",{children:[D.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Total Relief Video Supervision"}),D.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:o?"Create your Admin Account":"Sign in to your account"})]}),D.jsxs("form",{className:"mt-8 space-y-6",onSubmit:w,children:[D.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[o&&D.jsx("div",{className:"relative mb-4",children:D.jsx("input",{type:"text",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm",placeholder:"Full Name",value:i,onChange:E=>s(E.target.value)})}),D.jsxs("div",{className:"relative",children:[D.jsx(L7,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),D.jsx("input",{type:"email",required:!0,className:"appearance-none rounded-t-md relative block w-full px-10 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm",placeholder:"Email address",value:t,onChange:E=>e(E.target.value)})]}),D.jsxs("div",{className:"relative",children:[D.jsx(D7,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),D.jsx("input",{type:"password",required:!0,className:"appearance-none rounded-b-md relative block w-full px-10 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm",placeholder:"Password",value:n,onChange:E=>r(E.target.value)})]})]}),l&&D.jsx("div",{className:"text-red-500 text-sm text-center bg-red-50 p-2 rounded",children:l}),D.jsx("div",{children:D.jsx("button",{type:"submit",disabled:d,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white ${d?"bg-gray-400":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary`,children:d?o?"Creating Account...":"Signing in...":o?"Create Admin Account":"Sign in"})}),D.jsx("div",{className:"text-center",children:D.jsx("button",{type:"button",onClick:()=>{a(!o),u("")},className:"text-sm text-blue-600 hover:text-blue-500 font-medium flex items-center justify-center mx-auto",children:o?"Already have an account? Sign in":D.jsxs(D.Fragment,{children:[D.jsx(B7,{className:"w-4 h-4 mr-1"}),"First time? Create Admin Account"]})})})]})]})})},G7=t=>{q.useEffect(()=>{if(!t)return;const e=fB(PB,"/status/"+t),n=rr(Xt,"presence",t),r={state:"offline",last_changed:AI()},i={state:"online",last_changed:AI()};return gB(e,i).catch(console.error),mB(e).set(r).catch(console.error),sw(n,{uid:t,status:"online",lastSeen:Ws()},{merge:!0}).catch(console.error),()=>{}},[t])},Jx=({children:t})=>{var a;const{currentUser:e,isAdmin:n}=No(),r=Nf(),i=Qa();G7(e==null?void 0:e.uid);const s=async()=>{try{await rf.signOut(),r("/login")}catch(l){console.error("Failed to log out",l)}},o=({to:l,icon:u,children:d})=>{const f=i.pathname===l;return D.jsxs(YL,{to:l,className:`flex items-center px-4 py-2 rounded-md ${f?"bg-gray-100 text-gray-900 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[D.jsx(u,{className:"w-5 h-5 mr-3"}),d]})};return D.jsxs("div",{className:"flex h-screen bg-gray-100",children:[D.jsxs("aside",{className:"w-64 bg-white shadow-md flex flex-col hidden md:flex",children:[D.jsxs("div",{className:"p-6 border-b",children:[D.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Total Relief"}),D.jsx("p",{className:"text-xs text-gray-500",children:"Video Supervision"})]}),D.jsxs("nav",{className:"flex-1 p-4 space-y-2",children:[D.jsx(o,{to:"/dashboard",icon:z7,children:"Roster"}),D.jsx(o,{to:"/history",icon:O7,children:"Call History"}),D.jsx(o,{to:"/settings",icon:j7,children:"Settings"}),n&&D.jsx(o,{to:"/admin",icon:U7,children:"Admin Panel"})]}),D.jsxs("div",{className:"p-4 border-t",children:[D.jsxs("div",{className:"flex items-center mb-4",children:[D.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold",children:(a=e==null?void 0:e.email)==null?void 0:a.charAt(0).toUpperCase()}),D.jsxs("div",{className:"ml-3",children:[D.jsx("p",{className:"text-sm font-medium text-gray-700 truncate w-32",children:e==null?void 0:e.email}),D.jsx("p",{className:"text-xs text-green-500",children:" Online"})]})]}),D.jsxs("button",{onClick:s,className:"w-full flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:[D.jsx(Tk,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]})]}),D.jsxs("div",{className:"md:hidden absolute top-0 left-0 w-full h-16 bg-white shadow flex items-center px-4 justify-between",children:[D.jsx("h1",{className:"text-lg font-bold",children:"Total Relief"}),D.jsx("button",{onClick:s,className:"text-gray-500",children:D.jsx(Tk,{className:"w-5 h-5"})})]}),D.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-8 pt-20 md:pt-8",children:t})]})},K7=({user:t,onCall:e})=>{var i,s;const n=o=>{switch(o){case"online":return"bg-green-500";case"busy":return"bg-yellow-500";case"away":return"bg-orange-500";default:return"bg-gray-400"}},r=t.status==="available";return D.jsxs("div",{className:"bg-white border rounded-lg shadow-sm p-4 flex items-center justify-between hover:shadow-md transition-shadow",children:[D.jsxs("div",{className:"flex items-center space-x-4",children:[D.jsxs("div",{className:"relative",children:[D.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 text-lg font-bold",children:((i=t.displayName)==null?void 0:i.charAt(0).toUpperCase())||((s=t.email)==null?void 0:s.charAt(0).toUpperCase())}),D.jsx("div",{className:`absolute bottom-0 right-0 h-3 w-3 rounded-full border-2 border-white ${n(t.status)}`})]}),D.jsxs("div",{children:[D.jsx("h4",{className:"text-base font-medium text-gray-900",children:t.displayName}),D.jsx("p",{className:"text-sm text-gray-500",children:t.role==="facility"?t.facilityId:t.role})]})]}),D.jsx("button",{onClick:()=>e(t),disabled:!r,className:`p-2 rounded-full ${r?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,title:r?"Start Video Call":"User Unavailable",children:D.jsx(h_,{className:"w-6 h-6"})})]})},Q7=()=>{const{currentUser:t,userProfile:e}=No(),[n,r]=q.useState([]),[i,s]=q.useState(!0);q.useEffect(()=>{if(!e)return;let a;e.role==="facility"?a=qh(Jc(Xt,"users"),hc("role","==","supervisor"),hc("isActive","==",!0)):a=qh(Jc(Xt,"users"),hc("isActive","==",!0));const l=Hh(a,u=>{const d=[];u.forEach(f=>{f.id!==(t==null?void 0:t.uid)&&d.push(f.data())}),d.sort((f,m)=>f.status==="available"&&m.status!=="available"?-1:f.status!=="available"&&m.status==="available"?1:f.displayName.localeCompare(m.displayName)),r(d),s(!1)},u=>{console.error("Error fetching roster:",u),s(!1)});return()=>l()},[e,t]);const o=a=>{const l=new CustomEvent("initiate-call",{detail:a});window.dispatchEvent(l)};return i?D.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading roster..."}):n.length===0?D.jsx("div",{className:"p-8 text-center bg-white rounded-lg shadow",children:D.jsx("p",{className:"text-gray-500",children:"No available users found."})}):D.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(a=>D.jsx(K7,{user:a,onCall:o},a.uid))})},J7=()=>{const{userProfile:t}=No();return D.jsxs(Jx,{children:[D.jsxs("div",{className:"mb-6",children:[D.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:(t==null?void 0:t.role)==="facility"?"Available Supervisors":"User Roster"}),D.jsx("p",{className:"text-gray-500",children:(t==null?void 0:t.role)==="facility"?"Select a supervisor below to initiate a video consultation.":"View online status of facility staff and other supervisors."})]}),D.jsx(Q7,{})]})},Y7={apiKey:"AIzaSyAtBRrVvheg2cIVyBq7RfXLTRlwXGhyw6Q",authDomain:"totalreliefmd.firebaseapp.com",projectId:"totalreliefmd",storageBucket:"totalreliefmd.firebasestorage.app",messagingSenderId:"906049680832",appId:"1:906049680832:web:76093f680d8a3009398425",measurementId:"G-CT16QBMPPC"},X7=()=>{const[t,e]=q.useState(""),[n,r]=q.useState(""),[i,s]=q.useState(""),[o,a]=q.useState("facility"),[l,u]=q.useState(""),[d,f]=q.useState(!1),[m,w]=q.useState({type:"",content:""}),E=async v=>{v.preventDefault(),f(!0),w({type:"",content:""});const b=yv(Y7,"SecondaryApp"),S=HA(b);try{const k=(await DA(S,t,n)).user.uid;await sw(rr(Xt,"users",k),{uid:k,email:t,displayName:i,role:o,facilityId:o==="facility"?l:null,status:"offline",createdAt:Ws(),isActive:!0,notificationPreferences:{smsEnabled:!0,emailEnabled:!0,inAppSoundsEnabled:!0}}),await FF(S),w({type:"success",content:`User ${t} created successfully!`}),e(""),r(""),s("")}catch(T){console.error("Error creating user:",T),w({type:"error",content:T.message})}finally{f(!1)}};return D.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:[D.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Create New User"}),m.content&&D.jsx("div",{className:`p-3 mb-4 rounded ${m.type==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:m.content}),D.jsxs("form",{onSubmit:E,className:"space-y-4",children:[D.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[D.jsxs("div",{children:[D.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Display Name"}),D.jsx("input",{type:"text",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",value:i,onChange:v=>s(v.target.value)})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),D.jsx("input",{type:"email",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",value:t,onChange:v=>e(v.target.value)})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),D.jsx("input",{type:"password",required:!0,minLength:6,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",value:n,onChange:v=>r(v.target.value)})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),D.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",value:o,onChange:v=>a(v.target.value),children:[D.jsx("option",{value:"facility",children:"Facility User"}),D.jsx("option",{value:"supervisor",children:"Supervisor"}),D.jsx("option",{value:"admin",children:"Administrator"})]})]}),o==="facility"&&D.jsxs("div",{children:[D.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Facility Name/ID"}),D.jsx("input",{type:"text",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",value:l,onChange:v=>u(v.target.value),placeholder:"e.g. Houston Medical Center"})]})]}),D.jsx("div",{className:"flex justify-end mt-4",children:D.jsx("button",{type:"submit",disabled:d,className:`px-4 py-2 rounded-md text-white ${d?"bg-gray-400":"bg-blue-600 hover:bg-blue-700"}`,children:d?"Creating...":"Create User"})})]})]})},Z7=()=>{const[t,e]=q.useState([]),[n,r]=q.useState(!0),[i,s]=q.useState("");q.useEffect(()=>{const l=qh(Jc(Xt,"users"),r6("createdAt","desc")),u=Hh(l,d=>{const f=[];d.forEach(m=>{f.push(m.data())}),e(f),r(!1)},d=>{console.error("Error fetching users:",d),s("Failed to load users."),r(!1)});return()=>u()},[]);const o=async(l,u)=>{try{await Hd(rr(Xt,"users",l),{isActive:!u})}catch(d){console.error("Error updating user status:",d),alert("Failed to update user status")}},a=async l=>{if(window.confirm("Are you sure you want to delete this user? This cannot be undone."))try{await a6(rr(Xt,"users",l)),alert("User profile deleted. Note: Auth account still exists until Phase 2 cleanup.")}catch(u){console.error("Error deleting user:",u),alert("Failed to delete user")}};return n?D.jsx("div",{className:"p-4 text-center",children:"Loading users..."}):i?D.jsx("div",{className:"p-4 text-center text-red-500",children:i}):D.jsx("div",{className:"overflow-x-auto",children:D.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[D.jsx("thead",{className:"bg-gray-50",children:D.jsxs("tr",{children:[D.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),D.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),D.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Facility"}),D.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),D.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),D.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(l=>{var u,d;return D.jsxs("tr",{children:[D.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:D.jsxs("div",{className:"flex items-center",children:[D.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:D.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold",children:((u=l.displayName)==null?void 0:u.charAt(0).toUpperCase())||((d=l.email)==null?void 0:d.charAt(0).toUpperCase())})}),D.jsxs("div",{className:"ml-4",children:[D.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.displayName}),D.jsx("div",{className:"text-sm text-gray-500",children:l.email})]})]})}),D.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:D.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                  ${l.role==="admin"?"bg-purple-100 text-purple-800":l.role==="supervisor"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:l.role})}),D.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.role==="facility"?l.facilityId:"-"}),D.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:D.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${l.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:l.isActive?"Active":"Disabled"})}),D.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[D.jsx("button",{onClick:()=>o(l.uid,l.isActive),className:"text-indigo-600 hover:text-indigo-900 mr-4",title:"Toggle Status",children:l.isActive?D.jsx(W7,{className:"w-5 h-5"}):D.jsx(M7,{className:"w-5 h-5"})}),D.jsx("button",{onClick:()=>a(l.uid),className:"text-red-600 hover:text-red-900",title:"Delete User",children:D.jsx($7,{className:"w-5 h-5"})})]})]},l.uid)})})]})})},eW=()=>{const{userProfile:t}=No();return D.jsxs(Jx,{children:[D.jsx("div",{className:"flex justify-between items-center mb-6",children:D.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Admin Dashboard"})}),D.jsxs("div",{className:"space-y-6",children:[D.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[D.jsxs("h3",{className:"text-lg font-medium mb-4",children:["Welcome, ",t==null?void 0:t.displayName]}),D.jsx("p",{className:"text-gray-500",children:"Use this panel to manage system users. You can create new accounts for Facilities and Supervisors below."})]}),D.jsx(X7,{}),D.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[D.jsx("h3",{className:"text-lg font-medium mb-4",children:"User List"}),D.jsx(Z7,{})]})]})]})},tW=({children:t})=>{const{currentUser:e,loading:n}=No();return n?D.jsx("div",{children:"Loading..."}):e?D.jsx(D.Fragment,{children:t}):D.jsx(Th,{to:"/login"})},nW=({children:t})=>{const{currentUser:e,isAdmin:n,loading:r}=No();return r?D.jsx("div",{children:"Loading..."}):e?n?D.jsx(D.Fragment,{children:t}):D.jsx(Th,{to:"/dashboard"}):D.jsx(Th,{to:"/login"})};function rW(){return D.jsx(RB,{children:D.jsx(R7,{children:D.jsx(KL,{children:D.jsxs("div",{className:"min-h-screen bg-gray-50",children:[D.jsx(q7,{}),D.jsxs($L,{children:[D.jsx($l,{path:"/login",element:D.jsx(H7,{})}),D.jsx($l,{path:"/dashboard",element:D.jsx(tW,{children:D.jsx(J7,{})})}),D.jsx($l,{path:"/admin",element:D.jsx(nW,{children:D.jsx(eW,{})})}),D.jsx($l,{path:"/",element:D.jsx(Th,{to:"/dashboard"})})]})]})})})})}ng.createRoot(document.getElementById("root")).render(D.jsx(Ok.StrictMode,{children:D.jsx(rW,{})}));
